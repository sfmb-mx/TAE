writeLines("\n :: NOT SOLD articles proportion")
eBayBW$Negative <- as.factor(eBayBW$sold == 0)
m <- table(eBayBW$Negative)
m
m[2] / (m[1] + m[2])
'org_babel_R_eoe'
writeLines("\n :: Isolating the interest features:")
eBayValidationBW <- eBayValidation[, c(10, 1)]
str(eBayValidationBW)
'org_babel_R_eoe'
writeLines("\n :: Dummy variables for factors/characters...")

eBayDS2 <- eBayDS[, c(-1, -11)]
eBayDummy <- dummyVars("~.", data = eBayDS2, fullRank = F)
eBayDS2 <- as.data.frame(predict(eBayDummy, eBayDS))
names(eBayDS2)

writeLines("\n :: Re-work the feature names...")
names(eBayDS2) <- make.names(names(eBayDS2), unique = FALSE, allow_ = TRUE)
colnames(eBayDS2)[38] <- "eBay.sold"
names(eBayDS2)
'org_babel_R_eoe'
writeLines("\n :: Dummy variables for factors/characters...")

eBayValidation2 <- eBayValidation[, -1]
eBayDummy <- dummyVars("~.", data = eBayValidation2, fullRank = F)
eBayValidation2 <- as.data.frame(predict(eBayDummy, eBayValidation))
print(names(eBayValidation2))

writeLines("\n :: Re-work the feature names:")
names(eBayValidation2) <- make.names(names(eBayValidation2), unique =
                                                   FALSE, allow_ = TRUE)

print(names(eBayValidation2))
'org_babel_R_eoe'
writeLines("\n :: Joining all together:")
eBayDS3 <- eBayDS2 # cbind(eBaySparse, eBayDS2)

writeLines("\n :: Number of new features:")
length(names(eBayDS3))
'org_babel_R_eoe'
writeLines("\n :: Joining all together:")
eBayValidation3 <- eBayValidation2 # cbind(eBayValidationSparse, eBayValidation2)

writeLines("\n :: Number of new features:")
length(names(eBayValidation3))
'org_babel_R_eoe'
writeLines("\n :: Eliminating the variables that are flagged to be problematic...")
nzv <- nearZeroVar(eBayDS3)
eBayDS3 <- eBayDS3[, -nzv]

nzv <- nearZeroVar(eBayValidation3)
eBayValidation3 <- eBayValidation3[, -nzv]
'org_babel_R_eoe'
writeLines("\n :: Split the data:")
set.seed(pi)

spl <- sample.split(eBayDS3$eBay.sold, SplitRatio = 0.75)

eBayTrain <- subset(eBayDS3, spl == TRUE)
eBayTest <- subset(eBayDS3, spl == FALSE)

writeLines("\n :: Dimensions of the training set:")
dim(eBayTrain)

writeLines("\n :: Dimensions of the testing set:")
dim(eBayTest)
'org_babel_R_eoe'
writeLines("\n :: Remove the extra objects...")

'org_babel_R_eoe'
'org_babel_R_eoe'
writeLines("\n :: What is the proportion of your outcome variable?")
prop.table(table(eBayTrain$eBay.sold))
table(eBayTrain$eBay.sold)
'org_babel_R_eoe'
writeLines("\n :: Generalize outcome and predictor variables...")
outcomeName <- 'eBay.sold'
predictorsNames <- names(eBayTrain)[names(eBayTrain) != outcomeName]

writeLines("\n :: Number of predictors name:s")
length(predictorsNames)
'org_babel_R_eoe'
writeLines("\n :: The total caret supported models:")
length(names(getModelInfo()))
'org_babel_R_eoe'
writeLines("\n :: Pick model glm and find out what type of model it is:")
getModelInfo()$glm$type
'org_babel_R_eoe'
writeLines("\n :: Create caret trainControl object to control the number of
    cross-validations performed...")
objControl <- trainControl(method = 'cv', number = 10, returnResamp =
                  'none', summaryFunction = twoClassSummary,
                  classProbs = TRUE)
'org_babel_R_eoe'
writeLines("\n :: ------------ LR9 AUC ------------")
predictTest <- predict(eBayLR7, newdata = eBayTest, type = "response")
ROCRpred <- prediction(predictTest, eBayTest$eBay.sold)
as.numeric(performance(ROCRpred, "auc")@y.values)

writeLines("\n :: ----------- CART1 AUC -----------")
PredTestCART1 <- predict(eBayCART1, newdata = eBayTest)[, 2]
ROCRpredCART1 <- prediction(PredTestCART1, eBayTest$eBay.sold)
as.numeric(performance(ROCRpredCART1, "auc")@y.values)

writeLines("\n :: ------------ RF1 AUC ------------")
predTestRF1 <- predict(eBayRF1, newdata = eBayTest)
ROCRpredRF1 <- prediction(predTestRF1, eBayTest$eBay.sold)
as.numeric(performance(ROCRpredRF1, "auc")@y.values)
'org_babel_R_eoe'
writeLines("\n :: eBayValidation new structure:")
str(eBayValidation3)
'org_babel_R_eoe'
writeLines("\n :: ------------ LR9 AUC ------------")
PredTest <- predict(eBayLR9, newdata = eBayValidation3, type = "response")
summary(PredTest)
MySubmission <- data.frame(UniqueID = eBayValidation3$UniqueID, Probability1 = PredTest)
write.csv(MySubmission, "../data/SubmissionLR9.csv", row.names = FALSE)
writeLines("\n :: Submission LR9 file generated...")

writeLines("\n :: ------------ RF1 AUC ------------")
PredTest <- predict(eBayRF1, newdata = eBayValidation3, type = "class")
summary(PredTest)
MySubmission <- data.frame(UniqueID = eBayValidation2$UniqueID, Probability1 = PredTest)
write.csv(MySubmission, "../data/SubmissionRF1.csv", row.names = FALSE)
writeLines("\n :: Submission RF1 file generated...")
'org_babel_R_eoe'
q()
n
q()
n
writeLines("\n :: Install new package: optimx ...")
install.packages('optimx', repos='http://cran.rstudio.com/')
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
writeLines("\n :: Install new package: optimx ...")
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
demo(package="optimx"
)
ox
demo(ox)
yes
yes
y
y
y
y
y
y
y
y
y
y
y
y
y
y
y
y
y
y
y
no
n
q()
n
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
'org_babel_R_eoe'
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
discountSeats
'org_babel_R_eoe'
writeLines("\n :: The total revenue is:")
regularPrice <- 617.0
discountPrice <- 238.0

totalRevenue <- (regularDemand * regularPrice) + (discountSeats *
                                                  discountPrice)

totalRevenue
'org_babel_R_eoe'
q()
n
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
discountSeats
'org_babel_R_eoe'
writeLines("\n :: The total revenue is:")
regularPrice <- 617.0
discountPrice <- 238.0

totalRevenue <- (regularDemand * regularPrice) + (discountSeats *
                                                  discountPrice)

totalRevenue
'org_babel_R_eoe'
writeLines("\n :: Install new package: optimx ...")
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
discountSeats
'org_babel_R_eoe'
writeLines("\n :: The total revenue is:")
regularPrice <- 617.0
discountPrice <- 238.0

totalRevenue <- (regularDemand * regularPrice) + (discountSeats *
                                                  discountPrice)

totalRevenue
'org_babel_R_eoe'
writeLines("\n :: Install new package: optimx ...")
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
discountSeats
'org_babel_R_eoe'
writeLines("\n :: The total revenue is:")
regularPrice <- 617.0
discountPrice <- 238.0

totalRevenue <- (regularDemand * regularPrice) + (discountSeats *
                                                  discountPrice)

totalRevenue
'org_babel_R_eoe'
writeLines("\n :: Install new package: optimx ...")
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
discountSeats
'org_babel_R_eoe'
writeLines("\n :: The total revenue is:")
regularPrice <- 617.0
discountPrice <- 238.0

totalRevenue <- (regularDemand * regularPrice) + (discountSeats *
                                                  discountPrice)

totalRevenue
'org_babel_R_eoe'
writeLines("\n :: Install new package: optimx ...")
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
discountSeats
'org_babel_R_eoe'
writeLines("\n :: The total revenue is:")
regularPrice <- 617.0
discountPrice <- 238.0

totalRevenue <- (regularDemand * regularPrice) + (discountSeats *
                                                  discountPrice)

totalRevenue
'org_babel_R_eoe'
writeLines("\n :: Install new package: optimx ...")
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
discountSeats
'org_babel_R_eoe'
writeLines("\n :: The total revenue is:")
regularPrice <- 617.0
discountPrice <- 238.0

totalRevenue <- (regularDemand * regularPrice) + (discountSeats *
                                                  discountPrice)

totalRevenue
'org_babel_R_eoe'
writeLines("\n :: Install new package: optimx ...")
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
discountSeats
'org_babel_R_eoe'
writeLines("\n :: The total revenue is:")
regularPrice <- 617.0
discountPrice <- 238.0

totalRevenue <- (regularDemand * regularPrice) + (discountSeats *
                                                  discountPrice)

totalRevenue
'org_babel_R_eoe'
writeLines("\n :: Install new package: optimx ...")
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
discountSeats
'org_babel_R_eoe'
writeLines("\n :: The total revenue is:")
regularPrice <- 617.0
discountPrice <- 238.0

totalRevenue <- (regularDemand * regularPrice) + (discountSeats *
                                                  discountPrice)

totalRevenue
'org_babel_R_eoe'
writeLines("\n :: Install new package: optimx ...")
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
discountSeats
'org_babel_R_eoe'
writeLines("\n :: The total revenue is:")
regularPrice <- 617.0
discountPrice <- 238.0

totalRevenue <- (regularDemand * regularPrice) + (discountSeats *
                                                  discountPrice)

totalRevenue
'org_babel_R_eoe'
writeLines("\n :: Install new package: optimx ...")
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
discountSeats
'org_babel_R_eoe'
writeLines("\n :: The total revenue is:")
regularPrice <- 617.0
discountPrice <- 238.0

totalRevenue <- (regularDemand * regularPrice) + (discountSeats *
                                                  discountPrice)

totalRevenue
'org_babel_R_eoe'
writeLines("\n :: Install new package: optimx ...")
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
discountSeats
'org_babel_R_eoe'
writeLines("\n :: The total revenue is:")
regularPrice <- 617.0
discountPrice <- 238.0

totalRevenue <- (regularDemand * regularPrice) + (discountSeats *
                                                  discountPrice)

totalRevenue
'org_babel_R_eoe'
writeLines("\n :: Install new package: optimx ...")
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
discountSeats
'org_babel_R_eoe'
writeLines("\n :: The total revenue is:")
regularPrice <- 617.0
discountPrice <- 238.0

totalRevenue <- (regularDemand * regularPrice) + (discountSeats *
                                                  discountPrice)

totalRevenue
'org_babel_R_eoe'
writeLines("\n :: Install new package: optimx ...")
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
discountSeats
'org_babel_R_eoe'
writeLines("\n :: The total revenue is:")
regularPrice <- 617.0
discountPrice <- 238.0

totalRevenue <- (regularDemand * regularPrice) + (discountSeats *
                                                  discountPrice)

totalRevenue
'org_babel_R_eoe'
writeLines("\n :: Install new package: optimx ...")
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
discountSeats
'org_babel_R_eoe'
writeLines("\n :: The total revenue is:")
regularPrice <- 617.0
discountPrice <- 238.0

totalRevenue <- (regularDemand * regularPrice) + (discountSeats *
                                                  discountPrice)

totalRevenue
'org_babel_R_eoe'
writeLines("\n :: Install new package: optimx ...")
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
q()
n
q()
n
q()
n
writeLines("\n :: How many discount seats we should sell?")
regularDemand <- 150
fullCapacity <- 166
discountSeats <- fullCapacity - regularDemand
discountSeats
'org_babel_R_eoe'
writeLines("\n :: The total revenue is:")
regularPrice <- 617.0
discountPrice <- 238.0

totalRevenue <- (regularDemand * regularPrice) + (discountSeats *
                                                  discountPrice)

totalRevenue
'org_babel_R_eoe'
writeLines("\n :: Install new package: optimx ...")
## install.packages('optimx', repos='http://cran.rstudio.com/')
writeLines("\n :: NOTE: Please comment after install once...")

library(optimx)
writeLines("\n :: Library optimx loaded...")
'org_babel_R_eoe'
q()
n
