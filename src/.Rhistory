
if(!file.exists("../data")) {
        dir.create("../data")
}

fileUrl <- "https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/PollingImputed.csv"
fileName <- "PollingImputed.csv"
dataPath <- "../data"

filePath <- paste(dataPath, fileName, sep = "/")

if(!file.exists(filePath)) {
        download.file(fileUrl, destfile = filePath, method = "curl")
}

writeLines("\n :: File downloaded...")
'org_babel_R_eoe'
writeLines("    Loading the imputed data into their data frame.")
polling <- read.table("../data/PollingImputed.csv", sep = ",", header = TRUE)
str(polling)
table(polling$Year)
summary(polling)
'org_babel_R_eoe'
writeLines("\n :: Subset data into training set and test set")
Train <- subset(polling, Year == 2004 | Year == 2008)
Test <- subset(polling, Year == 2012)
'org_babel_R_eoe'
writeLines("\n :: Revising the Testing data frame structure:")
str(Test)
'org_babel_R_eoe'
writeLines("\n :: Creating the Logistic Regression model...")
mod2 <- glm(Republican ~ SurveyUSA + DiffCount, data = Train,
            family = "binomial")

writeLines("\n :: Making preditions from Testing data set...")
TestPrediction <- predict(mod2, newdata = Test, type = "response")
'org_babel_R_eoe'
writeLines("\n :: Creting binary preditions with a threshold of 50%...")
TestPredictionBinary <- as.numeric(TestPrediction > 0.5)
'org_babel_R_eoe'
writeLines("\n :: New data frame for plotting purposes...")
predictionDataFrame <- data.frame(TestPrediction,
                                  TestPredictionBinary, Test$State)
'org_babel_R_eoe'
writeLines("\n :: Number of states with TestPredictionbinary == 1:")
nrow(subset(predictionDataFrame, predictionDataFrame$TestPredictionBinary == 1))
'org_babel_R_eoe'
writeLines("\n :: The average predicted probability of our model:")
mean(predictionDataFrame$TestPrediction)
'org_babel_R_eoe'
writeLines("\n :: convert the Test.State variable to lowercase...")
predictionDataFrame$region <- tolower(predictionDataFrame$Test.State)
'org_babel_R_eoe'
writeLines("\n :: Merging the two data frames...")
predictionMap <- merge(statesMap, predictionDataFrame, by = "region")
'org_babel_R_eoe'
writeLines("\n :: Ordering the map data...")
predictionMap <- predictionMap[order(predictionMap$order),]
'org_babel_R_eoe'
writeLines("\n :: Number of observations in the predition map:")
nrow(predictionMap)
'org_babel_R_eoe'
writeLines("\n :: Number of observations in the states map:")
nrow(statesMap)
'org_babel_R_eoe'
writeLines("\n :: The predicted probability for Florida:")
head(predictionMap[predictionMap$region == "florida", ], 1)
'org_babel_R_eoe'
writeLines("\n :: The predicted probability for Florida:")
head(predictionMap$TestPrediction[predictionMap$region == "florida", ], 1)
'org_babel_R_eoe'
writeLines("\n :: The predicted probability for Florida:")
head(predictionMap[predictionMap$region == "florida", ], 1)
'org_babel_R_eoe'
writeLines("\n :: The predicted probability for Florida:")
head(predictionMap[predictionMap$region == "florida", ], 1)
'org_babel_R_eoe'
q()
n
writeLines("\n :: Loading the necessary libraries...")
library(ggplot2)
library(maps)
library(ggmap)
'org_babel_R_eoe'
writeLines("\n :: Load the US map in R...")
statesMap <- map_data("state")
'org_babel_R_eoe'
writeLines("\n :: Showing the structure of stateMap:")
str(statesMap)
'org_babel_R_eoe'
writeLines("\n :: The number of groups:")
str(factor(statesMap$group))

writeLines("\n :: Another useful way:")
table(statesMap$group)

writeLines("\n :: Yet another way to calculate:")
length(table(statesMap$group))
'org_babel_R_eoe'
library(parallel)

if(!file.exists("../data")) {
        dir.create("../data")
}

fileUrl <- "https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/PollingImputed.csv"
fileName <- "PollingImputed.csv"
dataPath <- "../data"

filePath <- paste(dataPath, fileName, sep = "/")

if(!file.exists(filePath)) {
        download.file(fileUrl, destfile = filePath, method = "curl")
}

writeLines("\n :: File downloaded...")
'org_babel_R_eoe'
writeLines("    Loading the imputed data into their data frame.")
polling <- read.table("../data/PollingImputed.csv", sep = ",", header = TRUE)
str(polling)
table(polling$Year)
summary(polling)
'org_babel_R_eoe'
writeLines("\n :: Subset data into training set and test set")
Train <- subset(polling, Year == 2004 | Year == 2008)
Test <- subset(polling, Year == 2012)
'org_babel_R_eoe'
writeLines("\n :: Revising the Testing data frame structure:")
str(Test)
'org_babel_R_eoe'
writeLines("\n :: Creating the Logistic Regression model...")
mod2 <- glm(Republican ~ SurveyUSA + DiffCount, data = Train,
            family = "binomial")

writeLines("\n :: Making preditions from Testing data set...")
TestPrediction <- predict(mod2, newdata = Test, type = "response")
'org_babel_R_eoe'
writeLines("\n :: Creting binary preditions with a threshold of 50%...")
TestPredictionBinary <- as.numeric(TestPrediction > 0.5)
'org_babel_R_eoe'
writeLines("\n :: New data frame for plotting purposes...")
predictionDataFrame <- data.frame(TestPrediction,
                                  TestPredictionBinary, Test$State)
'org_babel_R_eoe'
writeLines("\n :: Number of states with TestPredictionbinary == 1:")
nrow(subset(predictionDataFrame, predictionDataFrame$TestPredictionBinary == 1))
'org_babel_R_eoe'
writeLines("\n :: The average predicted probability of our model:")
mean(predictionDataFrame$TestPrediction)
'org_babel_R_eoe'
writeLines("\n :: convert the Test.State variable to lowercase...")
predictionDataFrame$region <- tolower(predictionDataFrame$Test.State)
'org_babel_R_eoe'
writeLines("\n :: Merging the two data frames...")
predictionMap <- merge(statesMap, predictionDataFrame, by = "region")
'org_babel_R_eoe'
writeLines("\n :: Ordering the map data...")
predictionMap <- predictionMap[order(predictionMap$order),]
'org_babel_R_eoe'
writeLines("\n :: Number of observations in the predition map:")
nrow(predictionMap)
'org_babel_R_eoe'
writeLines("\n :: Number of observations in the states map:")
nrow(statesMap)
'org_babel_R_eoe'
writeLines("\n :: The predicted probability for Florida:")
head(predictionMap[predictionMap$region == "florida", ], 1)
'org_babel_R_eoe'
q()
n
library(parallel)

if(!file.exists("../data")) {
        dir.create("../data")
}

fileUrl <-
        c("https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/edges.csv",
        "https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/users.csv")

fileName <- c("edges.csv", "users.csv")
dataPath <- "../data"

for(i in 1:2) {
        filePath <- paste(dataPath, fileName[i], sep = "/")

        if(!file.exists(filePath)) {
                download.file(fileUrl[i], destfile = filePath, method = "curl")
        }
}
writeLines("\n :: Files downloaded...")
'org_babel_R_eoe'
library(parallel)

if(!file.exists("../data")) {
        dir.create("../data")
}

fileUrl <-
        c("https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/edges.csv",
        "https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/users.csv")

fileName <- c("edges.csv", "users.csv")
dataPath <- "../data"

for(i in 1:2) {
        filePath <- paste(dataPath, fileName[i], sep = "/")

        if(!file.exists(filePath)) {
                download.file(fileUrl[i], destfile = filePath, method = "curl")
        }
}
writeLines("\n :: Files downloaded...")
'org_babel_R_eoe'
writeLines("\n :: Loading the data sets in dataframes...")
edges <- read.csv("../data/edges.csv")
users <- read.csv("../data/users.csv")

writeLines("\n :: Revising the edges dataframe structure:")
str(edges)

writeLines("\n :: Revising the users dataframe structure:")
str(users)
'org_babel_R_eoe'
table(edges$V1, edges$V2)
'org_babel_R_eoe'
head(edges)
table(edges$V1, edges$V2)
'org_babel_R_eoe'
head(edges)
summary(edges)
table(edges$V1, edges$V2)
'org_babel_R_eoe'
head(edges)
table(edges$V1, edges$V2)
'org_babel_R_eoe'
writeLines("\n :: Average number of friends per user:")
head(edges)
mean(colMeans(table(edges$V1, edges$V2)))
'org_babel_R_eoe'
head(edges)
writeLines("\n :: Average number of friends per user:")
mean(colMeans(table(edges$V1, edges$V2)))
'org_babel_R_eoe'
head(edges)
table(edges$V1, edges$V2)

writeLines("\n :: Average number of friends per user:")
mean(colMeans(table(edges$V1, edges$V2)))
'org_babel_R_eoe'
m
m
table(edges)
)
m
dim(table(edges))
user
user
head(edges)
head(user)
head(user)
user
class(edges$V1)
user1
user2
user
user
class(user1)
class(user2)
user
diplicated(user)
duplicated(user)
146 * 2
writeLines("\n :: Number of frienship relationships:")
nrow(edges)

writeLines("\n :: Number of users:")
unique(c(as.vector(edges$V1), as.vector(edges$V2)))

writeLines("\n :: Average number of friends per user:")
nrow(edges) / length(unique(c(as.vector(edges$V1), as.vector(edges$V2))))
'org_babel_R_eoe'
writeLines("\n :: Number of frienship relationships:")
nrow(edges)

writeLines("\n :: Number of users:")
length(unique(c(as.vector(edges$V1), as.vector(edges$V2))))

writeLines("\n :: Average number of friends per user:")
nrow(edges) / length(unique(c(as.vector(edges$V1), as.vector(edges$V2))))
'org_babel_R_eoe'
writeLines("\n :: Number of frienship relationships:")
nrow(edges)

writeLines("\n :: Number of users:")

length(unique(c(as.vector(edges$V1), as.vector(edges$V2))))

writeLines("\n :: Average number of friends per user:")
nrow(edges) / length(unique(c(as.vector(edges$V1),
                              as.vector(edges$V2))))

2*nrow(edges) / nrow(users)
'org_babel_R_eoe'
writeLines("\n :: Number of frienship relationships:")
nrow(edges)

writeLines("\n :: Number of users:")
nrow(users)

writeLines("\n :: Average number of friends per user:")
(2 * nrow(edges)) / nrow(users)
'org_babel_R_eoe'
q()
n
writeLines("\n :: Loading the necessary libraries...")
library(ggplot2)
library(maps)
library(ggmap)
'org_babel_R_eoe'
writeLines("\n :: Load the US map in R...")
statesMap <- map_data("state")
'org_babel_R_eoe'
writeLines("\n :: Showing the structure of stateMap:")
str(statesMap)
'org_babel_R_eoe'
writeLines("\n :: The number of groups:")
str(factor(statesMap$group))

writeLines("\n :: Another useful way:")
table(statesMap$group)

writeLines("\n :: Yet another way to calculate:")
length(table(statesMap$group))
'org_babel_R_eoe'
library(parallel)

if(!file.exists("../data")) {
        dir.create("../data")
}

fileUrl <- "https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/PollingImputed.csv"
fileName <- "PollingImputed.csv"
dataPath <- "../data"

filePath <- paste(dataPath, fileName, sep = "/")

if(!file.exists(filePath)) {
        download.file(fileUrl, destfile = filePath, method = "curl")
}

writeLines("\n :: File downloaded...")
'org_babel_R_eoe'
writeLines("    Loading the imputed data into their data frame.")
polling <- read.table("../data/PollingImputed.csv", sep = ",", header = TRUE)
str(polling)
table(polling$Year)
summary(polling)
'org_babel_R_eoe'
writeLines("\n :: Subset data into training set and test set")
Train <- subset(polling, Year == 2004 | Year == 2008)
Test <- subset(polling, Year == 2012)
'org_babel_R_eoe'
writeLines("\n :: Revising the Testing data frame structure:")
str(Test)
'org_babel_R_eoe'
writeLines("\n :: Creating the Logistic Regression model...")
mod2 <- glm(Republican ~ SurveyUSA + DiffCount, data = Train,
            family = "binomial")

writeLines("\n :: Making preditions from Testing data set...")
TestPrediction <- predict(mod2, newdata = Test, type = "response")
'org_babel_R_eoe'
writeLines("\n :: Creting binary preditions with a threshold of 50%...")
TestPredictionBinary <- as.numeric(TestPrediction > 0.5)
'org_babel_R_eoe'
writeLines("\n :: New data frame for plotting purposes...")
predictionDataFrame <- data.frame(TestPrediction,
                                  TestPredictionBinary, Test$State)
'org_babel_R_eoe'
writeLines("\n :: Number of states with TestPredictionbinary == 1:")
nrow(subset(predictionDataFrame, predictionDataFrame$TestPredictionBinary == 1))
'org_babel_R_eoe'
writeLines("\n :: The average predicted probability of our model:")
mean(predictionDataFrame$TestPrediction)
'org_babel_R_eoe'
writeLines("\n :: convert the Test.State variable to lowercase...")
predictionDataFrame$region <- tolower(predictionDataFrame$Test.State)
'org_babel_R_eoe'
writeLines("\n :: Merging the two data frames...")
predictionMap <- merge(statesMap, predictionDataFrame, by = "region")
'org_babel_R_eoe'
writeLines("\n :: Ordering the map data...")
predictionMap <- predictionMap[order(predictionMap$order),]
'org_babel_R_eoe'
writeLines("\n :: Number of observations in the predition map:")
nrow(predictionMap)
'org_babel_R_eoe'
writeLines("\n :: Number of observations in the states map:")
nrow(statesMap)
'org_babel_R_eoe'
writeLines("\n :: The predicted probability for Florida:")
head(predictionMap[predictionMap$region == "florida", ], 1)
'org_babel_R_eoe'
library(parallel)

if(!file.exists("../data")) {
        dir.create("../data")
}

fileUrl <-
        c("https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/edges.csv",
        "https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/users.csv")

fileName <- c("edges.csv", "users.csv")
dataPath <- "../data"

for(i in 1:2) {
        filePath <- paste(dataPath, fileName[i], sep = "/")

        if(!file.exists(filePath)) {
                download.file(fileUrl[i], destfile = filePath, method = "curl")
        }
}
writeLines("\n :: Files downloaded...")
'org_babel_R_eoe'
writeLines("\n :: Loading the data sets in dataframes...")
edges <- read.csv("../data/edges.csv")
users <- read.csv("../data/users.csv")

writeLines("\n :: Revising the edges dataframe structure:")
str(edges)

writeLines("\n :: Revising the users dataframe structure:")
str(users)
'org_babel_R_eoe'
writeLines("\n :: Number of frienship relationships:")
nrow(edges)

writeLines("\n :: Number of users:")
nrow(users)

writeLines("\n :: Average number of friends per user:")
(2 * nrow(edges)) / nrow(users)
'org_babel_R_eoe'
ls()
'org_babel_R_eoe'
str(users)
'org_babel_R_eoe'
table(users$school)
'org_babel_R_eoe'
writeLines("\n :: Loading the data sets in dataframes...")
edges <- read.csv("../data/edges.csv", na.strings = c("NA", ""))
users <- read.csv("../data/users.csv", na.strings = c("NA", ""))

writeLines("\n :: Revising the edges dataframe structure:")
str(edges)

writeLines("\n :: Revising the users dataframe structure:")
str(users)
'org_babel_R_eoe'
writeLines("\n :: Loading the necessary libraries...")
library(ggplot2)
library(maps)
library(ggmap)
'org_babel_R_eoe'
writeLines("\n :: Load the US map in R...")
statesMap <- map_data("state")
'org_babel_R_eoe'
writeLines("\n :: Showing the structure of stateMap:")
str(statesMap)
'org_babel_R_eoe'
writeLines("\n :: The number of groups:")
str(factor(statesMap$group))

writeLines("\n :: Another useful way:")
table(statesMap$group)

writeLines("\n :: Yet another way to calculate:")
length(table(statesMap$group))
'org_babel_R_eoe'
library(parallel)

if(!file.exists("../data")) {
        dir.create("../data")
}

fileUrl <- "https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/PollingImputed.csv"
fileName <- "PollingImputed.csv"
dataPath <- "../data"

filePath <- paste(dataPath, fileName, sep = "/")

if(!file.exists(filePath)) {
        download.file(fileUrl, destfile = filePath, method = "curl")
}

writeLines("\n :: File downloaded...")
'org_babel_R_eoe'
writeLines("    Loading the imputed data into their data frame.")
polling <- read.table("../data/PollingImputed.csv", sep = ",", header = TRUE)
str(polling)
table(polling$Year)
summary(polling)
'org_babel_R_eoe'
writeLines("\n :: Subset data into training set and test set")
Train <- subset(polling, Year == 2004 | Year == 2008)
Test <- subset(polling, Year == 2012)
'org_babel_R_eoe'
writeLines("\n :: Revising the Testing data frame structure:")
str(Test)
'org_babel_R_eoe'
writeLines("\n :: Creating the Logistic Regression model...")
mod2 <- glm(Republican ~ SurveyUSA + DiffCount, data = Train,
            family = "binomial")

writeLines("\n :: Making preditions from Testing data set...")
TestPrediction <- predict(mod2, newdata = Test, type = "response")
'org_babel_R_eoe'
writeLines("\n :: Creting binary preditions with a threshold of 50%...")
TestPredictionBinary <- as.numeric(TestPrediction > 0.5)
'org_babel_R_eoe'
writeLines("\n :: New data frame for plotting purposes...")
predictionDataFrame <- data.frame(TestPrediction,
                                  TestPredictionBinary, Test$State)
'org_babel_R_eoe'
writeLines("\n :: Number of states with TestPredictionbinary == 1:")
nrow(subset(predictionDataFrame, predictionDataFrame$TestPredictionBinary == 1))
'org_babel_R_eoe'
writeLines("\n :: The average predicted probability of our model:")
mean(predictionDataFrame$TestPrediction)
'org_babel_R_eoe'
writeLines("\n :: convert the Test.State variable to lowercase...")
predictionDataFrame$region <- tolower(predictionDataFrame$Test.State)
'org_babel_R_eoe'
writeLines("\n :: Merging the two data frames...")
predictionMap <- merge(statesMap, predictionDataFrame, by = "region")
'org_babel_R_eoe'
writeLines("\n :: Ordering the map data...")
predictionMap <- predictionMap[order(predictionMap$order),]
'org_babel_R_eoe'
writeLines("\n :: Number of observations in the predition map:")
nrow(predictionMap)
'org_babel_R_eoe'
writeLines("\n :: Number of observations in the states map:")
nrow(statesMap)
'org_babel_R_eoe'
writeLines("\n :: The predicted probability for Florida:")
head(predictionMap[predictionMap$region == "florida", ], 1)
'org_babel_R_eoe'
library(parallel)

if(!file.exists("../data")) {
        dir.create("../data")
}

fileUrl <-
        c("https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/edges.csv",
        "https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/users.csv")

fileName <- c("edges.csv", "users.csv")
dataPath <- "../data"

for(i in 1:2) {
        filePath <- paste(dataPath, fileName[i], sep = "/")

        if(!file.exists(filePath)) {
                download.file(fileUrl[i], destfile = filePath, method = "curl")
        }
}
writeLines("\n :: Files downloaded...")
'org_babel_R_eoe'
writeLines("\n :: Loading the data sets in dataframes...")
edges <- read.csv("../data/edges.csv", na.strings = c("NA", ""))
users <- read.csv("../data/users.csv", na.strings = c("NA", ""))

writeLines("\n :: Revising the edges dataframe structure:")
str(edges)

writeLines("\n :: Revising the users dataframe structure:")
str(users)
'org_babel_R_eoe'
writeLines("\n :: Number of frienship relationships:")
nrow(edges)

writeLines("\n :: Number of users:")
nrow(users)

writeLines("\n :: Average number of friends per user:")
(2 * nrow(edges)) / nrow(users)
'org_babel_R_eoe'
anyNA(users$school)
'org_babel_R_eoe'
subset(users, users$school != NA)
'org_babel_R_eoe'
writeLines("\n :: Loading the necessary libraries...")
library(ggplot2)
library(maps)
library(ggmap)
'org_babel_R_eoe'
writeLines("\n :: Load the US map in R...")
statesMap <- map_data("state")
'org_babel_R_eoe'
writeLines("\n :: Showing the structure of stateMap:")
str(statesMap)
'org_babel_R_eoe'
writeLines("\n :: The number of groups:")
str(factor(statesMap$group))

writeLines("\n :: Another useful way:")
table(statesMap$group)

writeLines("\n :: Yet another way to calculate:")
length(table(statesMap$group))
'org_babel_R_eoe'
library(parallel)

if(!file.exists("../data")) {
        dir.create("../data")
}

fileUrl <- "https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/PollingImputed.csv"
fileName <- "PollingImputed.csv"
dataPath <- "../data"

filePath <- paste(dataPath, fileName, sep = "/")

if(!file.exists(filePath)) {
        download.file(fileUrl, destfile = filePath, method = "curl")
}

writeLines("\n :: File downloaded...")
'org_babel_R_eoe'
writeLines("    Loading the imputed data into their data frame.")
polling <- read.table("../data/PollingImputed.csv", sep = ",", header = TRUE)
str(polling)
table(polling$Year)
summary(polling)
'org_babel_R_eoe'
writeLines("\n :: Subset data into training set and test set")
Train <- subset(polling, Year == 2004 | Year == 2008)
Test <- subset(polling, Year == 2012)
'org_babel_R_eoe'
writeLines("\n :: Revising the Testing data frame structure:")
str(Test)
'org_babel_R_eoe'
writeLines("\n :: Creating the Logistic Regression model...")
mod2 <- glm(Republican ~ SurveyUSA + DiffCount, data = Train,
            family = "binomial")

writeLines("\n :: Making preditions from Testing data set...")
TestPrediction <- predict(mod2, newdata = Test, type = "response")
'org_babel_R_eoe'
writeLines("\n :: Creting binary preditions with a threshold of 50%...")
TestPredictionBinary <- as.numeric(TestPrediction > 0.5)
'org_babel_R_eoe'
writeLines("\n :: New data frame for plotting purposes...")
predictionDataFrame <- data.frame(TestPrediction,
                                  TestPredictionBinary, Test$State)
'org_babel_R_eoe'
writeLines("\n :: Number of states with TestPredictionbinary == 1:")
nrow(subset(predictionDataFrame, predictionDataFrame$TestPredictionBinary == 1))
'org_babel_R_eoe'
writeLines("\n :: The average predicted probability of our model:")
mean(predictionDataFrame$TestPrediction)
'org_babel_R_eoe'
writeLines("\n :: convert the Test.State variable to lowercase...")
predictionDataFrame$region <- tolower(predictionDataFrame$Test.State)
'org_babel_R_eoe'
writeLines("\n :: Merging the two data frames...")
predictionMap <- merge(statesMap, predictionDataFrame, by = "region")
'org_babel_R_eoe'
writeLines("\n :: Ordering the map data...")
predictionMap <- predictionMap[order(predictionMap$order),]
'org_babel_R_eoe'
writeLines("\n :: Number of observations in the predition map:")
nrow(predictionMap)
'org_babel_R_eoe'
writeLines("\n :: Number of observations in the states map:")
nrow(statesMap)
'org_babel_R_eoe'
writeLines("\n :: The predicted probability for Florida:")
head(predictionMap[predictionMap$region == "florida", ], 1)
'org_babel_R_eoe'
library(parallel)

if(!file.exists("../data")) {
        dir.create("../data")
}

fileUrl <-
        c("https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/edges.csv",
        "https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/users.csv")

fileName <- c("edges.csv", "users.csv")
dataPath <- "../data"

for(i in 1:2) {
        filePath <- paste(dataPath, fileName[i], sep = "/")

        if(!file.exists(filePath)) {
                download.file(fileUrl[i], destfile = filePath, method = "curl")
        }
}
writeLines("\n :: Files downloaded...")
'org_babel_R_eoe'
writeLines("\n :: Loading the data sets in dataframes...")
edges <- read.csv("../data/edges.csv", na.strings = c("NA", ""),
                  stringsAsFactors = FALSE)
users <- read.csv("../data/users.csv", na.strings = c("NA", ""),
                  stringsAsFactors = FALSE)

writeLines("\n :: Revising the edges dataframe structure:")
str(edges)

writeLines("\n :: Revising the users dataframe structure:")
str(users)
'org_babel_R_eoe'
writeLines("\n :: Number of frienship relationships:")
nrow(edges)

writeLines("\n :: Number of users:")
nrow(users)

writeLines("\n :: Average number of friends per user:")
(2 * nrow(edges)) / nrow(users)
'org_babel_R_eoe'
subset(users, users$school != NA)
'org_babel_R_eoe'
class(users)
writeLines("\n :: the most common locale for students who listed a school:")
subset(users, users$school == "A" | users$school == "AB")
'org_babel_R_eoe'
users
writeLines("\n :: the most common locale for students who listed a school:")
subset(users, users$school == "A" | users$school == "AB")
'org_babel_R_eoe'
writeLines("\n :: the most common locale for students who listed a school:")
subset(users, users$school == "A" | users$school == "AB")

writeLines("\n :: Other way to answer:")
table(users$locale, users$school)
'org_babel_R_eoe'
writeLines("\n :: Are all students of the same gender in some school?")
table(users$school, users$gender)
'org_babel_R_eoe'
writeLines("\n :: Exploratory analysis of the data frame:")
summary(users)

writeLines("\n :: Are all students of the same gender in some school?")
table(users$school, users$gender)
'org_babel_R_eoe'
writeLines("\n :: Exploratory analysis of the data frame:")
summary(users)
str(users)

writeLines("\n :: Are all students of the same gender in some school?")
table(users$school, users$gender)
'org_babel_R_eoe'
writeLines("\n :: Exploratory analysis of the data frame:")
head(users, 20)

writeLines("\n :: Are all students of the same gender in some school?")
table(users$school, users$gender)
'org_babel_R_eoe'
writeLines("\n :: Install new package: igraph ...")
install.packages('igraph', repos='http://cran.rstudio.com/')
writeLines("\n :: NOTE: Please comment after install once...")

library(igraph)
writeLines("\n :: Library igraph loaded...")
'org_babel_R_eoe'
graph.data.frame(edges, FALSE, users)
graph.data.frame(edges, FALSE, users)
graph.data.frame(users, FALSE, edges) 
graph.data.frame(edges, TRUE, users) 
graph.data.frame(users, TRUE, edges) 
writeLines("\n :: Loading the data sets in dataframes...")
edges <- read.csv("../data/edges.csv", na.strings = "")
users <- read.csv("../data/users.csv", na.strings = "")

writeLines("\n :: Revising the edges dataframe structure:")
str(edges)

writeLines("\n :: Revising the users dataframe structure:")
str(users)
'org_babel_R_eoe'
writeLines("\n :: Loading the necessary libraries...")
library(ggplot2)
library(maps)
library(ggmap)
'org_babel_R_eoe'
writeLines("\n :: Load the US map in R...")
statesMap <- map_data("state")
'org_babel_R_eoe'
writeLines("\n :: Showing the structure of stateMap:")
str(statesMap)
'org_babel_R_eoe'
writeLines("\n :: The number of groups:")
str(factor(statesMap$group))

writeLines("\n :: Another useful way:")
table(statesMap$group)

writeLines("\n :: Yet another way to calculate:")
length(table(statesMap$group))
'org_babel_R_eoe'
library(parallel)

if(!file.exists("../data")) {
        dir.create("../data")
}

fileUrl <- "https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/PollingImputed.csv"
fileName <- "PollingImputed.csv"
dataPath <- "../data"

filePath <- paste(dataPath, fileName, sep = "/")

if(!file.exists(filePath)) {
        download.file(fileUrl, destfile = filePath, method = "curl")
}

writeLines("\n :: File downloaded...")
'org_babel_R_eoe'
writeLines("    Loading the imputed data into their data frame.")
polling <- read.table("../data/PollingImputed.csv", sep = ",", header = TRUE)
str(polling)
table(polling$Year)
summary(polling)
'org_babel_R_eoe'
writeLines("\n :: Subset data into training set and test set")
Train <- subset(polling, Year == 2004 | Year == 2008)
Test <- subset(polling, Year == 2012)
'org_babel_R_eoe'
writeLines("\n :: Revising the Testing data frame structure:")
str(Test)
'org_babel_R_eoe'
writeLines("\n :: Creating the Logistic Regression model...")
mod2 <- glm(Republican ~ SurveyUSA + DiffCount, data = Train,
            family = "binomial")

writeLines("\n :: Making preditions from Testing data set...")
TestPrediction <- predict(mod2, newdata = Test, type = "response")
'org_babel_R_eoe'
writeLines("\n :: Creting binary preditions with a threshold of 50%...")
TestPredictionBinary <- as.numeric(TestPrediction > 0.5)
'org_babel_R_eoe'
writeLines("\n :: New data frame for plotting purposes...")
predictionDataFrame <- data.frame(TestPrediction,
                                  TestPredictionBinary, Test$State)
'org_babel_R_eoe'
writeLines("\n :: Number of states with TestPredictionbinary == 1:")
nrow(subset(predictionDataFrame, predictionDataFrame$TestPredictionBinary == 1))
'org_babel_R_eoe'
writeLines("\n :: The average predicted probability of our model:")
mean(predictionDataFrame$TestPrediction)
'org_babel_R_eoe'
writeLines("\n :: convert the Test.State variable to lowercase...")
predictionDataFrame$region <- tolower(predictionDataFrame$Test.State)
'org_babel_R_eoe'
writeLines("\n :: Merging the two data frames...")
predictionMap <- merge(statesMap, predictionDataFrame, by = "region")
'org_babel_R_eoe'
writeLines("\n :: Ordering the map data...")
predictionMap <- predictionMap[order(predictionMap$order),]
'org_babel_R_eoe'
writeLines("\n :: Number of observations in the predition map:")
nrow(predictionMap)
'org_babel_R_eoe'
writeLines("\n :: Number of observations in the states map:")
nrow(statesMap)
'org_babel_R_eoe'
writeLines("\n :: The predicted probability for Florida:")
head(predictionMap[predictionMap$region == "florida", ], 1)
'org_babel_R_eoe'
library(parallel)

if(!file.exists("../data")) {
        dir.create("../data")
}

fileUrl <-
        c("https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/edges.csv",
        "https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/users.csv")

fileName <- c("edges.csv", "users.csv")
dataPath <- "../data"

for(i in 1:2) {
        filePath <- paste(dataPath, fileName[i], sep = "/")

        if(!file.exists(filePath)) {
                download.file(fileUrl[i], destfile = filePath, method = "curl")
        }
}
writeLines("\n :: Files downloaded...")
'org_babel_R_eoe'
writeLines("\n :: Loading the data sets in dataframes...")
edges <- read.csv("../data/edges.csv", na.strings = "")
users <- read.csv("../data/users.csv", na.strings = "")

writeLines("\n :: Revising the edges dataframe structure:")
str(edges)

writeLines("\n :: Revising the users dataframe structure:")
str(users)
'org_babel_R_eoe'
writeLines("\n :: Number of frienship relationships:")
nrow(edges)

writeLines("\n :: Number of users:")
nrow(users)

writeLines("\n :: Average number of friends per user:")
(2 * nrow(edges)) / nrow(users)
'org_babel_R_eoe'
writeLines("\n :: the most common locale for students who listed a school:")
subset(users, users$school == "A" | users$school == "AB")

writeLines("\n :: Other way to answer:")
table(users$locale, users$school)
'org_babel_R_eoe'
writeLines("\n :: Exploratory analysis of the data frame:")
head(users, 20)

writeLines("\n :: Are all students of the same gender in some school?")
table(users$school, users$gender)
'org_babel_R_eoe'
writeLines("\n :: Install new package: igraph ...")
## install.packages('igraph', repos='http://cran.rstudio.com/')
writeLines("\n :: NOTE: Please comment after install once...")

library(igraph)
writeLines("\n :: Library igraph loaded...")
'org_babel_R_eoe'
g
g1
g2
g3
g4
g1
g3
g1 <- graph.data.frame(edges, FALSE, users)
## g2 <- graph.data.frame(users, FALSE, edges)
g3 <- graph.data.frame(edges, TRUE, users)
## g4 <- graph.data.frame(users, TRUE, edges)
'org_babel_R_eoe'
g1 <- graph.data.frame(edges, FALSE, users)
## g2 <- graph.data.frame(users, FALSE, edges)
g3 <- graph.data.frame(edges, TRUE, users)
## g4 <- graph.data.frame(users, TRUE, edges)

writeLines("\n :: Out undirected graph g1:")
g1
'org_babel_R_eoe'
g1 <- graph.data.frame(edges, FALSE, users)
## g2 <- graph.data.frame(users, FALSE, edges)
g3 <- graph.data.frame(edges, TRUE, users)
## g4 <- graph.data.frame(users, TRUE, edges)

writeLines("\n :: Our undirected graph g1:")
g1
'org_babel_R_eoe'
writeLines("\n :: Calculating the degree of users in the graph:")
degree(g)
'org_babel_R_eoe'
writeLines("\n :: Calculating the degree of users in the graph:")
sort(degree(g), decreasing = TRUE)
'org_babel_R_eoe'
writeLines("\n :: Calculating the degree of users in the graph:")
sort(degree(g), decreasing = TRUE)

writeLines("\n :: Other useful way to calculate the degree > 10:")
table(degree(g) >= 10)
'org_babel_R_eoe'
writeLines("\n :: The largest size assigned to a node:")
sort(V(g)$size, decreasing = TRUE)
'org_babel_R_eoe'
V(g)
V(g)$color
V(g)$gender
V(g)$locale
V(g)$school
writeLines("\n :: Assigning black color to the nodes...")
V(g)$color <- "black"

writeLines("\n :: Assigning red color to gender A...")
V(g)$color[V(g)$gender == "A"] <- "red"

writeLines("\n :: Assigning gray color to gender B...")
V(g)$color[V(g)$gender == "B"] <- "gray"
'org_babel_R_eoe'
writeLines("\n :: Assigning black color to the nodes...")
V(g)$color <- "black"

writeLines("\n :: Assigning red color to gender A...")
V(g)$color[V(g)$school == "A"] <- "blue"

writeLines("\n :: Assigning gray color to gender B...")
V(g)$color[V(g)$shool == "AB"] <- "gray"
'org_babel_R_eoe'
writeLines("\n :: Assigning black color to the nodes...")
V(g)$color <- "black"

writeLines("\n :: Assigning red color to gender A...")
V(g)$color[V(g)$school == "A"] <- "blue"

writeLines("\n :: Assigning gray color to gender B...")
V(g)$color[V(g)$school == "AB"] <- "purple"
'org_babel_R_eoe'
V(g)$color[V(g)$school == "AB"] <- "purple"
V(g)$color[V(g)$school == "AB"] <- "gray"
writeLines("\n :: Assigning black color to the nodes...")
V(g)$color <- "black"

writeLines("\n :: Assigning red color to gender A...")
V(g)$color[V(g)$school == "A"] <- "blue"

writeLines("\n :: Assigning gray color to gender B...")
V(g)$color[V(g)$school == "AB"] <- "green"
'org_babel_R_eoe'
writeLines("\n :: Assigning black color to the nodes...")
V(g)$color <- "black"

writeLines("\n :: Assigning red color to gender A...")
V(g)$color[V(g)$school == "A"] <- "blue"

writeLines("\n :: Assigning gray color to gender B...")
V(g)$color[V(g)$school == "AB"] <- "red"
'org_babel_R_eoe'
writeLines("\n :: Assigning black color to the nodes...")
V(g)$color <- "black"

writeLines("\n :: Assigning blue color to school A...")
V(g)$color[V(g)$school == "A"] <- "blue"

writeLines("\n :: Assigning red color to school AB...")
V(g)$color[V(g)$school == "AB"] <- "red"
'org_babel_R_eoe'
V(g)$school
V(g)$locale
writeLines("\n :: Assigning black color to the nodes...")
V(g)$color <- "black"

writeLines("\n :: Assigning green color to locale A...")
V(g)$color[V(g)$locale == "A"] <- "green"

writeLines("\n :: Assigning red color to locale B...")
V(g)$color[V(g)$locale == "B"] <- "red"
'org_babel_R_eoe'
?igraph.plotting
writeLines("\n :: Install new package: rgl ...")
install.packages('rgl', repos='http://cran.rstudio.com/')
writeLines("\n :: NOTE: Please comment after install once...")

library(rgl)
writeLines("\n :: Library rgl loaded...")
'org_babel_R_eoe'
n
writeLines("\n :: Install new package: rgl ...")
## install.packages('rgl', repos='http://cran.rstudio.com/')
writeLines("\n :: NOTE: Please comment after install once...")

library(rgl)
writeLines("\n :: Library rgl loaded...")
'org_babel_R_eoe'
writeLines("\n :: Install new package: rgl ...")
## install.packages('rgl', repos='http://cran.rstudio.com/')
writeLines("\n :: NOTE: Please comment after install once...")

library(rgl)
writeLines("\n :: Library rgl loaded...")
'org_babel_R_eoe'
writeLines("\n :: Install new package: rgl ...")
## install.packages('rgl', repos='http://cran.rstudio.com/')
writeLines("\n :: NOTE: Please comment after install once...")

library(rgl)
writeLines("\n :: Library rgl loaded...")
'org_babel_R_eoe'
?igraph.plotting
writeLines("\n :: Loading the necessary libraries...")
library(ggplot2)
library(maps)
library(ggmap)
'org_babel_R_eoe'
writeLines("\n :: Load the US map in R...")
statesMap <- map_data("state")
'org_babel_R_eoe'
writeLines("\n :: Showing the structure of stateMap:")
str(statesMap)
'org_babel_R_eoe'
writeLines("\n :: The number of groups:")
str(factor(statesMap$group))

writeLines("\n :: Another useful way:")
table(statesMap$group)

writeLines("\n :: Yet another way to calculate:")
length(table(statesMap$group))
'org_babel_R_eoe'
library(parallel)

if(!file.exists("../data")) {
        dir.create("../data")
}

fileUrl <- "https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/PollingImputed.csv"
fileName <- "PollingImputed.csv"
dataPath <- "../data"

filePath <- paste(dataPath, fileName, sep = "/")

if(!file.exists(filePath)) {
        download.file(fileUrl, destfile = filePath, method = "curl")
}

writeLines("\n :: File downloaded...")
'org_babel_R_eoe'
writeLines("    Loading the imputed data into their data frame.")
polling <- read.table("../data/PollingImputed.csv", sep = ",", header = TRUE)
str(polling)
table(polling$Year)
summary(polling)
'org_babel_R_eoe'
writeLines("\n :: Subset data into training set and test set")
Train <- subset(polling, Year == 2004 | Year == 2008)
Test <- subset(polling, Year == 2012)
'org_babel_R_eoe'
writeLines("\n :: Revising the Testing data frame structure:")
str(Test)
'org_babel_R_eoe'
writeLines("\n :: Creating the Logistic Regression model...")
mod2 <- glm(Republican ~ SurveyUSA + DiffCount, data = Train,
            family = "binomial")

writeLines("\n :: Making preditions from Testing data set...")
TestPrediction <- predict(mod2, newdata = Test, type = "response")
'org_babel_R_eoe'
writeLines("\n :: Creting binary preditions with a threshold of 50%...")
TestPredictionBinary <- as.numeric(TestPrediction > 0.5)
'org_babel_R_eoe'
writeLines("\n :: New data frame for plotting purposes...")
predictionDataFrame <- data.frame(TestPrediction,
                                  TestPredictionBinary, Test$State)
'org_babel_R_eoe'
writeLines("\n :: Number of states with TestPredictionbinary == 1:")
nrow(subset(predictionDataFrame, predictionDataFrame$TestPredictionBinary == 1))
'org_babel_R_eoe'
writeLines("\n :: The average predicted probability of our model:")
mean(predictionDataFrame$TestPrediction)
'org_babel_R_eoe'
writeLines("\n :: convert the Test.State variable to lowercase...")
predictionDataFrame$region <- tolower(predictionDataFrame$Test.State)
'org_babel_R_eoe'
writeLines("\n :: Merging the two data frames...")
predictionMap <- merge(statesMap, predictionDataFrame, by = "region")
'org_babel_R_eoe'
writeLines("\n :: Ordering the map data...")
predictionMap <- predictionMap[order(predictionMap$order),]
'org_babel_R_eoe'
writeLines("\n :: Number of observations in the predition map:")
nrow(predictionMap)
'org_babel_R_eoe'
writeLines("\n :: Number of observations in the states map:")
nrow(statesMap)
'org_babel_R_eoe'
writeLines("\n :: The predicted probability for Florida:")
head(predictionMap[predictionMap$region == "florida", ], 1)
'org_babel_R_eoe'
library(parallel)

if(!file.exists("../data")) {
        dir.create("../data")
}

fileUrl <-
        c("https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/edges.csv",
        "https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/users.csv")

fileName <- c("edges.csv", "users.csv")
dataPath <- "../data"

for(i in 1:2) {
        filePath <- paste(dataPath, fileName[i], sep = "/")

        if(!file.exists(filePath)) {
                download.file(fileUrl[i], destfile = filePath, method = "curl")
        }
}
writeLines("\n :: Files downloaded...")
'org_babel_R_eoe'
writeLines("\n :: Loading the data sets in dataframes...")
edges <- read.csv("../data/edges.csv", na.strings = "")
users <- read.csv("../data/users.csv", na.strings = "")

writeLines("\n :: Revising the edges dataframe structure:")
str(edges)

writeLines("\n :: Revising the users dataframe structure:")
str(users)
'org_babel_R_eoe'
writeLines("\n :: Number of frienship relationships:")
nrow(edges)

writeLines("\n :: Number of users:")
nrow(users)

writeLines("\n :: Average number of friends per user:")
(2 * nrow(edges)) / nrow(users)
'org_babel_R_eoe'
writeLines("\n :: the most common locale for students who listed a school:")
subset(users, users$school == "A" | users$school == "AB")

writeLines("\n :: Other way to answer:")
table(users$locale, users$school)
'org_babel_R_eoe'
writeLines("\n :: Exploratory analysis of the data frame:")
head(users, 20)

writeLines("\n :: Are all students of the same gender in some school?")
table(users$school, users$gender)
'org_babel_R_eoe'
writeLines("\n :: Install new package: igraph ...")
## install.packages('igraph', repos='http://cran.rstudio.com/')
writeLines("\n :: NOTE: Please comment after install once...")

library(igraph)
writeLines("\n :: Library igraph loaded...")
'org_babel_R_eoe'
g1 <- graph.data.frame(edges, FALSE, users)
## g2 <- graph.data.frame(users, FALSE, edges)
g3 <- graph.data.frame(edges, TRUE, users)
## g4 <- graph.data.frame(users, TRUE, edges)

writeLines("\n :: Our undirected graph g1:")
g1
'org_babel_R_eoe'
writeLines("\n :: Calculating the degree of users in the graph:")
sort(degree(g), decreasing = TRUE)

writeLines("\n :: Other useful way to calculate the degree > 10:")
table(degree(g) >= 10)
'org_babel_R_eoe'
writeLines("\n :: The largest size assigned to a node:")
sort(V(g)$size, decreasing = TRUE)
'org_babel_R_eoe'
writeLines("\n :: Assigning black color to the nodes...")
V(g)$color <- "black"

writeLines("\n :: Assigning red color to gender A...")
V(g)$color[V(g)$gender == "A"] <- "red"

writeLines("\n :: Assigning gray color to gender B...")
V(g)$color[V(g)$gender == "B"] <- "gray"
'org_babel_R_eoe'
writeLines("\n :: Assigning black color to the nodes...")
V(g)$color <- "black"

writeLines("\n :: Assigning blue color to school A...")
V(g)$color[V(g)$school == "A"] <- "blue"

writeLines("\n :: Assigning red color to school AB...")
V(g)$color[V(g)$school == "AB"] <- "red"
'org_babel_R_eoe'
writeLines("\n :: Assigning black color to the nodes...")
V(g)$color <- "black"

writeLines("\n :: Assigning green color to locale A...")
V(g)$color[V(g)$locale == "A"] <- "green"

writeLines("\n :: Assigning red color to locale B...")
V(g)$color[V(g)$locale == "B"] <- "red"
'org_babel_R_eoe'
writeLines("\n :: Install new package: rgl ...")
## install.packages('rgl', repos='http://cran.rstudio.com/')
writeLines("\n :: NOTE: Please comment after install once...")

library(rgl)
writeLines("\n :: Library rgl loaded...")
'org_babel_R_eoe'
q()
n
