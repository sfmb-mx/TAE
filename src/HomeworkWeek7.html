<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Assignment 7. Visualization</title>
<!-- 2015-07-26 Sun 10:58 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Sergio-Feliciano Mendoza-Barrera" />
<meta  name="description" content="Unit 7 Visualization Assignment of the Analytical Edge course"
 />
<meta  name="keywords" content="R, data science, emacs, ESS, org-mode, the analytical edge, visualization" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Assignment 7. Visualization</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Election Forecasting Revisited</a>
<ul>
<li><a href="#sec-1-1">1.1. Problem 1.1 - Drawing a Map of the US (1 point possible)</a></li>
<li><a href="#sec-1-2">1.2. Problem 1.2 - Drawing a Map of the US (1 point possible)</a></li>
<li><a href="#sec-1-3">1.3. Problem 2.1 - Coloring the States by Predictions (2 points possible)</a></li>
<li><a href="#sec-1-4">1.4. Problem 2.2 - Coloring the States by Predictions (2 points possible)</a></li>
<li><a href="#sec-1-5">1.5. Problem 2.3 - Coloring the States by Predictions (1 point possible)</a></li>
<li><a href="#sec-1-6">1.6. Problem 2.4 - Coloring the States by Predictions (1 point possible)</a></li>
<li><a href="#sec-1-7">1.7. Problem 2.5 - Coloring the States by Predictions (1 point possible)</a></li>
<li><a href="#sec-1-8">1.8. Problem 3.1 - Understanding the Predictions (1 point possible)</a></li>
<li><a href="#sec-1-9">1.9. Problem 3.2 - Understanding the Predictions (2 points possible)</a></li>
<li><a href="#sec-1-10">1.10. Problem 4 - Parameter Settings</a></li>
<li><a href="#sec-1-11">1.11. Problem 4.1 - Parameter Settings (2/2 points)</a></li>
<li><a href="#sec-1-12">1.12. Problem 4.2 - Parameter Settings (1 point possible)</a></li>
</ul>
</li>
<li><a href="#sec-2">2. Visualizing Network Data</a>
<ul>
<li><a href="#sec-2-1">2.1. Problem 1.1 - Summarizing the Data (2 points possible)</a></li>
<li><a href="#sec-2-2">2.2. Problem 1.2 - Summarizing the Data (1 point possible)</a></li>
<li><a href="#sec-2-3">2.3. Problem 1.3 - Summarizing the Data (1 point possible)</a></li>
<li><a href="#sec-2-4">2.4. Problem 2.1 - Creating a Network (1 point possible)</a></li>
<li><a href="#sec-2-5">2.5. Problem 2.2 - Creating a Network (2 points possible)</a></li>
<li><a href="#sec-2-6">2.6. Problem 2.3 - Creating a Network (1 point possible)</a></li>
<li><a href="#sec-2-7">2.7. Problem 2.4 - Creating a Network (2 points possible)</a></li>
<li><a href="#sec-2-8">2.8. Problem 3.1 - Coloring Vertices (1 point possible)</a></li>
<li><a href="#sec-2-9">2.9. Problem 3.2 - Coloring Vertices (2 points possible)</a></li>
<li><a href="#sec-2-10">2.10. Problem 3.3 - Coloring Vertices (2 points possible)</a></li>
<li><a href="#sec-2-11">2.11. Problem 4 - Other Plotting Options (2 points possible)</a></li>
</ul>
</li>
<li><a href="#sec-3">3. Visualizing Text Data Using Word CLouds</a>
<ul>
<li><a href="#sec-3-1">3.1. Problem 1.1 - Preparing the Data (1 point possible)</a></li>
<li><a href="#sec-3-2">3.2. Problem 1.2 - Preparing the Data (1 point possible)</a></li>
<li><a href="#sec-3-3">3.3. Problem 2.1 - Building a Word Cloud (1 point possible)</a></li>
<li><a href="#sec-3-4">3.4. Problem 2.2 - Building a Word Cloud (1 point possible)</a></li>
<li><a href="#sec-3-5">3.5. Problem 2.3 - Building a Word Cloud (1 point possible)</a></li>
<li><a href="#sec-3-6">3.6. Problem 2.4 - Building a Word Cloud (1 point possible)</a></li>
<li><a href="#sec-3-7">3.7. Problem 3 - Size and Color</a></li>
<li><a href="#sec-3-8">3.8. Problem 3.1 - Size and Color (1 point possible)</a></li>
<li><a href="#sec-3-9">3.9. Problem 3.2 - Size and Color (1 point possible)</a></li>
<li><a href="#sec-3-10">3.10. Problem 3.3 - Size and Color (1 point possible)</a></li>
<li><a href="#sec-3-11">3.11. Problem 3.4 - Size and Color (1 point possible)</a></li>
<li><a href="#sec-3-12">3.12. Problem 3.5 - Size and Color (1 point possible)</a></li>
<li><a href="#sec-3-13">3.13. Problem 4.1 - Selecting a Color Palette (1 point possible)</a></li>
<li><a href="#sec-3-14">3.14. Problem 4.2 - Selecting a Color Palette (1 point possible)</a></li>
<li><a href="#sec-3-15">3.15. Problem 4.3 - Selecting a Color Palette (1 point possible)</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="abstract">
<p>
Unit 7 Visualization assignment of The Analytical Edge course from MIT.
</p>

</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Election Forecasting Revisited</h2>
<div class="outline-text-2" id="text-1">
<p>
In the recitation from Unit 3, we used logistic regression on polling
data in order to construct US presidential election predictions. We
separated our data into a training set, containing data from 2004 and
2008 polls, and a test set, containing the data from 2012 polls. We
then proceeded to develop a logistic regression model to forecast the
2012 US presidential election.
</p>

<p>
In this homework problem, we'll revisit our logistic regression model
from Unit 3, and learn how to plot the output on a map of the United
States. Unlike what we did in the Crime lecture, this time we'll be
plotting predictions rather than data!
</p>

<p>
First, load the <code>ggplot2</code>, <code>maps</code>, and <code>ggmap</code> packages using the
library function. All three packages should be installed on your
computer from lecture, but if not, you may need to install them too
using the <code>install.packages</code> function.
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Loading the necessary libraries..."</span>)
<span style="color: #db7093;">library</span>(ggplot2)
<span style="color: #db7093;">library</span>(maps)
<span style="color: #db7093;">library</span>(ggmap)
</pre>
</div>

<pre class="example">
:: Loading the necessary libraries...
</pre>

<p>
Then, load the US map and save it to the variable statesMap, like we
did during the Crime lecture:
</p>

<p>
<code>statesMap = map_data("state")</code>
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Load the US map in R..."</span>)
statesMap <span style="color: #db7093;">&lt;-</span> map_data(<span style="color: #ff6a6a;">"state"</span>)
</pre>
</div>

<pre class="example">
:: Load the US map in R...
</pre>

<p>
The maps package contains other built-in maps, including a US county
map, a world map, and maps for France and Italy.
</p>
</div>

<div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Problem 1.1 - Drawing a Map of the US (1 point possible)</h3>
<div class="outline-text-3" id="text-1-1">
<p>
If you look at the structure of the statesMap data frame using the <code>str</code>
function, you should see that there are 6 variables. One of the
variables, group, defines the different shapes or polygons on the
map. Sometimes a state may have multiple groups, for example, if it
includes islands.
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Showing the structure of stateMap:"</span>)
str(statesMap)
</pre>
</div>

<pre class="example">
 :: Showing the structure of stateMap:
'data.frame':   15537 obs. of  6 variables:
 $ long     : num  -87.5 -87.5 -87.5 -87.5 -87.6 ...
 $ lat      : num  30.4 30.4 30.4 30.3 30.3 ...
 $ group    : num  1 1 1 1 1 1 1 1 1 1 ...
 $ order    : int  1 2 3 4 5 6 7 8 9 10 ...
 $ region   : chr  "alabama" "alabama" "alabama" "alabama" ...
 $ subregion: chr  NA NA NA NA ...
</pre>
</div>

<div id="outline-container-sec-1-1-1" class="outline-4">
<h4 id="sec-1-1-1"><span class="section-number-4">1.1.1</span> Question</h4>
<div class="outline-text-4" id="text-1-1-1">
<p>
How many different groups are there?
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: The number of groups:"</span>)
str(factor(statesMap$group))

writeLines(<span style="color: #ff6a6a;">"\n :: Another useful way:"</span>)
table(statesMap$group)

writeLines(<span style="color: #ff6a6a;">"\n :: Yet another way to calculate:"</span>)
length(table(statesMap$group))
</pre>
</div>

<pre class="example">
 :: The number of groups:
 Factor w/ 63 levels "1","2","3","4",..: 1 1 1 1 1 1 1 1 1 1 ...

 :: Another useful way:

   1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16
 202  149  312  516   79   91   94   10  872  381  233  329  257  256  113  397
  17   18   19   20   21   22   23   24   25   26   27   28   29   30   31   32
 650  399  566   36  220   30  460  370  373  382  315  238  208   70  125  205
  33   34   35   36   37   38   39   40   41   42   43   44   45   46   47   48
  78   16  290   21  168   37  733   12  105  238  284  236  172   66  304  166
  49   50   51   52   53   54   55   56   57   58   59   60   61   62   63
 289 1088   59  129   96   15  623   17   17   19   44  448  373  388   68

 :: Yet another way to calculate:
[1] 63
</pre>
</div>

<div id="outline-container-sec-1-1-1-1" class="outline-5">
<h5 id="sec-1-1-1-1"><span class="section-number-5">1.1.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-1-1-1-1">
<p>
63
</p>

<p>
<b>Explanation</b>
</p>

<p>
You can count the number of different values of the group variable by
using the command <code>table(statesMap$group)</code>. There are \(63\) different
values.
</p>

<p>
Alternatively, you could use the command
</p>

<p>
<code>length(table(statesMap$group))</code>
</p>

<p>
as a shortcut to counting the number of groups in the table output.
</p>

<p>
The variable <code>order</code> defines the order to connect the points within
each group, and the variable <code>region</code> gives the name of the state.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Problem 1.2 - Drawing a Map of the US (1 point possible)</h3>
<div class="outline-text-3" id="text-1-2">
<p>
You can draw a map of the United States by typing the following in
your R console:
</p>


<div id="fig:USmapHW01" class="figure">
<p><img src="../graphs/USmapHW01.png" alt="USmapHW01.png" />
</p>
<p><span class="figure-number">Figure 1:</span> United States map in R</p>
</div>

<p>
We specified two colors in geom_polygon &#x2013; <code>fill</code> and <code>color</code>. Which
one defined the color of the outline of the states?
</p>
</div>

<div id="outline-container-sec-1-2-1" class="outline-4">
<h4 id="sec-1-2-1"><span class="section-number-4">1.2.1</span> Answer</h4>
<div class="outline-text-4" id="text-1-2-1">
<ul class="org-ul">
<li><code>[&#xa0;]</code> fill
</li>
<li><code>[X]</code> color color - correct
</li>
<li><code>[&#xa0;]</code> Neither
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
In our plot, the states are outlined in black, which is the color we
specified for the option <code>color</code>. To confirm that this is changing the
outline color of the states, you can try re-running the command with a
different color:
</p>


<div id="fig:USMapHW02" class="figure">
<p><img src="../graphs/USMapHW02.png" alt="USMapHW02.png" />
</p>
<p><span class="figure-number">Figure 2:</span> United States map in other outline color</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> Problem 2.1 - Coloring the States by Predictions (2 points possible)</h3>
<div class="outline-text-3" id="text-1-3">
<p>
Now, let's color the map of the US according to our 2012 US
presidential election predictions from the Unit 3 Recitation. We'll
rebuild the model here, using the dataset <code>PollingImputed.csv</code>. Be sure
to use this file so that you don't have to redo the imputation to fill
in the missing values, like we did in the Unit 3 Recitation.
</p>

<div class="org-src-container">

<pre class="src src-R"><span style="color: #db7093;">library</span>(parallel)

<span style="color: #4682b4;">if</span>(!file.exists(<span style="color: #ff6a6a;">"../data"</span>)) {
        dir.create(<span style="color: #ff6a6a;">"../data"</span>)
}

fileUrl <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/PollingImputed.csv"</span>
fileName <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"PollingImputed.csv"</span>
dataPath <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"../data"</span>

filePath <span style="color: #db7093;">&lt;-</span> paste(dataPath, fileName, sep = <span style="color: #ff6a6a;">"/"</span>)

<span style="color: #4682b4;">if</span>(!file.exists(filePath)) {
        download.file(fileUrl, destfile = filePath, method = <span style="color: #ff6a6a;">"curl"</span>)
}

writeLines(<span style="color: #ff6a6a;">"\n :: File downloaded..."</span>)
</pre>
</div>

<pre class="example">
quartz_off_screen
                2
 quartz_off_screen
                2

 :: File downloaded...
</pre>

<p>
Load the data using the <code>read.csv</code> function, and call it <code>polling</code>. Then
split the data using the subset function into a training set called
<code>Train</code> that has observations from 2004 and 2008, and a testing set
called <code>Test</code> that has observations from 2012.
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"    Loading the imputed data into their data frame."</span>)
polling <span style="color: #db7093;">&lt;-</span> read.table(<span style="color: #ff6a6a;">"../data/PollingImputed.csv"</span>, sep = <span style="color: #ff6a6a;">","</span>, header = <span style="color: #3cb371;">TRUE</span>)
str(polling)
table(polling$Year)
summary(polling)
</pre>
</div>

<pre class="example">
    Loading the imputed data into their data frame.
'data.frame':	145 obs. of  7 variables:
 $ State     : Factor w/ 50 levels "Alabama","Alaska",..: 1 1 2 2 3 3 3 4 4 4 ...
 $ Year      : int  2004 2008 2004 2008 2004 2008 2012 2004 2008 2012 ...
 $ Rasmussen : int  11 21 19 16 5 5 8 7 10 13 ...
 $ SurveyUSA : int  18 25 21 18 15 3 5 5 7 21 ...
 $ DiffCount : int  5 5 1 6 8 9 4 8 5 2 ...
 $ PropR     : num  1 1 1 1 1 ...
 $ Republican: int  1 1 1 1 1 1 1 1 1 1 ...

2004 2008 2012
  50   50   45
         State          Year        Rasmussen         SurveyUSA
 Arizona    :  3   Min.   :2004   Min.   :-41.000   Min.   :-33.000
 Arkansas   :  3   1st Qu.:2004   1st Qu.:-10.000   1st Qu.:-11.000
 California :  3   Median :2008   Median :  3.000   Median :  1.000
 Colorado   :  3   Mean   :2008   Mean   :  2.048   Mean   :  1.359
 Connecticut:  3   3rd Qu.:2012   3rd Qu.: 12.000   3rd Qu.: 16.000
 Florida    :  3   Max.   :2012   Max.   : 39.000   Max.   : 30.000
 (Other)    :127
   DiffCount           PropR          Republican
 Min.   :-19.000   Min.   :0.0000   Min.   :0.0000
 1st Qu.: -6.000   1st Qu.:0.0000   1st Qu.:0.0000
 Median :  1.000   Median :0.6250   Median :1.0000
 Mean   : -1.269   Mean   :0.5259   Mean   :0.5103
 3rd Qu.:  4.000   3rd Qu.:1.0000   3rd Qu.:1.0000
 Max.   : 11.000   Max.   :1.0000   Max.   :1.0000
</pre>

<p>
Splitting the dataset in two data frames <code>Train</code> and <code>Test</code> data frames.
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Subset data into training set and test set"</span>)
Train <span style="color: #db7093;">&lt;-</span> subset(polling, Year == 2004 | Year == 2008)
Test <span style="color: #db7093;">&lt;-</span> subset(polling, Year == 2012)
</pre>
</div>

<pre class="example">
:: Subset data into training set and test set
</pre>

<p>
Note that we only have 45 states in our testing set, since we are
missing observations for Alaska, Delaware, Alabama, Wyoming, and
Vermont, so these states will not appear colored in our map.
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Revising the Testing data frame structure:"</span>)
str(Test)
</pre>
</div>

<pre class="example">
 :: Revising the Testing data frame structure:
'data.frame':	45 obs. of  7 variables:
 $ State     : Factor w/ 50 levels "Alabama","Alaska",..: 3 4 5 6 7 9 10 11 12 13 ...
 $ Year      : int  2012 2012 2012 2012 2012 2012 2012 2012 2012 2012 ...
 $ Rasmussen : int  8 13 -12 3 -7 2 5 -22 31 -22 ...
 $ SurveyUSA : int  5 21 -14 -2 -13 0 8 -24 24 -16 ...
 $ DiffCount : int  4 2 -6 -5 -8 6 4 -2 1 -5 ...
 $ PropR     : num  0.833 1 0 0.308 0 ...
 $ Republican: int  1 1 0 0 0 0 1 0 1 0 ...
</pre>

<p>
Then, create a logistic regression model and make predictions on the
test set using the following commands:
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Creating the Logistic Regression model..."</span>)
mod2 <span style="color: #db7093;">&lt;-</span> glm(Republican ~ SurveyUSA + DiffCount, data = Train,
            family = <span style="color: #ff6a6a;">"binomial"</span>)

writeLines(<span style="color: #ff6a6a;">"\n :: Making preditions from Testing data set..."</span>)
TestPrediction <span style="color: #db7093;">&lt;-</span> predict(mod2, newdata = Test, type = <span style="color: #ff6a6a;">"response"</span>)
</pre>
</div>

<pre class="example">
:: Creating the Logistic Regression model...

:: Making preditions from Testing data set...
</pre>

<p>
<code>TestPrediction</code> gives the predicted probabilities for each state, but
let's also create a vector of Republican/Democrat predictions by using
the following command:
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Creting binary preditions with a threshold of 50%..."</span>)
TestPredictionBinary <span style="color: #db7093;">&lt;-</span> as.numeric(TestPrediction &gt; 0.5)
</pre>
</div>

<pre class="example">
:: Creting binary preditions with a threshold of 50%...
</pre>

<p>
Now, put the predictions and state labels in a data.frame so that we
can use <code>ggplot</code>:
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: New data frame for plotting purposes..."</span>)
predictionDataFrame <span style="color: #db7093;">&lt;-</span> data.frame(TestPrediction,
                                  TestPredictionBinary, Test$State)
</pre>
</div>

<pre class="example">
:: New data frame for plotting purposes...
</pre>

<p>
To make sure everything went smoothly, answer the following
questions.
</p>
</div>

<div id="outline-container-sec-1-3-1" class="outline-4">
<h4 id="sec-1-3-1"><span class="section-number-4">1.3.1</span> Question a</h4>
<div class="outline-text-4" id="text-1-3-1">
<p>
For how many states is our binary prediction 1 (for 2012),
corresponding to Republican?
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Number of states with TestPredictionbinary == 1:"</span>)
nrow(subset(predictionDataFrame, predictionDataFrame$TestPredictionBinary == 1))
</pre>
</div>

<pre class="example">
 :: Number of states with TestPredictionbinary == 1:
[1] 22
</pre>
</div>

<div id="outline-container-sec-1-3-1-1" class="outline-5">
<h5 id="sec-1-3-1-1"><span class="section-number-5">1.3.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-1-3-1-1">
<p>
22
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-3-2" class="outline-4">
<h4 id="sec-1-3-2"><span class="section-number-4">1.3.2</span> Question</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
What is the average predicted probability of our model (on the Test
set, for 2012)?
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: The average predicted probability of our model:"</span>)
mean(predictionDataFrame$TestPrediction)
</pre>
</div>

<pre class="example">
 :: The average predicted probability of our model:
[1] 0.4852626
</pre>
</div>

<div id="outline-container-sec-1-3-2-1" class="outline-5">
<h5 id="sec-1-3-2-1"><span class="section-number-5">1.3.2.1</span> Answer</h5>
<div class="outline-text-5" id="text-1-3-2-1">
<p>
0.4852626
</p>

<p>
<b>Explanation</b>
</p>

<p>
You can create the data frame predictionDataFrame by running the
following lines of R code:
</p>

<p>
<code>polling = read.csv("PollingImputed.csv")</code>
</p>

<p>
<code>Train = subset(polling, Year &lt; 2012)</code>
</p>

<p>
<code>Test = subset(polling, Year == 2012)</code>
</p>

<p>
<code>mod2 = glm(Republican~SurveyUSA+DiffCount, data=Train, family="binomial")</code>
</p>

<p>
<code>TestPrediction = predict(mod2, newdata=Test, type="response")</code>
</p>

<p>
TestPredictionBinary = as.numeric(TestPrediction &gt; 0.5)~
</p>

<p>
<code>predictionDataFrame = data.frame(TestPrediction, TestPredictionBinary, Test$State)</code>
</p>

<p>
You can answer the two questions with the functions
<code>table(TestPredictionBinary)</code> and <code>mean(TestPrediction)</code>.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> Problem 2.2 - Coloring the States by Predictions (2 points possible)</h3>
<div class="outline-text-3" id="text-1-4">
<p>
Now, we need to merge <code>predictionDataFrame</code> with the map data
<code>statesMap</code>, like we did in lecture. Before doing so, we need to
convert the <code>Test.State</code> variable to lowercase, so that it matches the
region variable in <code>statesMap</code>. Do this by typing the following in your
R console:
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: convert the Test.State variable to lowercase..."</span>)
predictionDataFrame$region <span style="color: #db7093;">&lt;-</span> tolower(predictionDataFrame$Test.State)
</pre>
</div>

<pre class="example">
:: convert the Test.State variable to lowercase...
</pre>

<p>
Now, merge the two data frames using the following command:
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Merging the two data frames..."</span>)
predictionMap <span style="color: #db7093;">&lt;-</span> merge(statesMap, predictionDataFrame, by = <span style="color: #ff6a6a;">"region"</span>)
</pre>
</div>

<pre class="example">
:: Merging the two data frames...
</pre>

<p>
Lastly, we need to make sure the observations are in order so that the
map is drawn properly, by typing the following:
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Ordering the map data..."</span>)
predictionMap <span style="color: #db7093;">&lt;-</span> predictionMap[order(predictionMap$order),]
</pre>
</div>

<pre class="example">
:: Ordering the map data...
</pre>
</div>

<div id="outline-container-sec-1-4-1" class="outline-4">
<h4 id="sec-1-4-1"><span class="section-number-4">1.4.1</span> Question</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
How many observations are there in <code>predictionMap</code>?
</p>
</div>

<div id="outline-container-sec-1-4-1-1" class="outline-5">
<h5 id="sec-1-4-1-1"><span class="section-number-5">1.4.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-1-4-1-1">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Number of observations in the predition map:"</span>)
nrow(predictionMap)
</pre>
</div>

<pre class="example">
 :: Number of observations in the predition map:
[1] 15034
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-1-4-2" class="outline-4">
<h4 id="sec-1-4-2"><span class="section-number-4">1.4.2</span> Question</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
How many observations are there in <code>statesMap</code>?
</p>
</div>

<div id="outline-container-sec-1-4-2-1" class="outline-5">
<h5 id="sec-1-4-2-1"><span class="section-number-5">1.4.2.1</span> Answer</h5>
<div class="outline-text-5" id="text-1-4-2-1">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Number of observations in the states map:"</span>)
nrow(statesMap)
</pre>
</div>

<pre class="example">
 :: Number of observations in the states map:
[1] 15537
</pre>

<p>
<b>Explanation</b>
</p>

<p>
If you type <code>str(predictionMap)</code>, you should see that there are \(15034\)
observations, and if you type <code>str(statesMap)</code> you should see that there
are \(15537\) observations.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-5" class="outline-3">
<h3 id="sec-1-5"><span class="section-number-3">1.5</span> Problem 2.3 - Coloring the States by Predictions (1 point possible)</h3>
<div class="outline-text-3" id="text-1-5">
<p>
When we merged the data in the previous problem, it caused the number
of observations to change. Why? Check out the help page for merge by
typing ?merge to help you answer this question.
</p>
</div>

<div id="outline-container-sec-1-5-1" class="outline-4">
<h4 id="sec-1-5-1"><span class="section-number-4">1.5.1</span> Answer</h4>
<div class="outline-text-4" id="text-1-5-1">
<ul class="org-ul">
<li><code>[&#xa0;]</code> Merging the data just combines the two data frames like it would
if we used rbind, so the number of observations increased.
</li>

<li><code>[&#xa0;]</code> We have more observations for each state now, because some
observations have the statesMap data, and some observations have the
prediction data.
</li>

<li><code>[X]</code> Because we only make predictions for 45 states, we no longer
have observations for some of the states. These observations were
removed in the merging process.
</li>

<li><code>[&#xa0;]</code> We merged the observations for which our predictions are
identical.
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
When we merge data, it only merged the observations that exist in both
data sets. So since we are merging based on the region variable, we
will lose all observations that have a value of <code>region</code> that doesn't
exist in both data frames.
</p>

<p>
You can change this default behavior by using the <code>all.x</code> and <code>all.y</code>
arguments of the merge function. For more information, look at the
help page for the merge function by typing <code>?merge</code> in your R console.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-6" class="outline-3">
<h3 id="sec-1-6"><span class="section-number-3">1.6</span> Problem 2.4 - Coloring the States by Predictions (1 point possible)</h3>
<div class="outline-text-3" id="text-1-6">
<p>
Now we are ready to color the US map with our predictions! You can
color the states according to our binary predictions by typing the
following in your R console:
</p>


<div id="fig:USElectionsPredictions01" class="figure">
<p><img src="../graphs/USElectionsPredictions01.png" alt="USElectionsPredictions01.png" />
</p>
<p><span class="figure-number">Figure 3:</span> US Presidential predictions map v1</p>
</div>

<p>
The states appear light blue and dark blue in this map. Which color
represents a Republican prediction?
</p>
</div>

<div id="outline-container-sec-1-6-1" class="outline-4">
<h4 id="sec-1-6-1"><span class="section-number-4">1.6.1</span> Answer</h4>
<div class="outline-text-4" id="text-1-6-1">
<ul class="org-ul">
<li><code>[X]</code> Light blue
</li>
<li><code>[&#xa0;]</code> Dark blue
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
Our logistic regression model assigned \(1\) to <b>Republican</b> and \(0\) to
<b>Democrat</b>. As we can see from the legend, \(1\) corresponds to a <b>light
blue</b> color on the map and \(0\) corresponds to a <b>dark blue</b> color on
the map.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-7" class="outline-3">
<h3 id="sec-1-7"><span class="section-number-3">1.7</span> Problem 2.5 - Coloring the States by Predictions (1 point possible)</h3>
<div class="outline-text-3" id="text-1-7">
<p>
We see that the legend displays a <b>blue</b> gradient for outcomes between
\(0\) and \(1\). However, when plotting the binary predictions there are
only two possible outcomes: \(0\) or \(1\). Let's replot the map with
discrete outcomes. We can also change the color scheme to <b>blue</b> and
<b>red</b>, to match the <b>blue</b> color associated with the <b>Democratic
Party</b> in the US and the <b>red</b> color associated with the <b>Republican
Party</b> in the US. This can be done with the following command:
</p>


<div id="fig:USElectionsPredictions02" class="figure">
<p><img src="../graphs/USElectionsPredictions02.png" alt="USElectionsPredictions02.png" />
</p>
<p><span class="figure-number">Figure 4:</span> US presidential election map v2</p>
</div>


<p>
Alternatively, we could plot the probabilities instead of the binary
predictions. Change the <code>plot</code> command above to instead color the
states by the variable <code>TestPrediction</code>. You should see a gradient of
colors ranging from <b>red</b> to <b>blue</b>. Do the colors of the states in
the map for <code>TestPrediction</code> look different from the colors of the
states in the map with <code>TestPredictionBinary</code>? Why or why not?
</p>

<p>
NOTE: If you have a hard time seeing the red/blue gradient, feel free
to change the color scheme, by changing the arguments ~low = "blue"~ and
~high = "red"~ to colors of your choice (to see all of the color options
in R, type colors() in your R console). You can even change it to a
gray scale, by changing the low and high colors to <code>gray</code> and
<code>black</code>.
</p>


<div id="fig:USElectionsPredictions03" class="figure">
<p><img src="../graphs/USElectionsPredictions03.png" alt="USElectionsPredictions03.png" />
</p>
<p><span class="figure-number">Figure 5:</span> US Presidential Election map v3</p>
</div>
</div>

<div id="outline-container-sec-1-7-1" class="outline-4">
<h4 id="sec-1-7-1"><span class="section-number-4">1.7.1</span> Answer</h4>
<div class="outline-text-4" id="text-1-7-1">
<ul class="org-ul">
<li><code>[X]</code> The two maps look very similar. This is because most of our
predicted probabilities are close to 0 or close to 1. The two maps
look very similar. This is because most of our predicted
probabilities are close to 0 or close to 1. - correct
</li>

<li><code>[&#xa0;]</code> The two maps look very similar. This is because <code>TestPrediction</code>
  and TestPredictionBinary have the exact same values.
</li>

<li><code>[&#xa0;]</code> The two maps look very different. This is because we have
switched from plotting discrete values to plotting continuous
values.
</li>

<li><code>[&#xa0;]</code> The two maps look very different. This is because our predicted
probabilites have a wide range of values, and we were not sure about
many states.
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
This plot can be generated by using the command:
</p>

<p>
<code>ggplot(predictionMap, aes(x = long, y = lat, group = group, fill =</code>
<code>TestPrediction)) + geom_polygon(color = "black") +</code>
<code>scale_fill_gradient(low = "blue", high = "red", name = "Prediction</code>
<code>2012")</code>
</p>

<p>
The only state that appears <b>purple</b> (the color between <b>red</b> and
<b>blue</b>) is the state of Iowa, so the maps look very similar. If you
take a look at <code>TestPrediction</code>, you can see that most of our
predicted probabilities are very close to \(0\) or very close to \(1\). In
fact, we don't have a single predicted probability between \(0.065\) and
\(0.93\).
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-8" class="outline-3">
<h3 id="sec-1-8"><span class="section-number-3">1.8</span> Problem 3.1 - Understanding the Predictions (1 point possible)</h3>
<div class="outline-text-3" id="text-1-8">
<p>
In the 2012 election, the state of <b>Florida</b> ended up being a very close
race. It was ultimately won by the <b>Democratic</b> party. Did we predict
this state correctly or incorrectly? To see the names and locations of
the different states, take a look at the World Atlas map here.
</p>
</div>

<div id="outline-container-sec-1-8-1" class="outline-4">
<h4 id="sec-1-8-1"><span class="section-number-4">1.8.1</span> Answer</h4>
<div class="outline-text-4" id="text-1-8-1">
<ul class="org-ul">
<li><code>[&#xa0;]</code> We correctly predicted that this state would be won by the
Democratic party.
</li>

<li><code>[X]</code> We incorrectly predicted this state by predicting that it would
be won by the Republican party.
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
In our prediction map, the state of Florida is colored <b>red</b>, meaning
that we predicted Republican. So <b>we incorrectly predicted this
state</b>.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-9" class="outline-3">
<h3 id="sec-1-9"><span class="section-number-3">1.9</span> Problem 3.2 - Understanding the Predictions (2 points possible)</h3>
<div class="outline-text-3" id="text-1-9">
</div><div id="outline-container-sec-1-9-1" class="outline-4">
<h4 id="sec-1-9-1"><span class="section-number-4">1.9.1</span> Question a</h4>
<div class="outline-text-4" id="text-1-9-1">
<p>
What was our predicted probability for the state of Florida?
</p>
</div>

<div id="outline-container-sec-1-9-1-1" class="outline-5">
<h5 id="sec-1-9-1-1"><span class="section-number-5">1.9.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-1-9-1-1">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: The predicted probability for Florida:"</span>)
head(predictionMap[predictionMap$region == <span style="color: #ff6a6a;">"florida"</span>, ], 1)
</pre>
</div>

<pre class="example">
 quartz_off_screen
                2
 quartz_off_screen
                2
 quartz_off_screen
                2

 :: The predicted probability for Florida:
      region      long      lat group order subregion TestPrediction
1150 florida -85.01548 30.99702     9  1462      &lt;NA&gt;      0.9640395
     TestPredictionBinary Test.State
1150                    1    Florida
</pre>

<p>
Predicted probability: \(0.9640395\)
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-9-2" class="outline-4">
<h4 id="sec-1-9-2"><span class="section-number-4">1.9.2</span> Question b</h4>
<div class="outline-text-4" id="text-1-9-2">
<p>
What does this imply?
</p>
</div>

<div id="outline-container-sec-1-9-2-1" class="outline-5">
<h5 id="sec-1-9-2-1"><span class="section-number-5">1.9.2.1</span> Answer</h5>
<div class="outline-text-5" id="text-1-9-2-1">
<ul class="org-ul">
<li><code>[&#xa0;]</code> Our prediction model did a good job of correctly predicting the
state of Florida, and we were very confident in our prediction.
</li>

<li><code>[&#xa0;]</code> Our prediction model did a good job of correctly predicting the
state of Florida, but we were not very confident in the prediction.
</li>

<li><code>[&#xa0;]</code> Our prediction model did not do a very good job of correctly
predicting the state of Florida, but we were not very confident in
our prediction.
</li>

<li><code>[X]</code> Our prediction model did not do a very good job of correctly
predicting the state of Florida, and we were very confident in our
incorrect prediction.
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
We predicted Republican for the state of Florida with high
probability, meaning that we were very confident in our incorrect
prediction! Historically, Florida is usually a close race, but our
model doesn't know this. The model only uses polling results for the
particular year. For Florida in 2012, Survey USA predicted a tie, but
other polls predicted Republican, so our model predicted Republican.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-10" class="outline-3">
<h3 id="sec-1-10"><span class="section-number-3">1.10</span> Problem 4 - Parameter Settings</h3>
<div class="outline-text-3" id="text-1-10">
<p>
In this part, we'll explore what the different parameter settings of
<code>geom_polygon</code> do. Throughout the problem, use the help page for
<code>geom_polygon</code>, which can be accessed by ?geom_polygon. To see more
information about a certain parameter, just type a question mark and
then the parameter name to get the help page for that
parameter. Experiment with different parameter settings to try and
replicate the plots!
</p>

<p>
We'll be asking questions about the following three plots:
</p>

<p>
<b>Plot (1)</b>
</p>


<div class="figure">
<p><img src="../graphs/ElectionForecastingMap1.png" alt="ElectionForecastingMap1.png" />
</p>
</div>

<p>
<b>Plot (2)</b>
</p>


<div class="figure">
<p><img src="../graphs/ElectionForecastingMap2.png" alt="ElectionForecastingMap2.png" />
</p>
</div>

<p>
<b>Plot (3)</b>
</p>


<div class="figure">
<p><img src="../graphs/ElectionForecastingMap3.png" alt="ElectionForecastingMap3.png" />
</p>
</div>
</div>

<div id="outline-container-sec-1-10-1" class="outline-4">
<h4 id="sec-1-10-1"><span class="section-number-4">1.10.1</span> Answer</h4>
<div class="outline-text-4" id="text-1-10-1">
<p>
Recreating <b>plot (1)</b>
</p>


<div id="fig:RecreatingPlot01" class="figure">
<p><img src="../graphs/RecreatingPlot01.png" alt="RecreatingPlot01.png" />
</p>
<p><span class="figure-number">Figure 9:</span> Recreating plot 1</p>
</div>

<p>
Now we will recreate the <b>Plot (2)</b>
</p>


<div id="fig:RecreatingPlot02" class="figure">
<p><img src="../graphs/RecreatingPlot02.png" alt="RecreatingPlot02.png" />
</p>
<p><span class="figure-number">Figure 10:</span> Recreating the plot 2</p>
</div>

<p>
Now let recreate the <b>plot (3)</b>
</p>


<div id="fig:RecreatingPlot03" class="figure">
<p><img src="../graphs/RecreatingPlot03.png" alt="RecreatingPlot03.png" />
</p>
<p><span class="figure-number">Figure 11:</span> Recreating the plot 3</p>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-1-11" class="outline-3">
<h3 id="sec-1-11"><span class="section-number-3">1.11</span> Problem 4.1 - Parameter Settings (2/2 points)</h3>
<div class="outline-text-3" id="text-1-11">
<p>
Plots (1) and (2) were created by setting different parameters of
geom_polygon to the value 3.
</p>
</div>

<div id="outline-container-sec-1-11-1" class="outline-4">
<h4 id="sec-1-11-1"><span class="section-number-4">1.11.1</span> Question</h4>
<div class="outline-text-4" id="text-1-11-1">
<p>
What is the name of the parameter we set to have value 3 to create
plot (1)?
</p>
</div>

<div id="outline-container-sec-1-11-1-1" class="outline-5">
<h5 id="sec-1-11-1-1"><span class="section-number-5">1.11.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-1-11-1-1">
<p>
<code>linetype</code>
</p>
</div>
</div>
</div>

<div id="outline-container-sec-1-11-2" class="outline-4">
<h4 id="sec-1-11-2"><span class="section-number-4">1.11.2</span> Question</h4>
<div class="outline-text-4" id="text-1-11-2">
<p>
What is the name of the parameter we set to have value 3 to create
plot (2)?
</p>
</div>

<div id="outline-container-sec-1-11-2-1" class="outline-5">
<h5 id="sec-1-11-2-1"><span class="section-number-5">1.11.2.1</span> Answer</h5>
<div class="outline-text-5" id="text-1-11-2-1">
<p>
<code>size</code>
</p>

<p>
<b>Explanation</b>
</p>

<p>
The first plot can be generated by setting the parameter <code>linetype=3</code>:
</p>

<p>
<code>ggplot(predictionMap, aes(x = long, y = lat, group = group, fill =</code>
<code>TestPrediction))+</code>
<code>geom_polygon(color = "black", linetype=3) +</code>
<code>scale_fill_gradient(low = "blue", high = "red", guide</code>
<code>= "legend", breaks = c(0,1), labels = c("Democrat", "Republican") , name</code>
<code>= "Prediction 2012")</code>
</p>

<p>
The second plot can be generated by setting the parameter <code>size = 3</code>:
</p>

<p>
<code>ggplot(predictionMap, aes(x = long, y = lat, group = group, fill =</code>
<code>TestPrediction))+ geom_polygon(color = "black", size=3) +</code>
<code>scale_fill_gradient(low = "blue", high = "red", guide</code>
<code>= "legend", breaks= c(0,1), labels = c("Democrat", "Republican"),name</code>
<code>= "Prediction 2012")</code>
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-1-12" class="outline-3">
<h3 id="sec-1-12"><span class="section-number-3">1.12</span> Problem 4.2 - Parameter Settings (1 point possible)</h3>
<div class="outline-text-3" id="text-1-12">
</div><div id="outline-container-sec-1-12-1" class="outline-4">
<h4 id="sec-1-12-1"><span class="section-number-4">1.12.1</span> Question</h4>
<div class="outline-text-4" id="text-1-12-1">
<p>
Plot (3) was created by changing the value of a different geom_polygon
parameter to have value 0.3. Which parameter did we use?
</p>
</div>

<div id="outline-container-sec-1-12-1-1" class="outline-5">
<h5 id="sec-1-12-1-1"><span class="section-number-5">1.12.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-1-12-1-1">
<p>
<b>alpha</b>
</p>

<p>
<b>Explanation</b>
</p>

<p>
Plot (3) can be created by changing the alpha parameter:
</p>

<p>
<code>ggplot(predictionMap, aes(x = long, y = lat, group = group, fill =</code>
<code>TestPrediction))+ geom_polygon(color = "black", alpha=0.3) +</code>
<code>scale_fill_gradient(low = "blue", high = "red", guide</code>
<code>= "legend", breaks= c(0,1), labels = c("Democrat", "Republican"),name</code>
<code>= "Prediction 2012")</code>
</p>

<p>
The <code>alpha</code> parameter controls the transparency or darkness of the
color. A smaller value of alpha will make the colors lighter.
</p>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Visualizing Network Data</h2>
<div class="outline-text-2" id="text-2">
<p>
The cliche goes that the world is an increasingly interconnected
place, and the connections between different entities are often best
represented with a graph. Graphs are comprised of vertices (also often
called "nodes") and edges connecting those nodes. In this assignment,
we will learn how to visualize networks using the <code>igraph</code> package in
R.
</p>

<p>
For this assignment, we will visualize social networking data using
anonymized data from Facebook; this data was originally curated in a
<a href="http://i.stanford.edu/~julian/pdfs/nips2012.pdf">recent paper</a> about computing social circles in social networks. In our
visualizations, the vertices in our network will represent Facebook
users and the edges will represent these users being Facebook friends
with each other.
</p>

<p>
The first file we will use, <a href="https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/edges.csv">edges.csv</a>, contains variables <code>V1</code> and <code>V2</code>,
which label the endpoints of edges in our network. Each row represents
a pair of users in our graph who are Facebook friends. For a pair of
friends A and B, <code>edges.csv</code> will only contain a single row &#x2013; the
smaller identifier will be listed first in this row. From this row, we
will know that A is friends with B and B is friends with A.
</p>

<p>
The second file, <a href="https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/users.csv">users.csv</a>, contains information about the Facebook
users, who are the vertexes in our network. This file contains the
following variables:
</p>

<ul class="org-ul">
<li><b>id</b>: A unique identifier for this user; this is the value that
appears in the rows of <code>edges.csv</code>
</li>

<li><b>gender</b>: An identifier for the gender of a user taking the values A
and B. Because the data is anonymized, we don't know which value
refers to males and which value refers to females.
</li>

<li><b>school</b>: An identifier for the school the user attended taking the
values A and AB (users with AB attended school A as well as another
school B). Because the data is anonymized, we don't know the schools
represented by A and B.
</li>

<li><b>locale</b>: An identifier for the locale of the user taking the values
A and B. Because the data is anonymized, we don't know which value
refers to what locale.
</li>
</ul>

<div class="org-src-container">

<pre class="src src-R"><span style="color: #db7093;">library</span>(parallel)

<span style="color: #4682b4;">if</span>(!file.exists(<span style="color: #ff6a6a;">"../data"</span>)) {
        dir.create(<span style="color: #ff6a6a;">"../data"</span>)
}

fileUrl <span style="color: #db7093;">&lt;-</span>
        c(<span style="color: #ff6a6a;">"https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/edges.csv"</span>,
        <span style="color: #ff6a6a;">"https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/users.csv"</span>)

fileName <span style="color: #db7093;">&lt;-</span> c(<span style="color: #ff6a6a;">"edges.csv"</span>, <span style="color: #ff6a6a;">"users.csv"</span>)
dataPath <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"../data"</span>

<span style="color: #4682b4;">for</span>(i <span style="color: #4682b4;">in</span> 1:2) {
        filePath <span style="color: #db7093;">&lt;-</span> paste(dataPath, fileName[i], sep = <span style="color: #ff6a6a;">"/"</span>)

        <span style="color: #4682b4;">if</span>(!file.exists(filePath)) {
                download.file(fileUrl[i], destfile = filePath, method = <span style="color: #ff6a6a;">"curl"</span>)
        }
}
writeLines(<span style="color: #ff6a6a;">"\n :: Files downloaded..."</span>)
</pre>
</div>

<pre class="example">
quartz_off_screen
               2
quartz_off_screen
               2
quartz_off_screen
               2

:: Files downloaded...
</pre>
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Problem 1.1 - Summarizing the Data (2 points possible)</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Load the data from <code>edges.csv</code> into a data frame called <code>edges</code>, and load
the data from <code>users.csv</code> into a data frame called <code>users</code>.
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Loading the data sets in dataframes..."</span>)
edges <span style="color: #db7093;">&lt;-</span> read.csv(<span style="color: #ff6a6a;">"../data/edges.csv"</span>, na.strings = <span style="color: #ff6a6a;">""</span>)
users <span style="color: #db7093;">&lt;-</span> read.csv(<span style="color: #ff6a6a;">"../data/users.csv"</span>, na.strings = <span style="color: #ff6a6a;">""</span>)

writeLines(<span style="color: #ff6a6a;">"\n :: Revising the edges dataframe structure:"</span>)
str(edges)

writeLines(<span style="color: #ff6a6a;">"\n :: Revising the users dataframe structure:"</span>)
str(users)
</pre>
</div>

<pre class="example">
 :: Loading the data sets in dataframes...

 :: Revising the edges dataframe structure:
'data.frame':	146 obs. of  2 variables:
 $ V1: int  4019 4023 4023 4027 3988 3982 3994 3998 3993 3982 ...
 $ V2: int  4026 4031 4030 4032 4021 3986 3998 3999 3995 4021 ...

 :: Revising the users dataframe structure:
'data.frame':	59 obs. of  4 variables:
 $ id    : int  3981 3982 3983 3984 3985 3986 3987 3988 3989 3990 ...
 $ gender: Factor w/ 2 levels "A","B": 1 2 2 2 2 2 1 2 2 1 ...
 $ school: Factor w/ 2 levels "A","AB": 1 NA NA NA NA 1 NA NA 1 NA ...
 $ locale: Factor w/ 2 levels "A","B": 2 2 2 2 2 2 1 2 2 1 ...
</pre>
</div>

<div id="outline-container-sec-2-1-1" class="outline-4">
<h4 id="sec-2-1-1"><span class="section-number-4">2.1.1</span> Question a</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
How many Facebook users are there in our dataset?
</p>
</div>

<div id="outline-container-sec-2-1-1-1" class="outline-5">
<h5 id="sec-2-1-1-1"><span class="section-number-5">2.1.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-2-1-1-1">
<p>
<b>59</b>
</p>

<p>
<b>Explanation</b>
</p>

<p>
From <code>str(users)</code> or <code>nrow(users)</code>, we see that there are 59 Facebook
users in this dataset.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-2-1-2" class="outline-4">
<h4 id="sec-2-1-2"><span class="section-number-4">2.1.2</span> Question b</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
In our dataset, what is the average number of friends per user? Hint:
this question is tricky, and it might help to start by thinking about
a small example with two users who are friends.
</p>
</div>

<div id="outline-container-sec-2-1-2-1" class="outline-5">
<h5 id="sec-2-1-2-1"><span class="section-number-5">2.1.2.1</span> Answer</h5>
<div class="outline-text-5" id="text-2-1-2-1">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Number of frienship relationships:"</span>)
nrow(edges)

writeLines(<span style="color: #ff6a6a;">"\n :: Number of users:"</span>)
nrow(users)

writeLines(<span style="color: #ff6a6a;">"\n :: Average number of friends per user:"</span>)
(2 * nrow(edges)) / nrow(users)
</pre>
</div>

<pre class="example">
 :: Number of frienship relationships:
[1] 146

 :: Number of users:
[1] 59

 :: Average number of friends per user:
[1] 4.949153
</pre>

<p>
<b>Explanation</b>
</p>

<p>
From <code>str(edges)</code> or <code>nrow(edges)</code>, we see that there are $146 pairs
of users in our dataset who are Facebook friends. However, each pair
\((A, B)\) must be counted twice, because \(B\) is a friend of \(A\) and \(A\)
is a friend of \(B\). To think of this in simpler terms, consider a
network with just new people, \(A\) and \(B\), and a single edge \((A,
B)\). Even though there are two vertexes and one edge, each user has on
average one friend.
</p>

<p>
For our network, the average number of friends per user is
</p>

<p>
$$
\frac{292}{59} = 4.95
$$
</p>

<p>
Finally, note that in all likelihood these users have a much higher
number of Facebook friends. We are computing here the average number
of people in this dataset who are their friends, instead of the
average total number of Facebook friends.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2"><span class="section-number-3">2.2</span> Problem 1.2 - Summarizing the Data (1 point possible)</h3>
<div class="outline-text-3" id="text-2-2">
</div><div id="outline-container-sec-2-2-1" class="outline-4">
<h4 id="sec-2-2-1"><span class="section-number-4">2.2.1</span> Question</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
Out of all the students who listed a school, what was the most common
locale?
</p>
</div>

<div id="outline-container-sec-2-2-1-1" class="outline-5">
<h5 id="sec-2-2-1-1"><span class="section-number-5">2.2.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-2-2-1-1">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: the most common locale for students who listed a school:"</span>)
subset(users, users$school == <span style="color: #ff6a6a;">"A"</span> | users$school == <span style="color: #ff6a6a;">"AB"</span>)

writeLines(<span style="color: #ff6a6a;">"\n :: Other way to answer:"</span>)
table(users$locale, users$school)
</pre>
</div>

<pre class="example">
 :: the most common locale for students who listed a school:
     id gender school locale
1  3981      A      A      B
6  3986      B      A      B
9  3989      B      A      B
11 3991      B      A      B
12 3992      A      A      B
16  594      B      A      B
20 3999      B     AB      B
23 4002      B      A      B
26 4005      B      A      B
31 4010      B      A      B
39 4018      A      A      B
40 4019      B      A      B
41 4020   &lt;NA&gt;      A      B
42 4021      B      A      B
44 4023      B      A      B
49 4028      B      A      B
52 4031      B      A      B
55 4034      B      A      B
57 4036      A     AB      B

 :: Other way to answer:

     A AB
  A  0  0
  B 17  2
</pre>

<ul class="org-ul">
<li><code>[&#xa0;]</code> Locale A
</li>
<li><code>[X]</code> Locale B
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
From <code>table(users$locale, users$school)</code>, we read that all students
listed at schools \(A\) and \(B\) listed their locale as \(B\).
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3"><span class="section-number-3">2.3</span> Problem 1.3 - Summarizing the Data (1 point possible)</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Is it possible that either school A or B is an all-girls or all-boys
school?
</p>
</div>

<div id="outline-container-sec-2-3-1" class="outline-4">
<h4 id="sec-2-3-1"><span class="section-number-4">2.3.1</span> Answer</h4>
<div class="outline-text-4" id="text-2-3-1">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Exploratory analysis of the data frame:"</span>)
head(users, 20)

writeLines(<span style="color: #ff6a6a;">"\n :: Are all students of the same gender in some school?"</span>)
table(users$school, users$gender)
</pre>
</div>

<pre class="example">
 :: Exploratory analysis of the data frame:
     id gender school locale
1  3981      A      A      B
2  3982      B   &lt;NA&gt;      B
3  3983      B   &lt;NA&gt;      B
4  3984      B   &lt;NA&gt;      B
5  3985      B   &lt;NA&gt;      B
6  3986      B      A      B
7  3987      A   &lt;NA&gt;      A
8  3988      B   &lt;NA&gt;      B
9  3989      B      A      B
10 3990      A   &lt;NA&gt;      A
11 3991      B      A      B
12 3992      A      A      B
13 3993      B   &lt;NA&gt;   &lt;NA&gt;
14 3994      A   &lt;NA&gt;      B
15 3995      B   &lt;NA&gt;      B
16  594      B      A      B
17 3996      B   &lt;NA&gt;      B
18 3997      B   &lt;NA&gt;      B
19 3998      B   &lt;NA&gt;      B
20 3999      B     AB      B

 :: Are all students of the same gender in some school?

      A  B
  A   3 13
  AB  1  1
</pre>

<ul class="org-ul">
<li><code>[X]</code> No No - correct
</li>
<li><code>[&#xa0;]</code> Yes
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
We see from <code>table(users$gender, users$school)</code> that both genders \(A\)
and \(B\) have attended schools \(A\) and \(B\).
</p>
</div>
</div>
</div>

<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4"><span class="section-number-3">2.4</span> Problem 2.1 - Creating a Network (1 point possible)</h3>
<div class="outline-text-3" id="text-2-4">
<p>
We will be using the <code>igraph</code> package to visualize networks; install
and load this package using the <code>install.packages</code> and <code>library</code>
commands.
</p>

<p>
We can create a new graph object using the <code>graph.data.frame()</code>
function. Based on <code>?graph.data.frame</code>, which of the following
commands will create a graph <code>g</code> describing our social network, with
the attributes of each user correctly loaded?
</p>

<p>
Note: A directed graph is one where the edges only go one way &#x2013; they
point from one vertex to another. The other option is an undirected
graph, which means that the relations between the vertexes are
symmetric.
</p>
</div>

<div id="outline-container-sec-2-4-1" class="outline-4">
<h4 id="sec-2-4-1"><span class="section-number-4">2.4.1</span> Answer</h4>
<div class="outline-text-4" id="text-2-4-1">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Install new package: igraph ..."</span>)
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">install.packages('igraph', repos='http://cran.rstudio.com/')</span>
writeLines(<span style="color: #ff6a6a;">"\n :: NOTE: Please comment after install once..."</span>)

<span style="color: #db7093;">library</span>(igraph)
writeLines(<span style="color: #ff6a6a;">"\n :: Library igraph loaded..."</span>)
</pre>
</div>

<pre class="example">
:: Install new package: igraph ...

:: NOTE: Please comment after install once...

:: Library igraph loaded...
</pre>

<ul class="org-ul">
<li><code>[&#xa0;]</code> <code>g = graph.data.frame(edges, FALSE, users)</code>
</li>
<li><code>[&#xa0;]</code> <code>g = graph.data.frame(users, FALSE, edges)</code>
</li>
<li><code>[&#xa0;]</code> <code>g = graph.data.frame(edges, TRUE, users)</code>
</li>
<li><code>[&#xa0;]</code> <code>g = graph.data.frame(users, TRUE, edges)</code>
</li>
</ul>

<div class="org-src-container">

<pre class="src src-R">g <span style="color: #db7093;">&lt;-</span> graph.data.frame(edges, <span style="color: #3cb371;">FALSE</span>, users)
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">g2 &lt;- graph.data.frame(users, FALSE, edges)</span>
g3 <span style="color: #db7093;">&lt;-</span> graph.data.frame(edges, <span style="color: #3cb371;">TRUE</span>, users)
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">g4 &lt;- graph.data.frame(users, TRUE, edges)</span>

writeLines(<span style="color: #ff6a6a;">"\n :: Our undirected graph g:"</span>)
g
</pre>
</div>

<pre class="example">
 :: Our undirected graph g:
 attr: name (v/c), gender (v/c), school (v/c), locale (v/c)
+ edges (vertex names):
 [1] 4019--4026 4023--4031 4023--4030 4027--4032 3988--4021 3982--3986
 [7] 3994--3998 3998--3999 3993--3995 3982--4021 3982--4037 3997--4019
[13] 3994--4019 3992--4017 3981--3998 3997--4018 4009--4030 3994--4018
[19] 3995--4000 4000--4026 4027--4038 4031--4038 4000--4021 3986--4030
[25] 3985--4014 3994--4030 3998--4021 3994--4009 3982--4023 3998--4019
[31] 4020--4031 4009--4023 3994--3997 3981--4023 3997--4030 3997--4021
[37] 4023--4034 3993--4004 3994--3996 4000--4030 3998--4014 4004--4013
[43] 4016--4025 3990--4016 3999--4005 4004--4023 4002--4020 3998--4018
+ ... omitted several edges
</pre>

<p>
<b>Explanation</b>
</p>

<p>
From <code>?graph.data.frame</code>, we can see that the function expects the
first two columns of parameter d to specify the edges in the graph &#x2013;
our edges object fits this description.
</p>

<p>
Our edges are undirected &#x2013; if \(A\) is a Facebook friend of \(B\) then
\(B\) is a Facebook friend of \(A\). Therefore, we set the directed
parameter to <code>FALSE</code>.
</p>

<p>
The vertices parameter expects a data frame where the first column is
a vertex id and the remaining columns are properties of vertices in
our graph. This is the case with our users data frame.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-2-5" class="outline-3">
<h3 id="sec-2-5"><span class="section-number-3">2.5</span> Problem 2.2 - Creating a Network (2 points possible)</h3>
<div class="outline-text-3" id="text-2-5">
<p>
Use the correct command from Problem 2.1 to load the graph <code>g</code>.
</p>

<p>
Now, we want to plot our graph. By default, the vertices are large and
have text labels of a user's identifier. Because this would clutter
the output, we will plot with no text labels and smaller vertices:
</p>


<div id="fig:FBFriendshipGraph01" class="figure">
<p><img src="../graphs/FBFriendshipGraph01.png" alt="FBFriendshipGraph01.png" />
</p>
<p><span class="figure-number">Figure 12:</span> Facebook friendship graph v1</p>
</div>

<p>
In this graph, there are a number of groups of nodes where all the
nodes in each group are connected but the groups are disjoint from one
another, forming <b>islands</b> in the graph. Such groups are called
<code>connected components</code>, or <code>components</code> for short.
</p>
</div>

<div id="outline-container-sec-2-5-1" class="outline-4">
<h4 id="sec-2-5-1"><span class="section-number-4">2.5.1</span> Question a</h4>
<div class="outline-text-4" id="text-2-5-1">
<p>
How many connected components with at least 2 nodes are there in the
graph?
</p>
</div>

<div id="outline-container-sec-2-5-1-1" class="outline-5">
<h5 id="sec-2-5-1-1"><span class="section-number-5">2.5.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-2-5-1-1">
<p>
4
</p>

<p>
<b>Explanation</b>
</p>

<p>
In addition to the large connected component, there is a 4-node
component and two 2-node components.
</p>
</div>
</div>
</div>


<div id="outline-container-sec-2-5-2" class="outline-4">
<h4 id="sec-2-5-2"><span class="section-number-4">2.5.2</span> Question b</h4>
<div class="outline-text-4" id="text-2-5-2">
<p>
How many users are there with no friends in the network?
</p>
</div>

<div id="outline-container-sec-2-5-2-1" class="outline-5">
<h5 id="sec-2-5-2-1"><span class="section-number-5">2.5.2.1</span> Answer</h5>
<div class="outline-text-5" id="text-2-5-2-1">
<p>
7
</p>

<p>
<b>Explanation</b>
</p>

<p>
There are 7 nodes that are not connected to any other nodes. Each
forms a 1-node connected component.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2-6" class="outline-3">
<h3 id="sec-2-6"><span class="section-number-3">2.6</span> Problem 2.3 - Creating a Network (1 point possible)</h3>
<div class="outline-text-3" id="text-2-6">
<p>
In our graph, the <b>degree</b> of a node is its number of friends. We have
already seen that some nodes in our graph have degree 0 (these are the
nodes with no friends), while others have much higher degree. We can
use <code>degree(g)</code> to compute the degree of all the nodes in our graph
<code>g</code>.
</p>
</div>

<div id="outline-container-sec-2-6-1" class="outline-4">
<h4 id="sec-2-6-1"><span class="section-number-4">2.6.1</span> Question</h4>
<div class="outline-text-4" id="text-2-6-1">
<p>
How many users are friends with 10 or more other Facebook users in
this network?
</p>
</div>

<div id="outline-container-sec-2-6-1-1" class="outline-5">
<h5 id="sec-2-6-1-1"><span class="section-number-5">2.6.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-2-6-1-1">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Calculating the degree of users in the graph:"</span>)
sort(degree(g), decreasing = <span style="color: #3cb371;">TRUE</span>)

writeLines(<span style="color: #ff6a6a;">"\n :: Other useful way to calculate the degree &gt; 10:"</span>)
table(degree(g) &gt;= 10)
</pre>
</div>

<pre class="example">
 quartz_off_screen
                2

 :: Calculating the degree of users in the graph:
4030 4023 3982 3998 4014 3994 3997 4021 4031 4004 4009 3986 3995 4000 4017 4026
  18   17   13   13   11   10   10   10   10    9    9    8    8    8    8    8
4038 3981 4019 4020 3988 4002 4018 4027 3985 3989 3993 4013 4003 3990  594 3996
   8    7    7    7    6    6    6    6    5    5    5    5    4    3    3    3
3999 4007 4011 4016 4025 4037 3991 3992 4005 4033 3983 3987 4001 4006 4012 4028
   3    3    3    3    3    3    2    2    2    2    1    1    1    1    1    1
4029 4032 4034 4036 3984 4008 4010 4015 4022 4024 4035
   1    1    1    1    0    0    0    0    0    0    0

 :: Other useful way to calculate the degree &gt; 10:

FALSE  TRUE
   50     9
</pre>

<p>
9 users have equal or more to 10 friends.
</p>

<p>
<b>Explanation</b>
</p>

<p>
From <code>table(degree(g))</code> or <code>table(degree(g) &gt;= 10)</code>, we can see that
there are 9 users with 10 or more friends in this network.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2-7" class="outline-3">
<h3 id="sec-2-7"><span class="section-number-3">2.7</span> Problem 2.4 - Creating a Network (2 points possible)</h3>
<div class="outline-text-3" id="text-2-7">
<p>
In a network, it's often visually useful to draw attention to
<b>important</b> nodes in the network. While this might mean different
things in different contexts, in a social network we might consider a
user with a large number of friends to be an <b>important user</b>. From the
previous problem, we know this is the same as saying that nodes with a
high degree are important users.
</p>

<p>
To visually draw attention to these nodes, we will change the size of
the vertices so the vertices with high degrees are larger. To do this,
we will change the "size" attribute of the vertices of our graph to be
an increasing function of their degrees:
</p>

<p>
<code>V(g)$size = degree(g)/ 2 + 2</code>
</p>

<p>
Now that we have specified the vertex size of each vertex, we will no
longer use the <code>vertex.size</code> parameter when we plot our graph:
</p>


<div id="fig:FBFriendshipGraph02" class="figure">
<p><img src="../graphs/FBFriendshipGraph02.png" alt="FBFriendshipGraph02.png" />
</p>
<p><span class="figure-number">Figure 13:</span> Facebook friendship graph v2</p>
</div>
</div>

<div id="outline-container-sec-2-7-1" class="outline-4">
<h4 id="sec-2-7-1"><span class="section-number-4">2.7.1</span> Question a</h4>
<div class="outline-text-4" id="text-2-7-1">
<p>
What is the largest size we assigned to any node in our graph?
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: The largest size assigned to a node:"</span>)
sort(V(g)$size, decreasing = <span style="color: #3cb371;">TRUE</span>)
</pre>
</div>

<pre class="example">
 quartz_off_screen
                2

 :: The largest size assigned to a node:
 [1] 11.0 10.5  8.5  8.5  7.5  7.0  7.0  7.0  7.0  6.5  6.5  6.0  6.0  6.0  6.0
[16]  6.0  6.0  5.5  5.5  5.5  5.0  5.0  5.0  5.0  4.5  4.5  4.5  4.5  4.0  3.5
[31]  3.5  3.5  3.5  3.5  3.5  3.5  3.5  3.5  3.0  3.0  3.0  3.0  2.5  2.5  2.5
[46]  2.5  2.5  2.5  2.5  2.5  2.5  2.5  2.0  2.0  2.0  2.0  2.0  2.0  2.0
</pre>

<p>
<b>11 is the largest size assigned to a node.</b>
</p>
</div>
</div>

<div id="outline-container-sec-2-7-2" class="outline-4">
<h4 id="sec-2-7-2"><span class="section-number-4">2.7.2</span> Question b</h4>
<div class="outline-text-4" id="text-2-7-2">
<p>
What is the smallest size we assigned to any node in our graph?
</p>
</div>

<div id="outline-container-sec-2-7-2-1" class="outline-5">
<h5 id="sec-2-7-2-1"><span class="section-number-5">2.7.2.1</span> Answer</h5>
<div class="outline-text-5" id="text-2-7-2-1">
<p>
<b>2 is the smallest size assigned to a node.</b>
</p>

<p>
<b>Explanation</b>
</p>

<p>
From <code>table(degree(g))</code> or <code>summary(degree(g))</code>, we see that the maximum
degree of any node in the graph is \(18\) and the minimum degree of any
node is \(0\). Therefore, the maximum size of any point is <code>18/2+2=11</code>, and
the minimum size is <code>0/2+2=2</code>.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2-8" class="outline-3">
<h3 id="sec-2-8"><span class="section-number-3">2.8</span> Problem 3.1 - Coloring Vertices (1 point possible)</h3>
<div class="outline-text-3" id="text-2-8">
<p>
Thus far, we have changed the <b>size</b> attributes of our
vertices. However, we can also change the colors of vertices to
capture additional information about the Facebook users we are
depicting.
</p>

<p>
When changing the size of nodes, we first obtained the vertices of our
graph with <code>V(g)</code> and then accessed the the size attribute with
<code>V(g)$size</code>. To change the color, we will update the attribute
<code>V(g)$color</code>.
</p>

<p>
To color the vertices based on the gender of the user, we will need
access to that variable. When we created our graph <code>g</code>, we provided it
with the data frame users, which had variables <code>gender</code>, <code>school</code>, and
<code>locale</code>. These are now stored as attributes <code>V(g)$gender</code>, <code>V(g)$school</code>,
and <code>V(g)$locale</code>.
</p>

<p>
We can update the colors by setting the color to black for all
vertices, than setting it to red for the vertices with gender A and
setting it to gray for the vertices with gender B:
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Assigning black color to the nodes..."</span>)
V(g)$color <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"black"</span>

writeLines(<span style="color: #ff6a6a;">"\n :: Assigning red color to gender A..."</span>)
V(g)$color[V(g)$gender == <span style="color: #ff6a6a;">"A"</span>] <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"red"</span>

writeLines(<span style="color: #ff6a6a;">"\n :: Assigning gray color to gender B..."</span>)
V(g)$color[V(g)$gender == <span style="color: #ff6a6a;">"B"</span>] <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"gray"</span>
</pre>
</div>

<pre class="example">
:: Assigning black color to the nodes...

:: Assigning red color to gender A...

:: Assigning gray color to gender B...
</pre>
</div>

<div id="outline-container-sec-2-8-1" class="outline-4">
<h4 id="sec-2-8-1"><span class="section-number-4">2.8.1</span> Question</h4>
<div class="outline-text-4" id="text-2-8-1">
<p>
Plot the resulting graph. What is the gender of the users with the
highest degree in the graph?
</p>


<div id="fig:FBFriendshipGraph03" class="figure">
<p><img src="../graphs/FBFriendshipGraph03.png" alt="FBFriendshipGraph03.png" />
</p>
<p><span class="figure-number">Figure 14:</span> Facebook friendship graph v3</p>
</div>
</div>

<div id="outline-container-sec-2-8-1-1" class="outline-5">
<h5 id="sec-2-8-1-1"><span class="section-number-5">2.8.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-2-8-1-1">
<ul class="org-ul">
<li><code>[&#xa0;]</code> Missing gender value
</li>
<li><code>[&#xa0;]</code> Gender A
</li>
<li><code>[X]</code> Gender B
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
After updating <code>V(g)$color</code>, run <code>plot(g, vertex.label=NA)</code> to plot
the graph. All the largest nodes (the ones with the highest degree)
are colored <b>gray</b>, which corresponds to Gender <b>B</b>.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2-9" class="outline-3">
<h3 id="sec-2-9"><span class="section-number-3">2.9</span> Problem 3.2 - Coloring Vertices (2 points possible)</h3>
<div class="outline-text-3" id="text-2-9">
<p>
Now, color the vertices based on the school that each user in our
network attended.
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Assigning black color to the nodes..."</span>)
V(g)$color <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"black"</span>

writeLines(<span style="color: #ff6a6a;">"\n :: Assigning blue color to school A..."</span>)
V(g)$color[V(g)$school == <span style="color: #ff6a6a;">"A"</span>] <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"blue"</span>

writeLines(<span style="color: #ff6a6a;">"\n :: Assigning red color to school AB..."</span>)
V(g)$color[V(g)$school == <span style="color: #ff6a6a;">"AB"</span>] <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"red"</span>
</pre>
</div>

<pre class="example">
quartz_off_screen
               2

:: Assigning black color to the nodes...

:: Assigning blue color to school A...

:: Assigning red color to school AB...
</pre>
</div>

<div id="outline-container-sec-2-9-1" class="outline-4">
<h4 id="sec-2-9-1"><span class="section-number-4">2.9.1</span> Question</h4>
<div class="outline-text-4" id="text-2-9-1">

<div id="fig:FBFriendshipGraph04" class="figure">
<p><img src="../graphs/FBFriendshipGraph04.png" alt="FBFriendshipGraph04.png" />
</p>
<p><span class="figure-number">Figure 15:</span> Facebook friendship graph v4</p>
</div>

<p>
Are the two users who attended both schools A and B Facebook friends
with each other?
</p>
</div>

<div id="outline-container-sec-2-9-1-1" class="outline-5">
<h5 id="sec-2-9-1-1"><span class="section-number-5">2.9.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-2-9-1-1">
<ul class="org-ul">
<li><code>[X]</code> Yes Yes - correct
</li>
<li><code>[&#xa0;]</code> No
</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-sec-2-9-2" class="outline-4">
<h4 id="sec-2-9-2"><span class="section-number-4">2.9.2</span> Question</h4>
<div class="outline-text-4" id="text-2-9-2">
<p>
What best describes the users with highest degree?
</p>

<ul class="org-ul">
<li><code>[&#xa0;]</code> None of the high-degree users attended school A
</li>

<li><code>[X]</code> Some, but not all, of the high-degree users attended school A
Some, but not all, of the high-degree users attended school A -
correct
</li>

<li><code>[&#xa0;]</code> All of the high-degree users attended school A
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
As with coloring by gender, we will set the color for all vertices to
black, and then we will set the color for students from school A to
red and the color for students from schools A and B to gray. Finally
we will plot the updated graph:
</p>

<p>
<code>(V(g)$color = "black")</code>
</p>

<p>
<code>(V(g)$color[V(g)$school == "A"] = "red")</code>
</p>

<p>
<code>(V(g)$color[V(g)$school == "AB"] = "gray")</code>
</p>

<p>
<code>plot(g, vertex.label=NA)</code>
</p>

<p>
The two students who attended schools A and B are colored gray; we can
see from the graph that they are Facebook friends (aka they are
connected by an edge). The high-degree users (depicted by the large
nodes) are a mixture of red and black color, meaning some of these
users attended school A and other did not.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-2-10" class="outline-3">
<h3 id="sec-2-10"><span class="section-number-3">2.10</span> Problem 3.3 - Coloring Vertices (2 points possible)</h3>
<div class="outline-text-3" id="text-2-10">
<p>
Now, color the vertices based on the locale of the user.
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Assigning black color to the nodes..."</span>)
V(g)$color <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"black"</span>

writeLines(<span style="color: #ff6a6a;">"\n :: Assigning green color to locale A..."</span>)
V(g)$color[V(g)$locale == <span style="color: #ff6a6a;">"A"</span>] <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"green"</span>

writeLines(<span style="color: #ff6a6a;">"\n :: Assigning red color to locale B..."</span>)
V(g)$color[V(g)$locale == <span style="color: #ff6a6a;">"B"</span>] <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"red"</span>
</pre>
</div>

<pre class="example">
quartz_off_screen
               2

:: Assigning black color to the nodes...

:: Assigning green color to locale A...

:: Assigning red color to locale B...
</pre>


<div id="fig:FBFriendshipGraph05" class="figure">
<p><img src="../graphs/FBFriendshipGraph05.png" alt="FBFriendshipGraph05.png" />
</p>
<p><span class="figure-number">Figure 16:</span> Facebook friendship graph v5</p>
</div>
</div>

<div id="outline-container-sec-2-10-1" class="outline-4">
<h4 id="sec-2-10-1"><span class="section-number-4">2.10.1</span> Question</h4>
<div class="outline-text-4" id="text-2-10-1">
<p>
The large connected component is most associated with which locale?
</p>
</div>

<div id="outline-container-sec-2-10-1-1" class="outline-5">
<h5 id="sec-2-10-1-1"><span class="section-number-5">2.10.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-2-10-1-1">
<ul class="org-ul">
<li><code>[&#xa0;]</code> Locale A
</li>
<li><code>[X]</code> Locale B
</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-sec-2-10-2" class="outline-4">
<h4 id="sec-2-10-2"><span class="section-number-4">2.10.2</span> Question</h4>
<div class="outline-text-4" id="text-2-10-2">
<p>
The 4-user connected component is most associated with which locale?
</p>
</div>

<div id="outline-container-sec-2-10-2-1" class="outline-5">
<h5 id="sec-2-10-2-1"><span class="section-number-5">2.10.2.1</span> Answer</h5>
<div class="outline-text-5" id="text-2-10-2-1">
<ul class="org-ul">
<li><code>[X]</code> Locale A
</li>
<li><code>[&#xa0;]</code> Locale B
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
As with the other coloring tasks, we will set the color for all
vertices to black, and then we will set the color for users from
locale A to red and the color for users from locale B to gray. Finally
we will plot the updated graph:
</p>

<p>
<code>(V(g)$color = "black")</code>
</p>

<p>
<code>(V(g)$color[V(g)$locale == "A"] = "red")</code>
</p>

<p>
<code>(V(g)$color[V(g)$locale == "B"] = "gray")</code>
</p>

<p>
<code>plot(g, vertex.label=NA)</code>
</p>

<p>
Nearly all of the vertices from the large connected component are
colored gray, indicating users from Locale B. Meanwhile, all the
vertices in the 4-user connected component are colored red, indicating
users from Locale A.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2-11" class="outline-3">
<h3 id="sec-2-11"><span class="section-number-3">2.11</span> Problem 4 - Other Plotting Options (2 points possible)</h3>
<div class="outline-text-3" id="text-2-11">
<p>
The help page is a helpful tool when making visualizations. Answer the
following questions with the help of <code>?igraph.plotting</code> and
experimentation in your R console.
</p>
</div>

<div id="outline-container-sec-2-11-1" class="outline-4">
<h4 id="sec-2-11-1"><span class="section-number-4">2.11.1</span> Question</h4>
<div class="outline-text-4" id="text-2-11-1">
<p>
Which <code>igraph</code> plotting function would enable us to plot our graph in
3-D?
</p>
</div>

<div id="outline-container-sec-2-11-1-1" class="outline-5">
<h5 id="sec-2-11-1-1"><span class="section-number-5">2.11.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-2-11-1-1">
<p>
We need to install the <code>rgl</code> package.
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Install new package: rgl ..."</span>)
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">install.packages('rgl', repos='http://cran.rstudio.com/')</span>
writeLines(<span style="color: #ff6a6a;">"\n :: NOTE: Please comment after install once..."</span>)

<span style="color: #db7093;">library</span>(rgl)
writeLines(<span style="color: #ff6a6a;">"\n :: Library rgl loaded..."</span>)
</pre>
</div>

<pre class="example">
quartz_off_screen
               2

:: Install new package: rgl ...

:: NOTE: Please comment after install once...

:: Library rgl loaded...
</pre>

<p>
Now we can use the <code>rglplot</code> function:
</p>


<div id="fig:FBFriendshipGraph06" class="figure">
<p><img src="../graphs/FBFriendSGraphRGLPlot.png" alt="FBFriendSGraphRGLPlot.png" />
</p>
<p><span class="figure-number">Figure 17:</span> Facebook friendship graph v6</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2-11-2" class="outline-4">
<h4 id="sec-2-11-2"><span class="section-number-4">2.11.2</span> Question</h4>
<div class="outline-text-4" id="text-2-11-2">
<p>
What parameter to the <code>plot()</code> function would we use to change the edge
width when plotting <code>g</code>?
</p>
</div>

<div id="outline-container-sec-2-11-2-1" class="outline-5">
<h5 id="sec-2-11-2-1"><span class="section-number-5">2.11.2.1</span> Answer</h5>
<div class="outline-text-5" id="text-2-11-2-1">
<p>
<code>edge.width</code> is the parameter to control the width of the edges.
</p>


<div id="fig:FBFriendshipGraph07" class="figure">
<p><img src="../graphs/FBFriendshipGraph07.png" alt="FBFriendshipGraph07.png" />
</p>
<p><span class="figure-number">Figure 18:</span> Facebook friendship graph v7</p>
</div>

<p>
<b>Explanation</b>
</p>

<p>
The three functions to plot the <code>igraph</code> are <code>plot.igraph</code> (the function
we used through the command <code>plot</code>), <code>tkplot</code>, and <code>rglplot</code>. <code>rglplot</code>
makes 3D plots &#x2013; you can try one with
</p>

<p>
<code>rglplot(g, vertex.label=NA)</code>
</p>

<p>
Once you've made the plot, you can click and drag to rotate the
graph. To use this function, you will need to install and load the
<code>rgl</code> package.
</p>

<p>
To change the edge width, you need to change the edge parameter called
<code>width</code>. From <code>?igraph.plotting</code>, we read that we need to append the
prefix <code>edge</code>. to the beginning for our call to plot, so the full
parameter is called <code>edge.width</code>. For instance, we could plot with
edge width 2 with the command
</p>

<p>
<code>plot(g, edge.width=2, vertex.label=NA)</code>.
</p>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Visualizing Text Data Using Word CLouds</h2>
<div class="outline-text-2" id="text-3">
<p>
Earlier in the course, we used text analytics as a predictive tool,
using word frequencies as independent variables in our
models. However, sometimes our goal is to understand commonly
occurring topics in text data instead of to predict the value of some
dependent variable. In such cases, word clouds can be a visually
appealing way to display the most frequent words in a body of text.
</p>

<p>
A word cloud arranges the most common words in some text, using size
to indicate the frequency of a word. For instance, this is a word
cloud for the complete works of Shakespeare, removing English
<code>stopwords</code>:
</p>


<div class="figure">
<p><img src="../graphs/shakespeare.png" alt="shakespeare.png" />
</p>
</div>

<p>
While we could generate word clouds using free generators available on
the Internet, we will have more flexibility and control over the
process if we do so in R. We will visualize the text of tweets about
Apple, a dataset we used earlier in the course. As a reminder, this
dataset (which can be downloaded from <a href="https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/tweets.csv">tweets.csv</a>) has the following
variables:
</p>

<ul class="org-ul">
<li><b>Tweet</b> &#x2013; the text of the tweet
</li>

<li><b>Avg</b> &#x2013; the sentiment of the tweet, as assigned by users of Amazon
Mechanical Turk. The score ranges on a scale from -2 to 2, where 2
means highly positive sentiment, -2 means highly negative sentiment,
and 0 means neutral sentiment.
</li>
</ul>
</div>

<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> Problem 1.1 - Preparing the Data (1 point possible)</h3>
<div class="outline-text-3" id="text-3-1">
<p>
Download the dataset <code>tweets.csv</code>, and load it into a data frame
called <code>tweets</code> using the <code>read.csv()</code> function, remembering to use
<code>stringsAsFactors = FALSE</code> when loading the data.
</p>

<div class="org-src-container">

<pre class="src src-R"><span style="color: #db7093;">library</span>(parallel)

<span style="color: #4682b4;">if</span>(!file.exists(<span style="color: #ff6a6a;">"../data"</span>)) {
        dir.create(<span style="color: #ff6a6a;">"../data"</span>)
}

fileUrl <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/tweets.csv"</span>
fileName <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"tweetsU7.csv"</span>
dataPath <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"../data"</span>

filePath <span style="color: #db7093;">&lt;-</span> paste(dataPath, fileName, sep = <span style="color: #ff6a6a;">"/"</span>)

<span style="color: #4682b4;">if</span>(!file.exists(filePath)) {
        download.file(fileUrl, destfile = filePath, method = <span style="color: #ff6a6a;">"curl"</span>)
}

writeLines(<span style="color: #ff6a6a;">"\n :: File downloaded..."</span>)
</pre>
</div>

<pre class="example">
quartz_off_screen
               2

:: File downloaded...
</pre>

<p>
Load in a data frame
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Loading the dataset in a dataframe..."</span>)
tweets <span style="color: #db7093;">&lt;-</span> read.csv(<span style="color: #ff6a6a;">"../data/tweetsU7.csv"</span>, stringsAsFactors = <span style="color: #3cb371;">FALSE</span>)
str(tweets)
</pre>
</div>

<pre class="example">
 :: Loading the dataset in a dataframe...
'data.frame':   1181 obs. of  2 variables:
 $ Tweet: chr  "I have to say, Apple has by far the best customer care service I have ever received! @Apple @AppStore" "iOS 7 is so fricking smooth &amp; beautiful!! #ThanxApple @Apple" "LOVE U @APPLE" "Thank you @apple, loving my new iPhone 5S!!!!!  #apple #iphone5S pic.twitter.com/XmHJCU4pcb" ...
 $ Avg  : num  2 2 1.8 1.8 1.8 1.8 1.8 1.6 1.6 1.6 ...
</pre>

<p>
Loading some useful libraries
</p>

<div class="org-src-container">

<pre class="src src-R"><span style="color: #db7093;">library</span>(tm)
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">library(SnowballC)</span>
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">library(caTools)</span>
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">library(rpart)</span>
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">library(rpart.plot)</span>
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">library(randomForest)</span>
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">library(ROCR)</span>
</pre>
</div>

<p>
Next, perform the following pre-processing tasks (like we did in Unit
5), noting that we don't stem the words in the document or remove
sparse terms:
</p>

<ol class="org-ol">
<li>Create a corpus using the Tweet variable
</li>
</ol>

<div class="org-src-container">

<pre class="src src-R">corpus <span style="color: #db7093;">&lt;-</span> Corpus(VectorSource(tweets$Tweet))
corpus[[1]]
</pre>
</div>

<pre class="example">
&lt;&lt;PlainTextDocument&gt;&gt;
Metadata:  7
Content:  chars: 101
</pre>

<ol class="org-ol">
<li>Convert the corpus to lowercase (don't forget to type "corpus =
tm_map(corpus, PlainTextDocument)" in your R console right after
this step)
</li>
</ol>

<div class="org-src-container">

<pre class="src src-R">corpus <span style="color: #db7093;">&lt;-</span> tm_map(corpus, tolower)
corpus <span style="color: #db7093;">&lt;-</span> tm_map(corpus, PlainTextDocument)
</pre>
</div>

<ol class="org-ol">
<li>Remove punctuation from the corpus
</li>
</ol>

<div class="org-src-container">

<pre class="src src-R">corpus <span style="color: #db7093;">&lt;-</span> tm_map(corpus, removePunctuation)
corpus[[1]]
</pre>
</div>

<pre class="example">
&lt;&lt;PlainTextDocument&gt;&gt;
Metadata:  7
Content:  chars: 97
</pre>

<ol class="org-ol">
<li>Remove all English-language stopwords
</li>
</ol>

<div class="org-src-container">

<pre class="src src-R">corpus <span style="color: #db7093;">&lt;-</span> tm_map(corpus, removeWords, stopwords(<span style="color: #ff6a6a;">"english"</span>))
</pre>
</div>

<ol class="org-ol">
<li>Build a document-term matrix out of the corpus
</li>
</ol>

<div class="org-src-container">

<pre class="src src-R">DocTermMatrix <span style="color: #db7093;">&lt;-</span> DocumentTermMatrix(corpus)
</pre>
</div>

<ol class="org-ol">
<li>Convert the document-term matrix to a data frame called allTweets
</li>
</ol>

<div class="org-src-container">

<pre class="src src-R">allTweets <span style="color: #db7093;">&lt;-</span> as.data.frame(as.matrix(DocTermMatrix))
</pre>
</div>
</div>

<div id="outline-container-sec-3-1-1" class="outline-4">
<h4 id="sec-3-1-1"><span class="section-number-4">3.1.1</span> Question</h4>
<div class="outline-text-4" id="text-3-1-1">
<p>
How many unique words are there across all the documents?
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: allTweets dataframe matrix portion:"</span>)
allTweets[1:13, 1:13]

writeLines(<span style="color: #ff6a6a;">"\n :: Unique words across all documents:"</span>)
ncol(allTweets)
</pre>
</div>

<pre class="example">
 :: allTweets dataframe matrix portion:
                000 075 0909 0910 099 100 100m 1085 10min 110 13apple 13th 1415
character(0)      0   0    0    0   0   0    0    0     0   0       0    0    0
character(0).1    0   0    0    0   0   0    0    0     0   0       0    0    0
character(0).2    0   0    0    0   0   0    0    0     0   0       0    0    0
character(0).3    0   0    0    0   0   0    0    0     0   0       0    0    0
character(0).4    0   0    0    0   0   0    0    0     1   0       0    0    0
character(0).5    0   0    0    0   0   0    0    0     0   0       0    0    0
character(0).6    0   0    0    0   0   0    0    0     0   0       0    0    0
character(0).7    0   0    0    0   0   0    0    0     0   0       0    0    0
character(0).8    0   0    0    0   0   0    0    0     0   0       0    0    0
character(0).9    0   0    0    0   0   0    0    0     0   0       0    0    0
character(0).10   0   0    0    0   0   0    0    0     0   0       0    0    0
character(0).11   0   0    0    0   0   0    0    0     0   0       0    0    0
character(0).12   0   0    0    0   0   0    0    0     0   0       0    0    0

 :: Unique words across all documents:
[1] 3780
</pre>
</div>

<div id="outline-container-sec-3-1-1-1" class="outline-5">
<h5 id="sec-3-1-1-1"><span class="section-number-5">3.1.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-3-1-1-1">
<p>
3780
</p>

<p>
<b>Explanation</b>
</p>

<p>
We can complete the pre-processing steps with the following commands:
</p>

<p>
<code>library(tm)</code>
</p>

<p>
<code>tweets = read.csv("tweets.csv", stringsAsFactors=FALSE)</code>
</p>

<p>
<code>corpus = Corpus(VectorSource(tweets$Tweet))</code>
</p>

<p>
<code>corpus = tm_map(corpus, tolower)</code>
</p>

<p>
<code>corpus = tm_map(corpus, PlainTextDocument)</code>
</p>

<p>
<code>corpus = tm_map(corpus, removePunctuation)</code>
</p>

<p>
<code>corpus = tm_map(corpus, removeWords, stopwords("english"))</code>
</p>

<p>
<code>frequencies = DocumentTermMatrix(corpus)</code>
</p>

<p>
<code>allTweets = as.data.frame(as.matrix(frequencies))</code>
</p>

<p>
From the commands <code>frequencies</code>, <code>str(allTweets)</code> or
<code>ncol(allTweets)</code>, we can read that there are \(3780\) unique words across
all the tweets.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> Problem 1.2 - Preparing the Data (1 point possible)</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Although we typically stem words during the text preprocessing step,
we did not do so here.
</p>
</div>

<div id="outline-container-sec-3-2-1" class="outline-4">
<h4 id="sec-3-2-1"><span class="section-number-4">3.2.1</span> Question</h4>
<div class="outline-text-4" id="text-3-2-1">
<p>
What is the most compelling rationale for skipping this step when
visualizing text data?
</p>
</div>

<div id="outline-container-sec-3-2-1-1" class="outline-5">
<h5 id="sec-3-2-1-1"><span class="section-number-5">3.2.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-3-2-1-1">
<ul class="org-ul">
<li><code>[&#xa0;]</code> It avoids the computational burden of stemming
</li>

<li><code>[X]</code> It will be easier to read and understand the word cloud if it
includes full words instead of just the word stems
</li>

<li><code>[&#xa0;]</code> We would not be able to create a word cloud if we stemmed the
document
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
We want to create an interpretable display of a document's contents,
and our results will be easier to read if they include full words
instead of just the stems.
</p>

<p>
Stemming has relatively minor computational burden, and we certainly
could create a word cloud with a stemmed document.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> Problem 2.1 - Building a Word Cloud (1 point possible)</h3>
<div class="outline-text-3" id="text-3-3">
<p>
Install and load the <code>wordcloud</code> package, which is needed to build
word clouds.
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Install new package: wordcloud ..."</span>)
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">install.packages('wordcloud', repos='http://cran.rstudio.com/')</span>
writeLines(<span style="color: #ff6a6a;">"\n :: NOTE: Please comment after install once..."</span>)

<span style="color: #db7093;">library</span>(wordcloud)
writeLines(<span style="color: #ff6a6a;">"\n :: Library wordcloud loaded..."</span>)
</pre>
</div>

<pre class="example">
:: Install new package: wordcloud ...

:: NOTE: Please comment after install once...

:: Library wordcloud loaded...
</pre>

<p>
As we can read from <code>?wordcloud</code>, we will need to provide the function
with a vector of words and a vector of word frequencies. Which
function can we apply to <code>allTweets</code> to get a vector of the words in our
dataset, which we'll pass as the first argument to <code>wordcloud()</code>?
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: We can pass the column names:"</span>)
head(colnames(allTweets), 50)

writeLines(<span style="color: #ff6a6a;">"\n :: Is the same as passing the names of the features:"</span>)
head(names(allTweets), 50)
</pre>
</div>

<pre class="example">
 :: We can pass the column names:
 [1] "000"           "075"           "0909"          "0910"
 [5] "099"           "100"           "100m"          "1085"
 [9] "10min"         "110"           "13apple"       "13th"
[13] "1415"          "16gb"          "16gbs"         "180"
[17] "18092013"      "18th"          "199"           "1am"
[21] "1jazzyjeff"    "1st"           "200"           "2000ad"
[25] "2001"          "2002"          "2004"          "2005"
[29] "2011with"      "2013"          "2014"          "20th"
[33] "211"           "21st"          "22000"         "22nd"
[37] "244tsuyoponzu" "2nd"           "2shaneez"      "2week"
[41] "300"           "30aud"         "30mins"        "320k"
[45] "350"           "3gs"           "3rd"           "3yr"
[49] "40000"         "40k"

 :: Is the same as passing the names of the features:
 [1] "000"           "075"           "0909"          "0910"
 [5] "099"           "100"           "100m"          "1085"
 [9] "10min"         "110"           "13apple"       "13th"
[13] "1415"          "16gb"          "16gbs"         "180"
[17] "18092013"      "18th"          "199"           "1am"
[21] "1jazzyjeff"    "1st"           "200"           "2000ad"
[25] "2001"          "2002"          "2004"          "2005"
[29] "2011with"      "2013"          "2014"          "20th"
[33] "211"           "21st"          "22000"         "22nd"
[37] "244tsuyoponzu" "2nd"           "2shaneez"      "2week"
[41] "300"           "30aud"         "30mins"        "320k"
[45] "350"           "3gs"           "3rd"           "3yr"
[49] "40000"         "40k"
</pre>
</div>

<div id="outline-container-sec-3-3-1" class="outline-4">
<h4 id="sec-3-3-1"><span class="section-number-4">3.3.1</span> Answer</h4>
<div class="outline-text-4" id="text-3-3-1">
<ul class="org-ul">
<li><code>[&#xa0;]</code> str
</li>
<li><code>[&#xa0;]</code> rownames
</li>
<li><code>[X]</code> colnames
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
Each tweet represents a row of <code>allTweets</code>, and each word represents a
column. We need the names of all the columns of <code>allTweets</code>, which is
returned by <code>colnames(allTweets)</code>. While <code>str(allTweets)</code> displays the
names of the variables along with other information, it doesn't return
a vector that we can use as the first argument to <code>wordcloud()</code>.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4"><span class="section-number-3">3.4</span> Problem 2.2 - Building a Word Cloud (1 point possible)</h3>
<div class="outline-text-3" id="text-3-4">
<p>
Which function should we apply to <code>allTweets</code> to obtain the frequency of
each word across all tweets?
</p>

<div class="org-src-container">

<pre class="src src-R">head(colSums(allTweets), 50)
</pre>
</div>

<pre class="example">
       000           075          0909          0910           099
         1             3             1             1             1
       100          100m          1085         10min           110
         2             1             3             1             1
   13apple          13th          1415          16gb         16gbs
         1             1             1             1             1
       180      18092013          18th           199           1am
         1             1             2             3             1
1jazzyjeff           1st           200        2000ad          2001
         1             1             2             1             1
      2002          2004          2005      2011with          2013
         1             1             2             1             4
      2014          20th           211          21st         22000
         3             4             1             1             1
      22nd 244tsuyoponzu           2nd      2shaneez         2week
         1             6             2             1             1
       300         30aud        30mins          320k           350
         2             1             1             1             1
       3gs           3rd           3yr         40000           40k
         1             1             1             1             1
</pre>
</div>

<div id="outline-container-sec-3-4-1" class="outline-4">
<h4 id="sec-3-4-1"><span class="section-number-4">3.4.1</span> Answer</h4>
<div class="outline-text-4" id="text-3-4-1">
<ul class="org-ul">
<li><code>[X]</code> colSums
</li>
<li><code>[&#xa0;]</code> rowSums
</li>
<li><code>[&#xa0;]</code> sum
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
Each tweet represents a row in <code>allTweets</code>, and each word represents a
column. Therefore, we need to access the sums of each column in
<code>allTweets</code>, which is returned by <code>colSums(allTweets)</code>.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-5" class="outline-3">
<h3 id="sec-3-5"><span class="section-number-3">3.5</span> Problem 2.3 - Building a Word Cloud (1 point possible)</h3>
<div class="outline-text-3" id="text-3-5">
<p>
Use <code>allTweets</code> to build a word cloud. Make sure to check out the help
page for <code>wordcloud</code> if you are not sure how to do this.
</p>

<p>
Because we are plotting a large number of words, you might get
warnings that some of the words could not be fit on the page and were
therefore not plotted &#x2013; this is especially likely if you are using a
smaller screen.
</p>

<p>
You can address these warnings by plotting the words smaller. From
<code>?wordcloud</code>, we can see that the <code>scale</code> parameter controls the sizes
of the plotted words. By default, the sizes range from 4 for the most
frequent words to 0.5 for the least frequent, as denoted by the
parameter <code>scale=c(4, 0.5)</code>. We could obtain a much smaller plot with,
for instance, parameter <code>scale=c(2, 0.25)</code>.
</p>


<div id="fig:AppleTweetsWordCloud" class="figure">
<p><img src="../graphs/AppleTweetsWordCloud.png" alt="AppleTweetsWordCloud.png" />
</p>
<p><span class="figure-number">Figure 20:</span> Apple tweets wordcloud v1</p>
</div>

<p>
What is the most common word across all the tweets (it will be the
largest in the outputted word cloud)? Please type the word exactly how
you see it in the word cloud. The most frequent word might not be
printed if you got a warning about words being cut off &#x2013; if this
happened, be sure to follow the instructions in the paragraph above.
</p>

<p>
<b>Explanation</b>
</p>

<p>
We can output the word cloud with:
</p>

<p>
<code>wordcloud(colnames(allTweets), colSums(allTweets))</code>
</p>

<p>
For smaller words, we could have used:
</p>

<p>
<code>wordcloud(colnames(allTweets), colSums(allTweets), scale=c(2, .25))</code>
</p>

<p>
<b>apple</b> is by far the largest, and therefore most common, word.
</p>
</div>
</div>

<div id="outline-container-sec-3-6" class="outline-3">
<h3 id="sec-3-6"><span class="section-number-3">3.6</span> Problem 2.4 - Building a Word Cloud (1 point possible)</h3>
<div class="outline-text-3" id="text-3-6">
<p>
In the previous subproblem, we noted that there is one word with a
much higher frequency than the other words. Repeat the steps to load
and pre-process the corpus, this time removing the most frequent word
in addition to all elements of stopwords("english") in the call to
tm_map with removeWords. For a refresher on how to remove this
additional word, see the Twitter text analytics lecture.
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: 1) Create a corpus using the Tweet variable..."</span>)
corpus <span style="color: #db7093;">&lt;-</span> Corpus(VectorSource(tweets$Tweet))

writeLines(<span style="color: #ff6a6a;">"\n :: 2) Convert the corpus to lowercase..."</span>)
corpus <span style="color: #db7093;">&lt;-</span> tm_map(corpus, tolower)
corpus <span style="color: #db7093;">&lt;-</span> tm_map(corpus, PlainTextDocument)

writeLines(<span style="color: #ff6a6a;">"\n :: 3) Remove punctuation from the corpus..."</span>)
corpus <span style="color: #db7093;">&lt;-</span> tm_map(corpus, removePunctuation)

writeLines(<span style="color: #ff6a6a;">"\n :: 4) Remove all English-language stopwords..."</span>)
corpus <span style="color: #db7093;">&lt;-</span> tm_map(corpus, removeWords, c(<span style="color: #ff6a6a;">"apple"</span>, stopwords(<span style="color: #ff6a6a;">"english"</span>)))

writeLines(<span style="color: #ff6a6a;">"\n :: 5) Build a document-term matrix out of the corpus..."</span>)
DocTermMatrix <span style="color: #db7093;">&lt;-</span> DocumentTermMatrix(corpus)

writeLines(<span style="color: #ff6a6a;">"\n :: 6) Convert the document-term matrix to a data frame called allTweets..."</span>)
allTweets <span style="color: #db7093;">&lt;-</span> as.data.frame(as.matrix(DocTermMatrix))
</pre>
</div>

<pre class="example">
quartz_off_screen
               2

:: 1) Create a corpus using the Tweet variable...

:: 2) Convert the corpus to lowercase...

:: 3) Remove punctuation from the corpus...

:: 4) Remove all English-language stopwords...

:: 5) Build a document-term matrix out of the corpus...

:: 6) Convert the document-term matrix to a data frame called allTweets...
</pre>

<p>
Replace allTweets with the document-term matrix of this new corpus &#x2013;
we will use this updated corpus for the remainder of the assignment.
</p>

<div class="org-src-container">

<pre class="src src-R">DocTermMatrix <span style="color: #db7093;">&lt;-</span> DocumentTermMatrix(corpus)
allTweets <span style="color: #db7093;">&lt;-</span> as.data.frame(as.matrix(DocTermMatrix))
</pre>
</div>

<p>
Create a word cloud with the updated corpus. What is the most common
word in this new corpus (the largest word in the outputted word
cloud)? The most frequent word might not be printed if you got a
warning about words being cut off &#x2013; if this happened, be sure to
follow the instructions in the previous problem.
</p>


<div id="fig:AppleTweetsWordcloud02" class="figure">
<p><img src="../graphs/AppleTweetsWordcloud02.png" alt="AppleTweetsWordcloud02.png" />
</p>
<p><span class="figure-number">Figure 21:</span> Apple tweets wordcloud v2</p>
</div>
</div>

<div id="outline-container-sec-3-6-1" class="outline-4">
<h4 id="sec-3-6-1"><span class="section-number-4">3.6.1</span> Answer</h4>
<div class="outline-text-4" id="text-3-6-1">
<p>
<b>iphone</b>
</p>

<p>
<b>Explanation</b>
</p>

<p>
We can do the specified update with the following commands:
</p>

<p>
<code>tweets = read.csv("tweets.csv", stringsAsFactors=FALSE)</code>
</p>

<p>
<code>corpus = Corpus(VectorSource(tweets$Tweet))</code>
</p>

<p>
<code>corpus = tm_map(corpus, tolower)</code>
</p>

<p>
<code>corpus = tm_map(corpus, removePunctuation)</code>
</p>

<p>
<code>corpus = tm_map(corpus, removeWords, c("apple", stopwords("english")))</code>
</p>

<p>
<code>frequencies = DocumentTermMatrix(corpus)</code>
</p>

<p>
<code>allTweets = as.data.frame(as.matrix(frequencies))</code>
</p>

<p>
<code>wordcloud(colnames(allTweets), colSums(allTweets))</code>
</p>

<p>
For a much smaller plot, we could have used:
</p>

<p>
<code>wordcloud(colnames(allTweets), colSums(allTweets), scale=c(2, 0.25))</code>
</p>

<p>
The most common (largest) word is now <b>iphone</b>.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-7" class="outline-3">
<h3 id="sec-3-7"><span class="section-number-3">3.7</span> Problem 3 - Size and Color</h3>
<div class="outline-text-3" id="text-3-7">
<p>
So far, the word clouds we've built have not been too visually
appealing &#x2013; they are crowded by having too many words displayed, and
they don't take advantage of color. One important step to building
visually appealing visualizations is to experiment with the parameters
available, which in this case can be viewed by typing <code>?wordcloud</code> in
your R console. In this problem, you should look through the help page
and experiment with different parameters to answer the questions.
</p>

<p>
Below are four word clouds, each of which uses different parameter
settings in the call to the <code>wordcloud()</code> function:
</p>

<p>
<b>Word Cloud A</b>:
</p>


<div class="figure">
<p><img src="../graphs/wordcloudA.png" alt="wordcloudA.png" />
</p>
</div>

<p>
<b>Word Cloud B</b>:
</p>


<div class="figure">
<p><img src="../graphs/wordcloudB.png" alt="wordcloudB.png" />
</p>
</div>

<p>
<b>Word Cloud C</b>:
</p>


<div class="figure">
<p><img src="../graphs/wordcloudC.png" alt="wordcloudC.png" />
</p>
</div>

<p>
<b>Word Cloud D</b>:
</p>


<div class="figure">
<p><img src="../graphs/wordcloudD.png" alt="wordcloudD.png" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-8" class="outline-3">
<h3 id="sec-3-8"><span class="section-number-3">3.8</span> Problem 3.1 - Size and Color (1 point possible)</h3>
<div class="outline-text-3" id="text-3-8">
</div><div id="outline-container-sec-3-8-1" class="outline-4">
<h4 id="sec-3-8-1"><span class="section-number-4">3.8.1</span> Question</h4>
<div class="outline-text-4" id="text-3-8-1">
<p>
Which word cloud is based only on the negative tweets (tweets with Avg
value -1 or less)?
</p>


<div id="fig:AppleTweetsWordcloud03" class="figure">
<p><img src="../graphs/AppleTweetsWordcloud03.png" alt="AppleTweetsWordcloud03.png" />
</p>
<p><span class="figure-number">Figure 26:</span> Apple tweets wordcloud v3</p>
</div>
</div>

<div id="outline-container-sec-3-8-1-1" class="outline-5">
<h5 id="sec-3-8-1-1"><span class="section-number-5">3.8.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-3-8-1-1">
<ul class="org-ul">
<li><code>[&#xa0;]</code> Word Cloud A
</li>
<li><code>[&#xa0;]</code> Word Cloud B
</li>
<li><code>[X]</code> Word Cloud C
</li>
<li><code>[&#xa0;]</code> Word Cloud D
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
Word Cloud C is the only one with a different distribution of the most
frequent words &#x2013; negative words (or censored versions of negative
words) are much more common in this cloud.
</p>

<p>
It is quite simple to obtain a word cloud that is limited to a subset
of the tweets using the subset function:
</p>

<p>
<code>negativeTweets = subset(allTweets, tweets$Avg &lt;= -1)</code>
</p>

<p>
<code>wordcloud(colnames(negativeTweets), colSums(negativeTweets))</code>
</p>
</div>
</div>
</div>
</div>


<div id="outline-container-sec-3-9" class="outline-3">
<h3 id="sec-3-9"><span class="section-number-3">3.9</span> Problem 3.2 - Size and Color (1 point possible)</h3>
<div class="outline-text-3" id="text-3-9">
</div><div id="outline-container-sec-3-9-1" class="outline-4">
<h4 id="sec-3-9-1"><span class="section-number-4">3.9.1</span> Question</h4>
<div class="outline-text-4" id="text-3-9-1">

<div id="fig:AppleTweetsWordcloud04" class="figure">
<p><img src="../graphs/AppleTweetsWordcloud04.png" alt="AppleTweetsWordcloud04.png" />
</p>
<p><span class="figure-number">Figure 27:</span> Apple tweets wordcloud v4</p>
</div>

<p>
Only one word cloud was created without modifying parameters min.freq
or max.words. Which word cloud is this?
</p>
</div>

<div id="outline-container-sec-3-9-1-1" class="outline-5">
<h5 id="sec-3-9-1-1"><span class="section-number-5">3.9.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-3-9-1-1">
<ul class="org-ul">
<li><code>[X]</code> Word Cloud A
</li>
<li><code>[&#xa0;]</code> Word Cloud B
</li>
<li><code>[&#xa0;]</code> Word Cloud C
</li>
<li><code>[&#xa0;]</code> Word Cloud D
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
<code>min.freq</code> and <code>max.words</code> are parameters that can be used to remove
the least frequent words, resulting is a less cluttered word
cloud. Word Cloud A is much more cluttered than the others because it
did not use either of these parameters, and therefore is displaying
every word that appears more than 3 times.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3-10" class="outline-3">
<h3 id="sec-3-10"><span class="section-number-3">3.10</span> Problem 3.3 - Size and Color (1 point possible)</h3>
<div class="outline-text-3" id="text-3-10">
</div><div id="outline-container-sec-3-10-1" class="outline-4">
<h4 id="sec-3-10-1"><span class="section-number-4">3.10.1</span> Question</h4>
<div class="outline-text-4" id="text-3-10-1">

<div id="fig:AppleTweetsWordcloud05" class="figure">
<p><img src="../graphs/AppleTweetsWordcloud05.png" alt="AppleTweetsWordcloud05.png" />
</p>
<p><span class="figure-number">Figure 28:</span> Apple tweets wordcloud v5</p>
</div>

<p>
Which word clouds were created with parameter <code>random.order</code> set to
<code>FALSE</code>?
</p>
</div>

<div id="outline-container-sec-3-10-1-1" class="outline-5">
<h5 id="sec-3-10-1-1"><span class="section-number-5">3.10.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-3-10-1-1">
<ul class="org-ul">
<li><code>[&#xa0;]</code> Word Cloud A
</li>
<li><code>[X]</code> Word Cloud B
</li>
<li><code>[&#xa0;]</code> Word Cloud C
</li>
<li><code>[X]</code> Word Cloud D
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
If <code>random.order</code> is set to <code>FALSE</code>, then the most frequent (largest)
words will be plotted first, resulting in them being displayed
together in the center of the word cloud. This is the case in Word
Cloud B and Word Cloud D.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3-11" class="outline-3">
<h3 id="sec-3-11"><span class="section-number-3">3.11</span> Problem 3.4 - Size and Color (1 point possible)</h3>
<div class="outline-text-3" id="text-3-11">
</div><div id="outline-container-sec-3-11-1" class="outline-4">
<h4 id="sec-3-11-1"><span class="section-number-4">3.11.1</span> Question</h4>
<div class="outline-text-4" id="text-3-11-1">

<div id="fig:AppleTweetsWordcloud06" class="figure">
<p><img src="../graphs/AppleTweetsWordcloud06.png" alt="AppleTweetsWordcloud06.png" />
</p>
<p><span class="figure-number">Figure 29:</span> Apple tweets wordcloud v6</p>
</div>

<p>
Which word cloud was built with a non-default value for parameter
<code>rot.per</code>?
</p>
</div>

<div id="outline-container-sec-3-11-1-1" class="outline-5">
<h5 id="sec-3-11-1-1"><span class="section-number-5">3.11.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-3-11-1-1">
<ul class="org-ul">
<li><code>[X]</code> Word Cloud A
</li>
<li><code>[&#xa0;]</code> Word Cloud B
</li>
<li><code>[&#xa0;]</code> Word Cloud C
</li>
<li><code>[&#xa0;]</code> Word Cloud D
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
<code>rot.per</code> controls the proportion of words that are rotated to be
vertical in the word cloud. By default \(10\%\) of words are
rotated. However in Word Cloud A a much higher proportion (\(50\%\)) are
rotated, which was achieved by setting <code>rot.per=0.5</code>.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3-12" class="outline-3">
<h3 id="sec-3-12"><span class="section-number-3">3.12</span> Problem 3.5 - Size and Color (1 point possible)</h3>
<div class="outline-text-3" id="text-3-12">
</div><div id="outline-container-sec-3-12-1" class="outline-4">
<h4 id="sec-3-12-1"><span class="section-number-4">3.12.1</span> Question</h4>
<div class="outline-text-4" id="text-3-12-1">

<div id="fig:AppleTweetsWordcloud07" class="figure">
<p><img src="../graphs/AppleTweetsWordcloud07.png" alt="AppleTweetsWordcloud07.png" />
</p>
<p><span class="figure-number">Figure 30:</span> Apple tweets wordcloud v7</p>
</div>

<p>
In Word Cloud C and Word Cloud D, we provided a color palette ranging
from light purple to dark purple as the parameter colors (you will
learn how to make such a color palette later in this assignment). For
which word cloud was the parameter <code>random.color</code> set to <code>TRUE</code>?
</p>
</div>

<div id="outline-container-sec-3-12-1-1" class="outline-5">
<h5 id="sec-3-12-1-1"><span class="section-number-5">3.12.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-3-12-1-1">
<ul class="org-ul">
<li><code>[&#xa0;]</code> Word Cloud C
</li>
<li><code>[X]</code> Word Cloud D
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
When <code>random.color</code> is set to <code>TRUE</code>, the words will be colored
randomly. This is the case in Word Cloud D. Meanwhile, colors were
assigned based on the number of appearances in Word Cloud C.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3-13" class="outline-3">
<h3 id="sec-3-13"><span class="section-number-3">3.13</span> Problem 4.1 - Selecting a Color Palette (1 point possible)</h3>
<div class="outline-text-3" id="text-3-13">
<p>
The use of a palette of colors can often improve the overall effect of
a visualization. We can easily select our own colors when plotting;
for instance, we could pass <code>c("red", "green", "blue")</code> as the colors
parameter to <code>wordcloud()</code>. The <code>RColorBrewer</code> package, which is based on
the <code>ColorBrewer</code> project (<code>colorbrewer.org</code>), provides pre-selected
palettes that can lead to more visually appealing images. Though these
palettes are designed specifically for coloring maps, we can also use
them in our word clouds and other visualizations.
</p>

<p>
Begin by installing and loading the <code>RColorBrewer</code> package. This
package may have already been installed and loaded when you installed
and loaded the <code>wordcloud</code> package, in which case you don't need to go
through this additional installation step. If you obtain errors (for
instance, <code>Error: lazy-load database 'P' is corrupt</code>) after installing
and loading the <code>RColorBrewer</code> package and running some of the commands,
try closing and re-opening R.
</p>

<p>
The function <code>brewer.pal()</code> returns color palettes from the <code>ColorBrewer</code>
project when provided with appropriate parameters, and the function
<code>display.brewer.all()</code> displays the palettes we can choose from.
</p>


<div id="fig:ColorBrewerPalette" class="figure">
<p><img src="../graphs/ColorBrewerPalette.png" alt="ColorBrewerPalette.png" />
</p>
<p><span class="figure-number">Figure 31:</span> ColorBrewer package palette</p>
</div>

<p>
Which color palette would be most appropriate for use in a word cloud
for which we want to use color to indicate word frequency?
</p>
</div>

<div id="outline-container-sec-3-13-1" class="outline-4">
<h4 id="sec-3-13-1"><span class="section-number-4">3.13.1</span> Answer</h4>
<div class="outline-text-4" id="text-3-13-1">
<ul class="org-ul">
<li><code>[&#xa0;]</code> Accent
</li>
<li><code>[&#xa0;]</code> Set2
</li>
<li><code>[X]</code> YlOrRd
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
From <code>?brewer.pal</code> we read that <code>Accent</code> and <code>Set2</code> are both
<b>qualitative palettes</b>, which means color changes don't imply a change
in magnitude (we can also see this in the output of
<code>display.brewer.all()</code>). As a result, the colors selected would not
visually identify the least and most frequent words.
</p>

<p>
On the other hand, <code>YlOrRd</code> is a <b>sequential palette</b>, with earlier
colors begin lighter and later colors being darker. Therefore, it is a
good palette choice for indicating low-frequency vs. high-frequency
words.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-14" class="outline-3">
<h3 id="sec-3-14"><span class="section-number-3">3.14</span> Problem 4.2 - Selecting a Color Palette (1 point possible)</h3>
<div class="outline-text-3" id="text-3-14">
</div><div id="outline-container-sec-3-14-1" class="outline-4">
<h4 id="sec-3-14-1"><span class="section-number-4">3.14.1</span> Question</h4>
<div class="outline-text-4" id="text-3-14-1">
<p>
Which <code>RColorBrewer</code> palette name would be most appropriate to use when
preparing an image for a document that must be in grayscale?
</p>
</div>

<div id="outline-container-sec-3-14-1-1" class="outline-5">
<h5 id="sec-3-14-1-1"><span class="section-number-5">3.14.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-3-14-1-1">
<p>
<b>Greys</b>
</p>

<p>
<b>Explanation</b>
</p>

<p>
As we can see from display.brewer.all(), palette "Greys" is the only
one completely in grayscale.
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3-15" class="outline-3">
<h3 id="sec-3-15"><span class="section-number-3">3.15</span> Problem 4.3 - Selecting a Color Palette (1 point possible)</h3>
<div class="outline-text-3" id="text-3-15">
<p>
In sequential palettes, sometimes there is an undesirably large
contrast between the lightest and darkest colors. You can see this
effect when plotting a word cloud for <code>allTweets</code> with parameter
<code>colors=brewer.pal(9, "Blues")</code>, which returns a sequential blue palette
with 9 colors.
</p>


<div id="fig:AppleTweetsWordcloud08" class="figure">
<p><img src="../graphs/AppleTweetsWordcloud08.png" alt="AppleTweetsWordcloud08.png" />
</p>
<p><span class="figure-number">Figure 32:</span> Apple tweets wordcloud palette</p>
</div>
</div>

<div id="outline-container-sec-3-15-1" class="outline-4">
<h4 id="sec-3-15-1"><span class="section-number-4">3.15.1</span> Question</h4>
<div class="outline-text-4" id="text-3-15-1">

<div id="fig:AppleTweetsWordcloud09" class="figure">
<p><img src="../graphs/AppleTweetsWordcloud09.png" alt="AppleTweetsWordcloud09.png" />
</p>
<p><span class="figure-number">Figure 33:</span> Better palette for our wordcloud</p>
</div>

<p>
Which of the following commands addresses this issue by removing the
first 4 elements of the 9-color palette of blue colors? Select all
that apply.
</p>
</div>

<div id="outline-container-sec-3-15-1-1" class="outline-5">
<h5 id="sec-3-15-1-1"><span class="section-number-5">3.15.1.1</span> Answer</h5>
<div class="outline-text-5" id="text-3-15-1-1">
<ul class="org-ul">
<li><code>[&#xa0;]</code> <code>brewer.pal(9, "Blues")[c(-5, -6, -7, -8, -9)]</code>
</li>
<li><code>[X]</code> <code>brewer.pal(9, "Blues")[c(-1, -2, -3, -4)]</code>
</li>
<li><code>[&#xa0;]</code> <code>brewer.pal(9, "Blues")[c(1, 2, 3, 4)]</code>
</li>
<li><code>[X]</code> <code>brewer.pal(9, "Blues")[c(5, 6, 7, 8, 9)]</code>
</li>
</ul>

<p>
<b>Explanation</b>
</p>

<p>
The fourth option limits to elements 5-9, which removes the first
four. The second option uses negative indexes, which means remove
elements 1-4. The first and third options actually keep colors 1-4,
discarding the rest.
</p>

<p>
A shorthand for this indexing is:
</p>

<p>
<code>brewer.pal(9, "Blues")[-1:-4]</code>
</p>

<p>
<code>brewer.pal(9, "Blues")[5:9]</code>
</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 24/07/2015</p>
<p class="author">Author: Sergio-Feliciano Mendoza-Barrera</p>
<p class="date">Created: 2015-07-26 Sun 10:58</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.5.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
