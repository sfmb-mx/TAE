<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Kaggle Competition. 15.071x - The Analytics Edge (Summer 2015).</title>
<!-- 2015-07-31 Fri 13:36 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Sergio-Feliciano Mendoza-Barrera" />
<meta  name="description" content="The Analytics Edge Kaggle competition"
 />
<meta  name="keywords" content="R, data science, emacs, ESS, org-mode, kaggle, competition" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/lib/js/jquery.stickytableheaders.js"></script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Kaggle Competition. 15.071x - The Analytics Edge (Summer 2015).</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Introduction</a>
<ul>
<li><a href="#sec-1-1">1.1. Welcome to the Kaggle Competition!</a></li>
<li><a href="#sec-1-2">1.2. Getting started on Kaggle</a></li>
<li><a href="#sec-1-3">1.3. Dealing with the text data</a></li>
<li><a href="#sec-1-4">1.4. Example R script</a></li>
</ul>
</li>
<li><a href="#sec-2">2. Test your analytics skills by predicting which iPads listed on eBay will be sold</a>
<ul>
<li><a href="#sec-2-1">2.1. Acknowledgments</a></li>
</ul>
</li>
<li><a href="#sec-3">3. Understanding the data</a>
<ul>
<li><a href="#sec-3-1">3.1. Clear workspace for initialization purposes</a></li>
<li><a href="#sec-3-2">3.2. Download the data sets</a></li>
<li><a href="#sec-3-3">3.3. Load the data sets</a></li>
<li><a href="#sec-3-4">3.4. File descriptions</a></li>
<li><a href="#sec-3-5">3.5. Data fields or data features available</a></li>
<li><a href="#sec-3-6">3.6. Load the necessary libraries</a></li>
<li><a href="#sec-3-7">3.7. Inspecting the data set</a></li>
<li><a href="#sec-3-8">3.8. Preprocessing the data</a></li>
<li><a href="#sec-3-9">3.9. Understanding each type and distribution of the data</a></li>
<li><a href="#sec-3-10">3.10. The dummy variable creation</a></li>
<li><a href="#sec-3-11">3.11. Partitioning the data</a></li>
</ul>
</li>
<li><a href="#sec-4">4. Machine Learning Models</a>
<ul>
<li><a href="#sec-4-1">4.1. Baseline model</a></li>
<li><a href="#sec-4-2">4.2. Logistic regression models</a></li>
<li><a href="#sec-4-3">4.3. Random forest models</a></li>
</ul>
</li>
<li><a href="#sec-5">5. Prepare the CSV file for submission</a></li>
</ul>
</div>
</div>
<div class="abstract">
<p>
This is the document for the Kaggle competition for the Analytics Edge
course from MIT.
</p>

</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Welcome to the Kaggle Competition!</h3>
<div class="outline-text-3" id="text-1-1">
<p>
For the next three weeks, you will be participating in a competition
on Kaggle. You should have already set up a Kaggle account (this was
the last component of Unit 6). When the competition is over, you will
be able to check your grade on the competition by going to your
Progress page.
</p>

<p>
We have created two R script files to help you get started on this
competition. The first script (on the next page), is intended to help
you get started by building a simple logistic regression model and
preparing the results for submission on Kaggle. The second script (on
the following page), is designed to help you deal with the text data
provided in this competition. We highly recommend that you carefully
go through both of these script files, and refer to them during the
competition.
</p>

<p>
If you get stuck or have questions, please use the Discussion forum on
the edX site for this class. Remember though that the standard
discussion forum rules apply. You should not ask for answers or give
any answers on the forum.
</p>

<p>
Once you are ready, go ahead and get started by heading to the
<a href="https://kaggle.com/join/15071xtheanalyticsedgesummer2015">competition page</a> on Kaggle. Note that this competition is a private
competition only for students in 15.071x. Please do not distribute
this link to people who are not enrolled in this class.
</p>

<p>
Good luck!
</p>
</div>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Getting started on Kaggle</h3>
<div class="outline-text-3" id="text-1-2">
<p>
If you have never participated in a Kaggle competition before, or if
you just want some help getting started, we have created <a href="https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/KCompetition_GettingStarted.R">this R script</a>
file to help you get started. It shows you how to prepare a submission
file for a simple logistic regression model, and how to get the most
out of the date/time variable in the dataset.
</p>

<p>
Before going through the script file, please explore the Kaggle
competition by following the link on the previous page. There are
several very important pages in the competition:
</p>

<ul class="org-ul">
<li>The "<b>Data</b>" page of the competition describes the data and gives
you links to download the data.
</li>

<li>The "<b>Evaluation</b>" page is where you will learn how the competition
is graded and how to make submissions.
</li>

<li>The "<b>Rules</b>" page outlines some very important rules for the
competition. Please keep in mind that all of your submissions should
reflect the results of your own analytical models, built using the
data provided on the Kaggle site. While you can use the discussion
forum to ask questions and get help, the standard rules
apply. Please do not ask for or give solutions to the
competition. We will be checking submissions for signs of copying,
either from your classmates or from outside sources.
</li>

<li>When you are ready to make a submission, the "<b>Make a Submission</b>"
page is where you can submit your solution. Note that you can make
up to 5 submissions each day, so don't hesitate to get creative and
try out many different models!
</li>
</ul>

<p>
If you have questions about the logistics of the competition, or need
help understanding the provided script file, please go to the
Discussion forum by using the link below.
</p>

<p>
Remember that this script file is just designed to help you get
started. You will need to build better models to do well in the
competition!
</p>
</div>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> Dealing with the text data</h3>
<div class="outline-text-3" id="text-1-3">
<p>
The data for this competition has a few variables composed of
unstructured text data. You should be comfortable using the <b>bag of
words</b> approach on text data from Unit 5, and we want to encourage you
to use this data to improve your predictive models. However, you need
to deal with the text data for this competition in a slightly
different way from how we have dealt with text data in the past,
because it is already split into a training set and a test set.
</p>

<p>
This <a href="https://courses.edx.org/asset-v1:MITx+15.071x_2a+2T2015+type@asset+block/KCompetition_TextData.R">R script file</a> is designed to help you get started working with
some the text data provided in the eBay dataset. If you have any
questions about the approach used in the script file, please go to the
Dicussion forum to get help by following the link below.
</p>

<p>
Remember that this script file is just designed to help you get
started. You will need to build better models to do well in the
competition!
</p>
</div>
</div>

<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> Example R script</h3>
<div class="outline-text-3" id="text-1-4">
</div><div id="outline-container-sec-1-4-1" class="outline-4">
<h4 id="sec-1-4-1"><span class="section-number-4">1.4.1</span> KAGGLE COMPETITION - GETTING STARTED</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
This script file is intended to help you get started on the Kaggle
platform, and to show you how to make a submission to the
competition.
</p>
</div>
</div>

<div id="outline-container-sec-1-4-2" class="outline-4">
<h4 id="sec-1-4-2"><span class="section-number-4">1.4.2</span> Let's start by reading the data into R</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
Make sure you have downloaded these files from the Kaggle website,
and have navigated to the directory where you saved the files on
your computer
</p>

<p>
We are adding in the argument <code>stringsAsFactors = FALSE</code>, since we have
some text fields
</p>

<div class="org-src-container">

<pre class="src src-R">eBayDS1 <span style="color: #db7093;">&lt;-</span> read.csv(<span style="color: #ff6a6a;">"../data/eBayiPadTrain.csv"</span>, stringsAsFactors = <span style="color: #3cb371;">FALSE</span>)
eBayValidation1 <span style="color: #db7093;">&lt;-</span> read.csv(<span style="color: #ff6a6a;">"../data/eBayiPadTest.csv"</span>, stringsAsFactors = <span style="color: #3cb371;">FALSE</span>)
</pre>
</div>

<p>
We will just create a simple logistic regression model, to predict
Sold using Price:
</p>

<div class="org-src-container">

<pre class="src src-R">SimpleMod <span style="color: #db7093;">&lt;-</span> glm(sold ~ startprice, data = eBayDS1, family = binomial)
</pre>
</div>

<p>
And then make predictions on the test set:
</p>

<div class="org-src-container">

<pre class="src src-R">PredTest <span style="color: #db7093;">&lt;-</span> predict(SimpleMod, newdata = eBayValidation1, type = <span style="color: #ff6a6a;">"response"</span>)
</pre>
</div>

<p>
We can't compute the <code>accuracy</code> or <code>AUC</code> on the test set ourselves,
since we don't have the dependent variable on the test set (you can
compute it on the training set though!).
</p>

<p>
However, you can submit the file on Kaggle to see how well the
model performs. You can make up to 5 submissions per day, so don't
hesitate to just upload a solution to see how you did.
</p>

<p>
Let's prepare a submission file for Kaggle (for more about this,
see the "Evaluation" page on the competition site):
</p>

<div class="org-src-container">

<pre class="src src-R">MySubmission <span style="color: #db7093;">&lt;-</span> data.frame(UniqueID = eBayValidation$UniqueID, Probability1
                           = PredTest)

write.csv(MySubmission, <span style="color: #ff6a6a;">"../data/SubmissionSimpleLogV1.csv"</span>, row.names
          = <span style="color: #3cb371;">FALSE</span>)
</pre>
</div>

<p>
You should upload the submission <code>SubmissionSimpleLog.csv</code> on the
Kaggle website to use this as a submission to the competition
</p>

<p>
This model was just designed to help you get started - to do well
in the competition, you will need to build better models!
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Test your analytics skills by predicting which iPads listed on eBay will be sold</h2>
<div class="outline-text-2" id="text-2">
<p>
<b>IMPORTANT NOTE</b>: This competition is only open to students of the
MITx free, online course 15.071x - The Analytics Edge.
</p>

<p>
<b>What makes an eBay listing successful?</b>
</p>

<p>
Sellers on online auction websites need to understand the
characteristics of a successful item listing to maximize their
revenue. Buyers might also be interested in understanding which
listings are less attractive so as to score a good deal. In this
competition, we challenge you to develop an analytics model that will
help buyers and sellers predict the sales success of a set of eBay
listings for Apple iPads from spring 2015.
</p>

<p>
The following screenshot shows an example of iPad listings on eBay:
</p>


<div class="figure">
<p><img src="../graphs/ScreenshotEbay.png" alt="ScreenshotEbay.png" />
</p>
</div>

<p>
To download the data and learn how this competition works, please be
sure to read the "Data" page, as well as the "Evaluation" page, which
can both be found in the panel on the left.
</p>
</div>

<div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1"><span class="section-number-3">2.1</span> Acknowledgments</h3>
<div class="outline-text-3" id="text-2-1">
<p>
This competition is brought to you by MITx and edX.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Understanding the data</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> Clear workspace for initialization purposes</h3>
<div class="outline-text-3" id="text-3-1">
<p>
As first step we will reset all the workspace
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: clearing workspace..."</span>)
rm(list = ls(all = <span style="color: #3cb371;">TRUE</span>))
</pre>
</div>

<pre class="example">
:: clearing workspace...
</pre>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> Download the data sets</h3>
<div class="outline-text-3" id="text-3-2">
<p>
In this part we can download the data
</p>

<div class="org-src-container">

<pre class="src src-R"><span style="color: #4682b4;">if</span>(!file.exists(<span style="color: #ff6a6a;">"../data"</span>)) {
        dir.create(<span style="color: #ff6a6a;">"../data"</span>)
}

fileUrl <span style="color: #db7093;">&lt;-</span>
c(<span style="color: #ff6a6a;">"https://inclass.kaggle.com/c/15-071x-the-analytics-edge-summer-2015/download/eBayiPadTest.csv"</span>,
<span style="color: #ff6a6a;">"https://inclass.kaggle.com/c/15-071x-the-analytics-edge-summer-2015/download/eBayiPadTrain.csv"</span>,
<span style="color: #ff6a6a;">"https://inclass.kaggle.com/c/15-071x-the-analytics-edge-summer-2015/download/SampleSubmission.csv"</span>)

fileName <span style="color: #db7093;">&lt;-</span> c(<span style="color: #ff6a6a;">"eBayiPadTest.csv"</span>, <span style="color: #ff6a6a;">"eBayiPadTrain.csv"</span>, <span style="color: #ff6a6a;">"SampleSubmission.csv"</span>)

dataPath <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">"../data"</span>

<span style="color: #4682b4;">for</span>(i <span style="color: #4682b4;">in</span> 1:3) {
        filePath <span style="color: #db7093;">&lt;-</span> paste(dataPath, fileName[i], sep = <span style="color: #ff6a6a;">"/"</span>)

        <span style="color: #4682b4;">if</span>(!file.exists(filePath)) {
                download.file(fileUrl[i], destfile = filePath, method = <span style="color: #ff6a6a;">"curl"</span>)
        }
}
writeLines(<span style="color: #ff6a6a;">"\n :: Files downloaded..."</span>)
</pre>
</div>

<pre class="example">
:: Files downloaded...
</pre>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3"><span class="section-number-3">3.3</span> Load the data sets</h3>
<div class="outline-text-3" id="text-3-3">
<p>
We need to investigate the best way to load the data, in this case a
series of factor features can improve the performance of the algorithms
</p>

<div class="org-src-container">

<pre class="src src-R">eBayDS <span style="color: #db7093;">&lt;-</span> read.csv(<span style="color: #ff6a6a;">"../data/eBayiPadTrain.csv"</span>, stringsAsFactors = <span style="color: #3cb371;">FALSE</span>)
eBayValidation <span style="color: #db7093;">&lt;-</span> read.csv(<span style="color: #ff6a6a;">"../data/eBayiPadTest.csv"</span>, stringsAsFactors = <span style="color: #3cb371;">FALSE</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-4" class="outline-3">
<h3 id="sec-3-4"><span class="section-number-3">3.4</span> File descriptions</h3>
<div class="outline-text-3" id="text-3-4">
<p>
The data provided for this competition is split into two files:
</p>

<ul class="org-ul">
<li><b>eBayiPadTrain.csv</b> = the training data set. It consists of 1861 listings.
</li>

<li><b>eBayiPadTest.csv</b> = the testing data set. It consists of 798 listings.
</li>

<li>We have also provided a sample submission file,
<b>SampleSubmission.csv</b>. This file gives an example of the format of
submission files (see the Evaluation page for more information). The
data for this competition comes from eBay.com.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-3-5" class="outline-3">
<h3 id="sec-3-5"><span class="section-number-3">3.5</span> Data fields or data features available</h3>
<div class="outline-text-3" id="text-3-5">
<p>
The dependent variable in this problem is the variable sold, which
labels if an iPad listed on the eBay site was sold (equal to 1 if it
did, and 0 if it did not). The dependent variable is provided in the
training data set, but not the testing dataset. This is an important
difference from what you are used to - you will not be able to see how
well your model does on the test set until you make a submission on
Kaggle.
</p>

<p>
The independent variables consist of 9 pieces of product data
available at the time the iPad listing is posted, and a unique
identifier:
</p>

<ul class="org-ul">
<li><b>description</b> = The text description of the product provided by the
seller.
</li>

<li><b>biddable</b> = Whether this is an auction (biddable=1) or a sale with
a fixed price (biddable=0).
</li>

<li><b>startprice</b> = The start price (in US Dollars) for the auction (if
biddable=1) or the sale price (if biddable=0).
</li>

<li><b>condition</b> = The condition of the product (new, used, etc.)
</li>

<li><b>cellular</b> = Whether the iPad has cellular connectivity (cellular=1)
or not (cellular=0).
</li>

<li><b>carrier</b> = The cellular carrier for which the iPad is equipped (if
cellular=1); listed as "None" if cellular=0.
</li>

<li><b>color</b> = The color of the iPad.
</li>

<li><b>storage</b> = The iPad's storage capacity (in gigabytes).
</li>

<li><b>productline</b> = The name of the product being sold.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-3-6" class="outline-3">
<h3 id="sec-3-6"><span class="section-number-3">3.6</span> Load the necessary libraries</h3>
<div class="outline-text-3" id="text-3-6">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Loading the necessary libraries..."</span>)
<span style="color: #db7093;">library</span>(caret)                          <span style="color: #9932cc;"># </span><span style="color: #ba55d3;">ML interface to many</span>
                                        <span style="color: #9932cc;"># </span><span style="color: #ba55d3;">functions</span>
<span style="color: #db7093;">library</span>(ggplot2)                        <span style="color: #9932cc;"># </span><span style="color: #ba55d3;">Graphical libraries</span>
<span style="color: #db7093;">library</span>(caTools)                        <span style="color: #9932cc;"># </span><span style="color: #ba55d3;">Partition data sets</span>
<span style="color: #db7093;">library</span>(parallel)                       <span style="color: #9932cc;"># </span><span style="color: #ba55d3;">Parallel computation</span>
<span style="color: #db7093;">library</span>(mice)                           <span style="color: #9932cc;"># </span><span style="color: #ba55d3;">Imputation library</span>
<span style="color: #db7093;">library</span>(ROCR)                           <span style="color: #9932cc;"># </span><span style="color: #ba55d3;">ROCS for AUC calculation</span>
<span style="color: #db7093;">library</span>(randomForest)                   <span style="color: #9932cc;"># </span><span style="color: #ba55d3;">Random Forest library</span>
<span style="color: #db7093;">library</span>(pROC)                           <span style="color: #9932cc;"># </span><span style="color: #ba55d3;">ROC calculations</span>
<span style="color: #db7093;">library</span>(gbm)                            <span style="color: #9932cc;"># </span><span style="color: #ba55d3;">gbm algorithm</span>
<span style="color: #db7093;">library</span>(parallel)                       <span style="color: #9932cc;"># </span><span style="color: #ba55d3;">Multicore calculations</span>
</pre>
</div>

<pre class="example">
:: Loading the necessary libraries...
</pre>
</div>
</div>

<div id="outline-container-sec-3-7" class="outline-3">
<h3 id="sec-3-7"><span class="section-number-3">3.7</span> Inspecting the data set</h3>
<div class="outline-text-3" id="text-3-7">
<p>
Lets begin researching in the training data set.
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"    The structure of the training data set:"</span>)
str(eBayDS)
</pre>
</div>

<pre class="example">
    The structure of the training data set:
'data.frame':	1861 obs. of  11 variables:
 $ description: chr  "iPad is in 8.5+ out of 10 cosmetic condition!" "Previously used, please read description. May show signs of use such as scratches to the screen and " "" "" ...
 $ biddable   : int  0 1 0 0 0 1 1 0 1 1 ...
 $ startprice : num  159.99 0.99 199.99 235 199.99 ...
 $ condition  : chr  "Used" "Used" "Used" "New other (see details)" ...
 $ cellular   : chr  "0" "1" "0" "0" ...
 $ carrier    : chr  "None" "Verizon" "None" "None" ...
 $ color      : chr  "Black" "Unknown" "White" "Unknown" ...
 $ storage    : chr  "16" "16" "16" "16" ...
 $ productline: chr  "iPad 2" "iPad 2" "iPad 4" "iPad mini 2" ...
 $ sold       : int  0 1 1 0 0 1 1 0 1 1 ...
 $ UniqueID   : int  10001 10002 10003 10004 10005 10006 10007 10008 10009 10010 ...
</pre>
</div>
</div>

<div id="outline-container-sec-3-8" class="outline-3">
<h3 id="sec-3-8"><span class="section-number-3">3.8</span> Preprocessing the data</h3>
<div class="outline-text-3" id="text-3-8">
<p>
In this part we can try with different types for the data in order to
have a better understanding of the data and to have the probability to
improve the models. We can assume that some default values must be
changed to the right type.
</p>
</div>

<div id="outline-container-sec-3-8-1" class="outline-4">
<h4 id="sec-3-8-1"><span class="section-number-4">3.8.1</span> Training data set</h4>
<div class="outline-text-4" id="text-3-8-1">
<div class="org-src-container">

<pre class="src src-R">eBayDS$condition <span style="color: #db7093;">&lt;-</span> as.factor(eBayDS$condition)
eBayDS$cellular <span style="color: #db7093;">&lt;-</span> as.integer(eBayDS$cellular)
eBayDS$carrier <span style="color: #db7093;">&lt;-</span> as.factor(eBayDS$carrier)
eBayDS$color <span style="color: #db7093;">&lt;-</span> as.factor(eBayDS$color)
eBayDS$storage <span style="color: #db7093;">&lt;-</span> as.factor(eBayDS$storage)
eBayDS$productline <span style="color: #db7093;">&lt;-</span> as.factor(eBayDS$productline)
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">eBayDS$sold &lt;- as.factor(eBayDS$sold)</span>

writeLines(<span style="color: #ff6a6a;">"\n :: New structure of the original training set:"</span>)
str(eBayDS)
</pre>
</div>

<pre class="example">
Warning message:
NAs introduced by coercion

 :: New structure of the original training set:
'data.frame':	1861 obs. of  11 variables:
 $ description: chr  "iPad is in 8.5+ out of 10 cosmetic condition!" "Previously used, please read description. May show signs of use such as scratches to the screen and " "" "" ...
 $ biddable   : int  0 1 0 0 0 1 1 0 1 1 ...
 $ startprice : num  159.99 0.99 199.99 235 199.99 ...
 $ condition  : Factor w/ 6 levels "For parts or not working",..: 6 6 6 4 5 6 3 3 6 6 ...
 $ cellular   : int  0 1 0 0 NA 1 0 0 1 0 ...
 $ carrier    : Factor w/ 7 levels "AT&amp;T","None",..: 2 7 2 2 6 1 2 2 6 2 ...
 $ color      : Factor w/ 5 levels "Black","Gold",..: 1 4 5 4 4 3 3 5 5 5 ...
 $ storage    : Factor w/ 5 levels "128","16","32",..: 2 2 2 2 5 3 2 2 4 3 ...
 $ productline: Factor w/ 12 levels "iPad 1","iPad 2",..: 2 2 4 9 12 9 8 10 1 4 ...
 $ sold       : int  0 1 1 0 0 1 1 0 1 1 ...
 $ UniqueID   : int  10001 10002 10003 10004 10005 10006 10007 10008 10009 10010 ...
</pre>
</div>
</div>

<div id="outline-container-sec-3-8-2" class="outline-4">
<h4 id="sec-3-8-2"><span class="section-number-4">3.8.2</span> Validation data set</h4>
<div class="outline-text-4" id="text-3-8-2">
<div class="org-src-container">

<pre class="src src-R">eBayValidation$condition <span style="color: #db7093;">&lt;-</span> as.factor(eBayValidation$condition)
eBayValidation$cellular <span style="color: #db7093;">&lt;-</span> as.integer(eBayValidation$cellular)
eBayValidation$carrier <span style="color: #db7093;">&lt;-</span> as.factor(eBayValidation$carrier)
eBayValidation$color <span style="color: #db7093;">&lt;-</span> as.factor(eBayValidation$color)
eBayValidation$storage <span style="color: #db7093;">&lt;-</span> as.factor(eBayValidation$storage)
eBayValidation$productline <span style="color: #db7093;">&lt;-</span> as.factor(eBayValidation$productline)
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">eBayValidation$sold &lt;- as.factor(eBayValidation$sold)</span>

writeLines(<span style="color: #ff6a6a;">"\n :: New structure of the original training set:"</span>)
str(eBayValidation)
</pre>
</div>

<pre class="example">
Warning message:
NAs introduced by coercion

 :: New structure of the original training set:
'data.frame':	798 obs. of  10 variables:
 $ description: chr  "like new" "Item is in great shape. I upgraded to the iPad Air 2 and don&amp;#039;t need the mini any longer, even though " "This iPad is working and is tested 100%. It runs great. It is in good condition. Cracked digitizer." "" ...
 $ biddable   : int  0 0 0 1 0 0 0 0 0 1 ...
 $ startprice : num  105 195 220 100 211 ...
 $ condition  : Factor w/ 6 levels "For parts or not working",..: 6 6 6 6 2 4 5 6 6 6 ...
 $ cellular   : int  1 0 0 0 0 0 0 0 0 0 ...
 $ carrier    : Factor w/ 7 levels "AT&amp;T","None",..: 1 2 2 2 2 2 2 2 2 2 ...
 $ color      : Factor w/ 5 levels "Black","Gold",..: 4 4 4 4 1 2 1 4 1 4 ...
 $ storage    : Factor w/ 5 levels "128","16","32",..: 3 2 4 2 3 4 3 2 2 3 ...
 $ productline: Factor w/ 10 levels "iPad 1","iPad 2",..: 1 8 3 7 3 6 1 4 3 1 ...
 $ UniqueID   : int  11862 11863 11864 11865 11866 11867 11868 11869 11870 11871 ...
</pre>
</div>
</div>

<div id="outline-container-sec-3-8-3" class="outline-4">
<h4 id="sec-3-8-3"><span class="section-number-4">3.8.3</span> Imputing the NA values in the training dataset</h4>
<div class="outline-text-4" id="text-3-8-3">
<p>
Lets research about the NA values and their impact in the ML road map
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Summary of the original training data set:"</span>)
summary(eBayDS)
</pre>
</div>

<pre class="example">
:: Summary of the original training data set:
description           biddable        startprice
Length:1861        Min.   :0.0000   Min.   :  0.01
Class :character   1st Qu.:0.0000   1st Qu.: 80.00
Mode  :character   Median :0.0000   Median :179.99
                   Mean   :0.4498   Mean   :211.18
                   3rd Qu.:1.0000   3rd Qu.:300.00
                   Max.   :1.0000   Max.   :999.00

                   condition       cellular          carrier
For parts or not working: 181   Min.   :0.0000   AT&amp;T    : 206
Manufacturer refurbished:  39   1st Qu.:0.0000   None    :1111
New                     : 289   Median :0.0000   Other   :   3
New other (see details) :  85   Mean   :0.3196   Sprint  :  30
Seller refurbished      : 109   3rd Qu.:1.0000   T-Mobile:  19
Used                    :1158   Max.   :1.0000   Unknown : 348
                                NA's   :234      Verizon : 144
       color        storage        productline       sold
Black     :425   128    : 90   iPad 2    :286   Min.   :0.0000
Gold      : 77   16     :934   iPad mini :277   1st Qu.:0.0000
Space Gray:202   32     :340   iPad 1    :227   Median :0.0000
Unknown   :708   64     :314   Unknown   :204   Mean   :0.4621
White     :449   Unknown:183   iPad Air  :180   3rd Qu.:1.0000
                               iPad Air 2:171   Max.   :1.0000
                               (Other)   :516
   UniqueID
Min.   :10001
1st Qu.:10466
Median :10931
Mean   :10931
3rd Qu.:11396
Max.   :11861
</pre>

<p>
The exist NA values have some serious problems in the CSV generation.
</p>

<p>
We can work with some imputation algorithms in order to substitute the
NA values.
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Multiple imputation"</span>)
eBaySimple <span style="color: #db7093;">&lt;-</span> eBayDS[c(<span style="color: #ff6a6a;">"UniqueID"</span>, <span style="color: #ff6a6a;">"biddable"</span>, <span style="color: #ff6a6a;">"startprice"</span>,
                       <span style="color: #ff6a6a;">"condition"</span>, <span style="color: #ff6a6a;">"cellular"</span>, <span style="color: #ff6a6a;">"storage"</span>,
                       <span style="color: #ff6a6a;">"productline"</span>)]
summary(eBaySimple)
</pre>
</div>

<pre class="example">
:: Multiple imputation
   UniqueID        biddable        startprice
Min.   :10001   Min.   :0.0000   Min.   :  0.01
1st Qu.:10466   1st Qu.:0.0000   1st Qu.: 80.00
Median :10931   Median :0.0000   Median :179.99
Mean   :10931   Mean   :0.4498   Mean   :211.18
3rd Qu.:11396   3rd Qu.:1.0000   3rd Qu.:300.00
Max.   :11861   Max.   :1.0000   Max.   :999.00

                   condition       cellular         storage
For parts or not working: 181   Min.   :0.0000   128    : 90
Manufacturer refurbished:  39   1st Qu.:0.0000   16     :934
New                     : 289   Median :0.0000   32     :340
New other (see details) :  85   Mean   :0.3196   64     :314
Seller refurbished      : 109   3rd Qu.:1.0000   Unknown:183
Used                    :1158   Max.   :1.0000
                                NA's   :234
    productline
iPad 2    :286
iPad mini :277
iPad 1    :227
Unknown   :204
iPad Air  :180
iPad Air 2:171
(Other)   :516
</pre>

<p>
Lets impute the data in order to have a better response.
</p>

<div class="org-src-container">

<pre class="src src-R">set.seed(pi)
imputed <span style="color: #db7093;">&lt;-</span> complete(mice(eBaySimple))
summary(imputed)
</pre>
</div>

<pre class="example">
iter imp variable
 1   1  cellular
 1   2  cellular
 1   3  cellular
 1   4  cellular
 1   5  cellular
 2   1  cellular
 2   2  cellular
 2   3  cellular
 2   4  cellular
 2   5  cellular
 3   1  cellular
 3   2  cellular
 3   3  cellular
 3   4  cellular
 3   5  cellular
 4   1  cellular
 4   2  cellular
 4   3  cellular
 4   4  cellular
 4   5  cellular
 5   1  cellular
 5   2  cellular
 5   3  cellular
 5   4  cellular
 5   5  cellular
   UniqueID        biddable        startprice
Min.   :10001   Min.   :0.0000   Min.   :  0.01
1st Qu.:10466   1st Qu.:0.0000   1st Qu.: 80.00
Median :10931   Median :0.0000   Median :179.99
Mean   :10931   Mean   :0.4498   Mean   :211.18
3rd Qu.:11396   3rd Qu.:1.0000   3rd Qu.:300.00
Max.   :11861   Max.   :1.0000   Max.   :999.00

                   condition       cellular         storage
For parts or not working: 181   Min.   :0.0000   128    : 90
Manufacturer refurbished:  39   1st Qu.:0.0000   16     :934
New                     : 289   Median :0.0000   32     :340
New other (see details) :  85   Mean   :0.3052   64     :314
Seller refurbished      : 109   3rd Qu.:1.0000   Unknown:183
Used                    :1158   Max.   :1.0000

    productline
iPad 2    :286
iPad mini :277
iPad 1    :227
Unknown   :204
iPad Air  :180
iPad Air 2:171
(Other)   :516
</pre>

<p>
Lets substitute the imputed values in the original dataframe
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Substitute the original values of storage with the imputed values:"</span>)
eBayDS$storage <span style="color: #db7093;">&lt;-</span> imputed$storage
eBayDS$cellular <span style="color: #db7093;">&lt;-</span> imputed$cellular
summary(eBayDS)
</pre>
</div>

<pre class="example">
:: Substitute the original values of storage with the imputed values:
description           biddable        startprice
Length:1861        Min.   :0.0000   Min.   :  0.01
Class :character   1st Qu.:0.0000   1st Qu.: 80.00
Mode  :character   Median :0.0000   Median :179.99
                   Mean   :0.4498   Mean   :211.18
                   3rd Qu.:1.0000   3rd Qu.:300.00
                   Max.   :1.0000   Max.   :999.00

                   condition       cellular          carrier
For parts or not working: 181   Min.   :0.0000   AT&amp;T    : 206
Manufacturer refurbished:  39   1st Qu.:0.0000   None    :1111
New                     : 289   Median :0.0000   Other   :   3
New other (see details) :  85   Mean   :0.3052   Sprint  :  30
Seller refurbished      : 109   3rd Qu.:1.0000   T-Mobile:  19
Used                    :1158   Max.   :1.0000   Unknown : 348
                                                 Verizon : 144
       color        storage        productline       sold
Black     :425   128    : 90   iPad 2    :286   Min.   :0.0000
Gold      : 77   16     :934   iPad mini :277   1st Qu.:0.0000
Space Gray:202   32     :340   iPad 1    :227   Median :0.0000
Unknown   :708   64     :314   Unknown   :204   Mean   :0.4621
White     :449   Unknown:183   iPad Air  :180   3rd Qu.:1.0000
                               iPad Air 2:171   Max.   :1.0000
                               (Other)   :516
   UniqueID
Min.   :10001
1st Qu.:10466
Median :10931
Mean   :10931
3rd Qu.:11396
Max.   :11861
</pre>
</div>
</div>

<div id="outline-container-sec-3-8-4" class="outline-4">
<h4 id="sec-3-8-4"><span class="section-number-4">3.8.4</span> Imputing the NA values in the validation dataset</h4>
<div class="outline-text-4" id="text-3-8-4">
<p>
Lets create a dataframe with the factor/character features
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Multiple imputation"</span>)
eBaySimple <span style="color: #db7093;">&lt;-</span> eBayValidation[c(<span style="color: #ff6a6a;">"UniqueID"</span>, <span style="color: #ff6a6a;">"biddable"</span>, <span style="color: #ff6a6a;">"startprice"</span>,
                       <span style="color: #ff6a6a;">"condition"</span>, <span style="color: #ff6a6a;">"cellular"</span>, <span style="color: #ff6a6a;">"storage"</span>,
                       <span style="color: #ff6a6a;">"productline"</span>)]
summary(eBaySimple)
</pre>
</div>

<pre class="example">
:: Multiple imputation
   UniqueID        biddable        startprice
Min.   :11862   Min.   :0.0000   Min.   :   0.01
1st Qu.:12061   1st Qu.:0.0000   1st Qu.:  89.24
Median :12260   Median :0.0000   Median : 179.00
Mean   :12260   Mean   :0.4712   Mean   : 208.64
3rd Qu.:12460   3rd Qu.:1.0000   3rd Qu.: 289.00
Max.   :12659   Max.   :1.0000   Max.   : 999.99

                   condition      cellular         storage       productline
For parts or not working: 83   Min.   :0.0000   128    : 38   iPad 2   :154
Manufacturer refurbished: 16   1st Qu.:0.0000   16     :394   iPad mini:111
New                     :113   Median :0.0000   32     :138   Unknown  : 92
New other (see details) : 43   Mean   :0.2938   64     :147   iPad 1   : 88
Seller refurbished      : 52   3rd Qu.:1.0000   Unknown: 81   iPad Air : 74
Used                    :491   Max.   :1.0000                 iPad 4   : 68
                               NA's   :107                    (Other)  :211
</pre>

<p>
Lets impute the data in order to have a better response.
</p>

<div class="org-src-container">

<pre class="src src-R">set.seed(pi)
imputed <span style="color: #db7093;">&lt;-</span> complete(mice(eBaySimple))
summary(imputed)
</pre>
</div>

<pre class="example">
iter imp variable
 1   1  cellular
 1   2  cellular
 1   3  cellular
 1   4  cellular
 1   5  cellular
 2   1  cellular
 2   2  cellular
 2   3  cellular
 2   4  cellular
 2   5  cellular
 3   1  cellular
 3   2  cellular
 3   3  cellular
 3   4  cellular
 3   5  cellular
 4   1  cellular
 4   2  cellular
 4   3  cellular
 4   4  cellular
 4   5  cellular
 5   1  cellular
 5   2  cellular
 5   3  cellular
 5   4  cellular
 5   5  cellular
   UniqueID        biddable        startprice
Min.   :11862   Min.   :0.0000   Min.   :   0.01
1st Qu.:12061   1st Qu.:0.0000   1st Qu.:  89.24
Median :12260   Median :0.0000   Median : 179.00
Mean   :12260   Mean   :0.4712   Mean   : 208.64
3rd Qu.:12460   3rd Qu.:1.0000   3rd Qu.: 289.00
Max.   :12659   Max.   :1.0000   Max.   : 999.99

                   condition      cellular         storage       productline
For parts or not working: 83   Min.   :0.0000   128    : 38   iPad 2   :154
Manufacturer refurbished: 16   1st Qu.:0.0000   16     :394   iPad mini:111
New                     :113   Median :0.0000   32     :138   Unknown  : 92
New other (see details) : 43   Mean   :0.2895   64     :147   iPad 1   : 88
Seller refurbished      : 52   3rd Qu.:1.0000   Unknown: 81   iPad Air : 74
Used                    :491   Max.   :1.0000                 iPad 4   : 68
                                                              (Other)  :211
</pre>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Substitute the original values of storage with the imputed values:"</span>)
eBayValidation$storage <span style="color: #db7093;">&lt;-</span> imputed$storage
eBayValidation$cellular <span style="color: #db7093;">&lt;-</span> imputed$cellular
summary(eBayValidation)
</pre>
</div>

<pre class="example">
:: Substitute the original values of storage with the imputed values:
description           biddable        startprice
Length:798         Min.   :0.0000   Min.   :   0.01
Class :character   1st Qu.:0.0000   1st Qu.:  89.24
Mode  :character   Median :0.0000   Median : 179.00
                   Mean   :0.4712   Mean   : 208.64
                   3rd Qu.:1.0000   3rd Qu.: 289.00
                   Max.   :1.0000   Max.   : 999.99

                   condition      cellular          carrier
For parts or not working: 83   Min.   :0.0000   AT&amp;T    : 86
Manufacturer refurbished: 16   1st Qu.:0.0000   None    :488
New                     :113   Median :0.0000   Other   :  3
New other (see details) : 43   Mean   :0.2895   Sprint  :  6
Seller refurbished      : 52   3rd Qu.:1.0000   T-Mobile:  8
Used                    :491   Max.   :1.0000   Unknown :155
                                                Verizon : 52
       color        storage       productline     UniqueID
Black     :173   128    : 38   iPad 2   :154   Min.   :11862
Gold      : 33   16     :394   iPad mini:111   1st Qu.:12061
Space Gray: 83   32     :138   Unknown  : 92   Median :12260
Unknown   :323   64     :147   iPad 1   : 88   Mean   :12260
White     :186   Unknown: 81   iPad Air : 74   3rd Qu.:12460
                               iPad 4   : 68   Max.   :12659
                               (Other)  :211
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-9" class="outline-3">
<h3 id="sec-3-9"><span class="section-number-3">3.9</span> Understanding each type and distribution of the data</h3>
<div class="outline-text-3" id="text-3-9">
<p>
In this part we will research about the data and the interactions
between it.
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Summary of the data:"</span>)
summary(eBayDS)
</pre>
</div>

<pre class="example">
:: Summary of the data:
description           biddable        startprice
Length:1861        Min.   :0.0000   Min.   :  0.01
Class :character   1st Qu.:0.0000   1st Qu.: 80.00
Mode  :character   Median :0.0000   Median :179.99
                   Mean   :0.4498   Mean   :211.18
                   3rd Qu.:1.0000   3rd Qu.:300.00
                   Max.   :1.0000   Max.   :999.00

                   condition       cellular          carrier
For parts or not working: 181   Min.   :0.0000   AT&amp;T    : 206
Manufacturer refurbished:  39   1st Qu.:0.0000   None    :1111
New                     : 289   Median :0.0000   Other   :   3
New other (see details) :  85   Mean   :0.3052   Sprint  :  30
Seller refurbished      : 109   3rd Qu.:1.0000   T-Mobile:  19
Used                    :1158   Max.   :1.0000   Unknown : 348
                                                 Verizon : 144
       color        storage        productline       sold
Black     :425   128    : 90   iPad 2    :286   Min.   :0.0000
Gold      : 77   16     :934   iPad mini :277   1st Qu.:0.0000
Space Gray:202   32     :340   iPad 1    :227   Median :0.0000
Unknown   :708   64     :314   Unknown   :204   Mean   :0.4621
White     :449   Unknown:183   iPad Air  :180   3rd Qu.:1.0000
                               iPad Air 2:171   Max.   :1.0000
                               (Other)   :516
   UniqueID
Min.   :10001
1st Qu.:10466
Median :10931
Mean   :10931
3rd Qu.:11396
Max.   :11861
</pre>
</div>

<div id="outline-container-sec-3-9-1" class="outline-4">
<h4 id="sec-3-9-1"><span class="section-number-4">3.9.1</span> Summaries of the probable factor variables</h4>
<div class="outline-text-4" id="text-3-9-1">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: The condition feature summary:"</span>)
table(eBayDS$condition)

writeLines(<span style="color: #ff6a6a;">"\n :: Any NA values:"</span>)
anyNA(eBayDS$condition)

writeLines(<span style="color: #ff6a6a;">"\n :: The carrier feature supplier summary:"</span>)
table(eBayDS$carrier)

writeLines(<span style="color: #ff6a6a;">"\n :: Any NA values:"</span>)
anyNA(eBayDS$carrier)

writeLines(<span style="color: #ff6a6a;">"\n :: The color of iPads:"</span>)
table(eBayDS$color)

writeLines(<span style="color: #ff6a6a;">"\n :: Any NA values:"</span>)
anyNA(eBayDS$color)

writeLines(<span style="color: #ff6a6a;">"\n :: The product line:"</span>)
table(eBayDS$productline)

writeLines(<span style="color: #ff6a6a;">"\n :: Any NA values:"</span>)
anyNA(eBayDS$productline)
</pre>
</div>

<pre class="example">
 :: The condition feature summary:

For parts or not working Manufacturer refurbished                      New
                     181                       39                      289
 New other (see details)       Seller refurbished                     Used
                      85                      109                     1158

 :: Any NA values:
[1] FALSE

 :: The carrier feature supplier summary:

    AT&amp;T     None    Other   Sprint T-Mobile  Unknown  Verizon
     206     1111        3       30       19      348      144

 :: Any NA values:
[1] FALSE

 :: The color of iPads:

     Black       Gold Space Gray    Unknown      White
       425         77        202        708        449

 :: Any NA values:
[1] FALSE

 :: The product line:

          iPad 1           iPad 2           iPad 3           iPad 4
             227              286              153              157
          iPad 5         iPad Air       iPad Air 2        iPad mini
               1              180              171              277
     iPad mini 2      iPad mini 3 iPad mini Retina          Unknown
             107               90                8              204

 :: Any NA values:
[1] FALSE
</pre>
</div>
</div>

<div id="outline-container-sec-3-9-2" class="outline-4">
<h4 id="sec-3-9-2"><span class="section-number-4">3.9.2</span> Correlation between variables</h4>
<div class="outline-text-4" id="text-3-9-2">

<div id="fig:eBayFeaturePlot" class="figure">
<p><img src="../graphs/eBayFeaturePlot.png" alt="eBayFeaturePlot.png" />
</p>
<p><span class="figure-number">Figure 2:</span> eBay feature plot</p>
</div>

<p>
For the selected features we can try to understand the behavior vs the
<code>sold</code> feature.
</p>


<div id="fig:eBaySoldVsBiddableCor" class="figure">
<p><img src="../graphs/eBaySoldVsBiddableCor.png" alt="eBaySoldVsBiddableCor.png" />
</p>
<p><span class="figure-number">Figure 3:</span> Correlation between the sold and biddable features</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-9-3" class="outline-4">
<h4 id="sec-3-9-3"><span class="section-number-4">3.9.3</span> What type of deal (auction) is better sold?</h4>
<div class="outline-text-4" id="text-3-9-3">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Is an auction a better deal for customers?"</span>)
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">biddable as rows and sold as columns</span>
m <span style="color: #db7093;">&lt;-</span> table(eBayDS$biddable, eBayDS$sold)
m

writeLines(<span style="color: #ff6a6a;">"\n :: The proportion of auctions sold:"</span>)
m[2, 2] / (m[1, 2] + m[2, 2])
</pre>
</div>

<pre class="example">
 :: Is an auction a better deal for customers?

      0   1
  0 804 220
  1 197 640

 :: The proportion of auctions sold:
[1] 0.744186
</pre>

<p>
We understand that the auctions have a proportion of \(74.4\%\) of
<b>success in sales</b>.
</p>
</div>
</div>

<div id="outline-container-sec-3-9-4" class="outline-4">
<h4 id="sec-3-9-4"><span class="section-number-4">3.9.4</span> What is the sold products vs condition?</h4>
<div class="outline-text-4" id="text-3-9-4">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: The condiction of the product vs. the sold outcome:"</span>)
table(eBayDS$condition, eBayDS$sold)
</pre>
</div>

<pre class="example">
:: The condiction of the product vs. the sold outcome:

                            0   1
 For parts or not working  75 106
 Manufacturer refurbished  25  14
 New                      204  85
 New other (see details)   51  34
 Seller refurbished        74  35
 Used                     572 586
</pre>

<p>
The most sold product by condition is <b>used</b>. Now if we can see what is
the proportion of used products as an auction.
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Proportion of used vs auction:"</span>)
table(eBayDS$condition, eBayDS$biddable)
</pre>
</div>

<pre class="example">
:: Proportion of used vs auction:

                            0   1
 For parts or not working  75 106
 Manufacturer refurbished  29  10
 New                      206  83
 New other (see details)   55  30
 Seller refurbished        77  32
 Used                     582 576
</pre>

<p>
We can see that the people prefer to sell their products with an fixed
<b>expected price</b>. Besides, all the used offers as auctions was <b>sold</b>,
and <b>only 10 non auction offers was sold</b>.
</p>
</div>
</div>

<div id="outline-container-sec-3-9-5" class="outline-4">
<h4 id="sec-3-9-5"><span class="section-number-4">3.9.5</span> Is the cellular feature important for the customer?</h4>
<div class="outline-text-4" id="text-3-9-5">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Cellular feature vs. the sold outcome:"</span>)
m <span style="color: #db7093;">&lt;-</span> table(eBayDS$cellular, eBayDS$sold)
m

writeLines(<span style="color: #ff6a6a;">"\n :: The proportion of products with cellular feature sold is:"</span>)
m[2, 2] / (m[2, 1] + m[2, 2])
</pre>
</div>

<pre class="example">
 :: Cellular feature vs. the sold outcome:

      0   1
  0 675 618
  1 326 242

 :: The proportion of products with cellular feature sold is:
[1] 0.4260563
</pre>

<p>
This result said us that the <b>cellular feature it is NOT the most
important</b> feature for customers.
</p>
</div>
</div>

<div id="outline-container-sec-3-9-6" class="outline-4">
<h4 id="sec-3-9-6"><span class="section-number-4">3.9.6</span> Is the color important for the customer?</h4>
<div class="outline-text-4" id="text-3-9-6">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: How much is the importance of the color?"</span>)
table(eBayDS$color, eBayDS$sold)
</pre>
</div>

<pre class="example">
:: How much is the importance of the color?

              0   1
 Black      205 220
 Gold        55  22
 Space Gray 111  91
 Unknown    375 333
 White      255 194
</pre>

<p>
The vast majority prefer products in <b>black and white or don't care</b>.
</p>
</div>
</div>

<div id="outline-container-sec-3-9-7" class="outline-4">
<h4 id="sec-3-9-7"><span class="section-number-4">3.9.7</span> Is the capacity an important feature to buy?</h4>
<div class="outline-text-4" id="text-3-9-7">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Storage capacity vs. sold:"</span>)
m <span style="color: #db7093;">&lt;-</span> table(eBayDS$storage, eBayDS$sold)
m

writeLines(<span style="color: #ff6a6a;">"\n :: The proportion of 16GB storage sold:"</span>)
m[2, 2] / (m[1, 2] + m[2, 2] + m[3, 2] + m [4, 2])
</pre>
</div>

<pre class="example">
 :: Storage capacity vs. sold:

            0   1
  128      68  22
  16      473 461
  32      183 157
  64      167 147
  Unknown 110  73

 :: The proportion of 16GB storage sold:
[1] 0.5857687
</pre>

<p>
<b>The majority of people has bought their equipment with 16GB of ram</b>.
</p>
</div>
</div>

<div id="outline-container-sec-3-9-8" class="outline-4">
<h4 id="sec-3-9-8"><span class="section-number-4">3.9.8</span> What is the most sold product?</h4>
<div class="outline-text-4" id="text-3-9-8">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Products sold:"</span>)
table(eBayDS$productline, eBayDS$sold)
</pre>
</div>

<pre class="example">
:: Products sold:

                    0   1
 iPad 1           102 125
 iPad 2           139 147
 iPad 3            73  80
 iPad 4            93  64
 iPad 5             0   1
 iPad Air         102  78
 iPad Air 2       100  71
 iPad mini        145 132
 iPad mini 2       58  49
 iPad mini 3       63  27
 iPad mini Retina   4   4
 Unknown          122  82
</pre>

<p>
The best sold product is the <b>iPad 2</b>.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-3-10" class="outline-3">
<h3 id="sec-3-10"><span class="section-number-3">3.10</span> The dummy variable creation</h3>
<div class="outline-text-3" id="text-3-10">
<p>
Lets convert the factor/character variables to dummy variables
</p>
</div>

<div id="outline-container-sec-3-10-1" class="outline-4">
<h4 id="sec-3-10-1"><span class="section-number-4">3.10.1</span> Dummy variables creation for the testing dataset</h4>
<div class="outline-text-4" id="text-3-10-1">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Dummy variables for factors/characters..."</span>)

eBayDS2 <span style="color: #db7093;">&lt;-</span> eBayDS[, -1]
eBayDummy <span style="color: #db7093;">&lt;-</span> dummyVars(<span style="color: #ff6a6a;">"~."</span>, data = eBayDS2, fullRank = F)
eBayDS2 <span style="color: #db7093;">&lt;-</span> as.data.frame(predict(eBayDummy, eBayDS))
print(names(eBayDS2))

writeLines(<span style="color: #ff6a6a;">"\n :: Re-work the feature names:"</span>)
 names(eBayDS2) <span style="color: #db7093;">&lt;-</span> c(<span style="color: #ff6a6a;">"biddable"</span>, <span style="color: #ff6a6a;">"startprice"</span>,
 <span style="color: #ff6a6a;">"condition.For.parts.or.not.working"</span>,
 <span style="color: #ff6a6a;">"condition.Manufacturer.refurbished"</span>, <span style="color: #ff6a6a;">"condition.New"</span>,
 <span style="color: #ff6a6a;">"condition.New.other.see.details"</span>, <span style="color: #ff6a6a;">"condition.Seller.refurbished"</span>,
 <span style="color: #ff6a6a;">"condition.Used"</span>, <span style="color: #ff6a6a;">"cellular"</span>, <span style="color: #ff6a6a;">"carrier.ATT"</span>, <span style="color: #ff6a6a;">"carrier.None"</span>,
 <span style="color: #ff6a6a;">"carrier.Other"</span>, <span style="color: #ff6a6a;">"carrier.Sprint"</span>, <span style="color: #ff6a6a;">"carrier.T-Mobile"</span>,
 <span style="color: #ff6a6a;">"carrier.Unknown"</span>, <span style="color: #ff6a6a;">"carrier.Verizon"</span>, <span style="color: #ff6a6a;">"color.Black"</span>, <span style="color: #ff6a6a;">"color.Gold"</span>,
 <span style="color: #ff6a6a;">"color.Space.Gray"</span>, <span style="color: #ff6a6a;">"color.Unknown"</span>, <span style="color: #ff6a6a;">"color.White"</span>, <span style="color: #ff6a6a;">"storage.2"</span>,
 <span style="color: #ff6a6a;">"storage.3"</span>, <span style="color: #ff6a6a;">"storage.4"</span>, <span style="color: #ff6a6a;">"storage.5"</span>, <span style="color: #ff6a6a;">"productline.iPad.1"</span>,
 <span style="color: #ff6a6a;">"productline.iPad.2"</span>, <span style="color: #ff6a6a;">"productline.iPad.3"</span>, <span style="color: #ff6a6a;">"productline.iPad.4"</span>,
 <span style="color: #ff6a6a;">"productline.iPad.5"</span>, <span style="color: #ff6a6a;">"productline.iPad.Air"</span>,
 <span style="color: #ff6a6a;">"productline.iPad.Air.2"</span>, <span style="color: #ff6a6a;">"productline.iPad.mini"</span>,
 <span style="color: #ff6a6a;">"productline.iPad.mini.2"</span>, <span style="color: #ff6a6a;">"productline.iPad.mini.3"</span>,
 <span style="color: #ff6a6a;">"productline.iPad.mini.Retina"</span>, <span style="color: #ff6a6a;">"productline.Unknown"</span>, <span style="color: #ff6a6a;">"sold"</span>,
 <span style="color: #ff6a6a;">'UniqueID'</span>)

print(names(eBayDS2))
</pre>
</div>

<pre class="example">
 :: Dummy variables for factors/characters...
 [1] "biddable"                           "startprice"
 [3] "condition.For parts or not working" "condition.Manufacturer refurbished"
 [5] "condition.New"                      "condition.New other (see details)"
 [7] "condition.Seller refurbished"       "condition.Used"
 [9] "cellular"                           "carrier.AT&amp;T"
[11] "carrier.None"                       "carrier.Other"
[13] "carrier.Sprint"                     "carrier.T-Mobile"
[15] "carrier.Unknown"                    "carrier.Verizon"
[17] "color.Black"                        "color.Gold"
[19] "color.Space Gray"                   "color.Unknown"
[21] "color.White"                        "storage.2"
[23] "storage.3"                          "storage.4"
[25] "storage.5"                          "productline.iPad 1"
[27] "productline.iPad 2"                 "productline.iPad 3"
[29] "productline.iPad 4"                 "productline.iPad 5"
[31] "productline.iPad Air"               "productline.iPad Air 2"
[33] "productline.iPad mini"              "productline.iPad mini 2"
[35] "productline.iPad mini 3"            "productline.iPad mini Retina"
[37] "productline.Unknown"                "sold"
[39] "UniqueID"

 :: Re-work the feature names:
 [1] "biddable"                           "startprice"
 [3] "condition.For.parts.or.not.working" "condition.Manufacturer.refurbished"
 [5] "condition.New"                      "condition.New.other.see.details"
 [7] "condition.Seller.refurbished"       "condition.Used"
 [9] "cellular"                           "carrier.ATT"
[11] "carrier.None"                       "carrier.Other"
[13] "carrier.Sprint"                     "carrier.T-Mobile"
[15] "carrier.Unknown"                    "carrier.Verizon"
[17] "color.Black"                        "color.Gold"
[19] "color.Space.Gray"                   "color.Unknown"
[21] "color.White"                        "storage.2"
[23] "storage.3"                          "storage.4"
[25] "storage.5"                          "productline.iPad.1"
[27] "productline.iPad.2"                 "productline.iPad.3"
[29] "productline.iPad.4"                 "productline.iPad.5"
[31] "productline.iPad.Air"               "productline.iPad.Air.2"
[33] "productline.iPad.mini"              "productline.iPad.mini.2"
[35] "productline.iPad.mini.3"            "productline.iPad.mini.Retina"
[37] "productline.Unknown"                "sold"
[39] "UniqueID"
</pre>
</div>
</div>

<div id="outline-container-sec-3-10-2" class="outline-4">
<h4 id="sec-3-10-2"><span class="section-number-4">3.10.2</span> Dummy variables creation for the validation dataset</h4>
<div class="outline-text-4" id="text-3-10-2">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Dummy variables for factors/characters..."</span>)

eBayValidation2 <span style="color: #db7093;">&lt;-</span> eBayValidation[, -1]
eBayDummy <span style="color: #db7093;">&lt;-</span> dummyVars(<span style="color: #ff6a6a;">"~."</span>, data = eBayValidation2, fullRank = F)
eBayValidation2 <span style="color: #db7093;">&lt;-</span> as.data.frame(predict(eBayDummy, eBayValidation))
print(names(eBayValidation2))

writeLines(<span style="color: #ff6a6a;">"\n :: Re-work the feature names:"</span>)
 names(eBayValidation2) <span style="color: #db7093;">&lt;-</span> c(<span style="color: #ff6a6a;">"biddable"</span>, <span style="color: #ff6a6a;">"startprice"</span>,
 <span style="color: #ff6a6a;">"condition.For.parts.or.not.working"</span>,
 <span style="color: #ff6a6a;">"condition.Manufacturer.refurbished"</span>, <span style="color: #ff6a6a;">"condition.New"</span>,
 <span style="color: #ff6a6a;">"condition.New.other.see.details"</span>, <span style="color: #ff6a6a;">"condition.Seller.refurbished"</span>,
 <span style="color: #ff6a6a;">"condition.Used"</span>, <span style="color: #ff6a6a;">"cellular"</span>, <span style="color: #ff6a6a;">"carrier.ATT"</span>, <span style="color: #ff6a6a;">"carrier.None"</span>,
 <span style="color: #ff6a6a;">"carrier.Other"</span>, <span style="color: #ff6a6a;">"carrier.Sprint"</span>, <span style="color: #ff6a6a;">"carrier.T-Mobile"</span>,
 <span style="color: #ff6a6a;">"carrier.Unknown"</span>, <span style="color: #ff6a6a;">"carrier.Verizon"</span>, <span style="color: #ff6a6a;">"color.Black"</span>, <span style="color: #ff6a6a;">"color.Gold"</span>,
 <span style="color: #ff6a6a;">"color.Space.Gray"</span>, <span style="color: #ff6a6a;">"color.Unknown"</span>, <span style="color: #ff6a6a;">"color.White"</span>, <span style="color: #ff6a6a;">"storage.2"</span>,
 <span style="color: #ff6a6a;">"storage.3"</span>, <span style="color: #ff6a6a;">"storage.4"</span>, <span style="color: #ff6a6a;">"storage.5"</span>, <span style="color: #ff6a6a;">"productline.iPad.1"</span>,
 <span style="color: #ff6a6a;">"productline.iPad.2"</span>, <span style="color: #ff6a6a;">"productline.iPad.3"</span>, <span style="color: #ff6a6a;">"productline.iPad.4"</span>,
 <span style="color: #ff6a6a;">"productline.iPad.Air"</span>,
 <span style="color: #ff6a6a;">"productline.iPad.Air.2"</span>, <span style="color: #ff6a6a;">"productline.iPad.mini"</span>,
 <span style="color: #ff6a6a;">"productline.iPad.mini.2"</span>, <span style="color: #ff6a6a;">"productline.iPad.mini.3"</span>,
 <span style="color: #ff6a6a;">"productline.Unknown"</span>, <span style="color: #ff6a6a;">"UniqueID"</span>)

print(names(eBayValidation2))
</pre>
</div>

<pre class="example">
 :: Dummy variables for factors/characters...
 [1] "biddable"                           "startprice"
 [3] "condition.For parts or not working" "condition.Manufacturer refurbished"
 [5] "condition.New"                      "condition.New other (see details)"
 [7] "condition.Seller refurbished"       "condition.Used"
 [9] "cellular"                           "carrier.AT&amp;T"
[11] "carrier.None"                       "carrier.Other"
[13] "carrier.Sprint"                     "carrier.T-Mobile"
[15] "carrier.Unknown"                    "carrier.Verizon"
[17] "color.Black"                        "color.Gold"
[19] "color.Space Gray"                   "color.Unknown"
[21] "color.White"                        "storage.2"
[23] "storage.3"                          "storage.4"
[25] "storage.5"                          "productline.iPad 1"
[27] "productline.iPad 2"                 "productline.iPad 3"
[29] "productline.iPad 4"                 "productline.iPad Air"
[31] "productline.iPad Air 2"             "productline.iPad mini"
[33] "productline.iPad mini 2"            "productline.iPad mini 3"
[35] "productline.Unknown"                "UniqueID"

 :: Re-work the feature names:
 [1] "biddable"                           "startprice"
 [3] "condition.For.parts.or.not.working" "condition.Manufacturer.refurbished"
 [5] "condition.New"                      "condition.New.other.see.details"
 [7] "condition.Seller.refurbished"       "condition.Used"
 [9] "cellular"                           "carrier.ATT"
[11] "carrier.None"                       "carrier.Other"
[13] "carrier.Sprint"                     "carrier.T-Mobile"
[15] "carrier.Unknown"                    "carrier.Verizon"
[17] "color.Black"                        "color.Gold"
[19] "color.Space.Gray"                   "color.Unknown"
[21] "color.White"                        "storage.2"
[23] "storage.3"                          "storage.4"
[25] "storage.5"                          "productline.iPad.1"
[27] "productline.iPad.2"                 "productline.iPad.3"
[29] "productline.iPad.4"                 "productline.iPad.Air"
[31] "productline.iPad.Air.2"             "productline.iPad.mini"
[33] "productline.iPad.mini.2"            "productline.iPad.mini.3"
[35] "productline.Unknown"                "UniqueID"
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-3-11" class="outline-3">
<h3 id="sec-3-11"><span class="section-number-3">3.11</span> Partitioning the data</h3>
<div class="outline-text-3" id="text-3-11">
<p>
<b>What are the right steps for the best model generation?</b>
</p>

<p>
The problem of the NA existence in the submission CSV file must be
addressed.
</p>

<p>
We need more information about the behavior and performance of the
models, then a reasonable decision is subdivide the training data set
in a new training data set plus a testing set
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Split the data:"</span>)
set.seed(pi)

spl <span style="color: #db7093;">&lt;-</span> sample.split(eBayDS2$sold, SplitRatio = 0.75)

eBayTrain <span style="color: #db7093;">&lt;-</span> subset(eBayDS2, spl == <span style="color: #3cb371;">TRUE</span>)
eBayTest <span style="color: #db7093;">&lt;-</span> subset(eBayDS2, spl == <span style="color: #3cb371;">FALSE</span>)

writeLines(<span style="color: #ff6a6a;">"\n :: Dimensions of the training set:"</span>)
dim(eBayTrain)

writeLines(<span style="color: #ff6a6a;">"\n :: Dimensions of the testing set:"</span>)
dim(eBayTest)
</pre>
</div>

<pre class="example">
 :: Split the data:

 :: Dimensions of the training set:
[1] 1396   39

 :: Dimensions of the testing set:
[1] 465  39
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4"><span class="section-number-2">4</span> Machine Learning Models</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1"><span class="section-number-3">4.1</span> Baseline model</h3>
<div class="outline-text-3" id="text-4-1">
<p>
We can plot the dependent variable <code>sold</code>, in order to know their
behavior.
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: The baseline model:"</span>)
table(eBayTrain$sold)

writeLines(<span style="color: #ff6a6a;">"\n :: The baseline model accuracy (NOT SOLD) is:"</span>)
table(eBayTrain$sold)[1] / (table(eBayTrain$sold)[1] + table(eBayTrain$sold)[2])
</pre>
</div>

<pre class="example">
 :: The baseline model:

  0   1
751 645

 :: The baseline model accuracy (NOT SOLD) is:
        0
0.5379656
</pre>
</div>
</div>

<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2"><span class="section-number-3">4.2</span> Logistic regression models</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Lets save some important variables in order to use it as arguments for
the modeling functions
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Generalize outcome and predictor variables..."</span>)
outcomeName <span style="color: #db7093;">&lt;-</span> <span style="color: #ff6a6a;">'sold'</span>
predictorsNames <span style="color: #db7093;">&lt;-</span> names(eBayDS2)[names(eBayDS2) != outcomeName]
predictorsNames
</pre>
</div>

<pre class="example">
 :: Generalize outcome and predictor variables...
 [1] "biddable"                           "startprice"
 [3] "condition.For.parts.or.not.working" "condition.Manufacturer.refurbished"
 [5] "condition.New"                      "condition.New.other.see.details"
 [7] "condition.Seller.refurbished"       "condition.Used"
 [9] "cellular"                           "carrier.ATT"
[11] "carrier.None"                       "carrier.Other"
[13] "carrier.Sprint"                     "carrier.T-Mobile"
[15] "carrier.Unknown"                    "carrier.Verizon"
[17] "color.Black"                        "color.Gold"
[19] "color.Space.Gray"                   "color.Unknown"
[21] "color.White"                        "storage.2"
[23] "storage.3"                          "storage.4"
[25] "storage.5"                          "productline.iPad.1"
[27] "productline.iPad.2"                 "productline.iPad.3"
[29] "productline.iPad.4"                 "productline.iPad.5"
[31] "productline.iPad.Air"               "productline.iPad.Air.2"
[33] "productline.iPad.mini"              "productline.iPad.mini.2"
[35] "productline.iPad.mini.3"            "productline.iPad.mini.Retina"
[37] "productline.Unknown"                "UniqueID"
</pre>
</div>

<div id="outline-container-sec-4-2-1" class="outline-4">
<h4 id="sec-4-2-1"><span class="section-number-4">4.2.1</span> Logistic Regression model 4</h4>
<div class="outline-text-4" id="text-4-2-1">
<p>
The first logistic regression model
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Create a logistic regression model to predict sold using</span>
<span style="color: #ff6a6a;">all the independent variables:"</span>)

eBayLR4 <span style="color: #db7093;">&lt;-</span> glm(sold ~ ., data = eBayTrain, family = binomial)

writeLines(<span style="color: #ff6a6a;">"\n :: Summary of the Logistic Regression model 4:"</span>)
summary(eBayLR4)
</pre>
</div>

<pre class="example">
 :: Create a logistic regression model to predict sold using
all the independent variables:

 :: Summary of the Logistic Regression model 4:

Call:
glm(formula = sold ~ ., family = binomial, data = eBayTrain)

Deviance Residuals:
    Min       1Q   Median       3Q      Max
-2.3187  -0.7262  -0.2335   0.6107   3.1353

Coefficients: (4 not defined because of singularities)
                                     Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                         7.897e+00  1.906e+00   4.144 3.42e-05 ***
biddable                            1.490e+00  1.621e-01   9.197  &lt; 2e-16 ***
startprice                         -1.154e-02  1.116e-03 -10.342  &lt; 2e-16 ***
condition.For.parts.or.not.working -2.068e-01  2.935e-01  -0.705 0.481042
condition.Manufacturer.refurbished  7.921e-01  4.927e-01   1.608 0.107876
condition.New                       3.294e-01  2.634e-01   1.251 0.211009
condition.New.other.see.details     5.566e-01  3.808e-01   1.462 0.143820
condition.Seller.refurbished       -4.499e-01  3.236e-01  -1.390 0.164422
condition.Used                             NA         NA      NA       NA
cellular                           -2.223e-01  3.890e-01  -0.571 0.567677
carrier.ATT                        -3.166e-01  3.541e-01  -0.894 0.371281
carrier.None                       -3.243e-01  4.789e-01  -0.677 0.498292
carrier.Other                       1.263e+01  6.028e+02   0.021 0.983281
carrier.Sprint                      5.982e-01  6.623e-01   0.903 0.366427
`carrier.T-Mobile`                 -1.353e+00  8.602e-01  -1.573 0.115637
carrier.Unknown                    -4.972e-01  3.953e-01  -1.258 0.208491
carrier.Verizon                            NA         NA      NA       NA
color.Black                         1.645e-01  2.166e-01   0.759 0.447657
color.Gold                         -5.760e-01  5.041e-01  -1.143 0.253133
color.Space.Gray                    4.491e-02  2.800e-01   0.160 0.872561
color.Unknown                       5.569e-03  1.956e-01   0.028 0.977289
color.White                                NA         NA      NA       NA
storage.2                          -1.341e+00  4.685e-01  -2.863 0.004196 **
storage.3                          -1.221e+00  4.827e-01  -2.530 0.011419 *
storage.4                          -8.599e-01  4.692e-01  -1.833 0.066840 .
storage.5                          -8.640e-01  5.950e-01  -1.452 0.146460
productline.iPad.1                 -2.996e-02  3.634e-01  -0.082 0.934312
productline.iPad.2                  3.444e-01  3.560e-01   0.967 0.333316
productline.iPad.3                  1.040e+00  4.049e-01   2.568 0.010221 *
productline.iPad.4                  1.033e+00  4.185e-01   2.469 0.013547 *
productline.iPad.5                  2.884e+00  1.069e+03   0.003 0.997847
productline.iPad.Air                2.019e+00  4.464e-01   4.524 6.07e-06 ***
productline.iPad.Air.2              3.717e+00  5.402e-01   6.881 5.95e-12 ***
productline.iPad.mini               5.036e-01  3.595e-01   1.401 0.161200
productline.iPad.mini.2             1.566e+00  4.501e-01   3.478 0.000504 ***
productline.iPad.mini.3             2.304e+00  5.445e-01   4.231 2.33e-05 ***
productline.iPad.mini.Retina        1.629e+00  1.204e+00   1.353 0.175964
productline.Unknown                        NA         NA      NA       NA
UniqueID                           -5.457e-04  1.606e-04  -3.398 0.000679 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1927.2  on 1395  degrees of freedom
Residual deviance: 1235.8  on 1361  degrees of freedom
AIC: 1305.8

Number of Fisher Scoring iterations: 13
</pre>
</div>
</div>

<div id="outline-container-sec-4-2-2" class="outline-4">
<h4 id="sec-4-2-2"><span class="section-number-4">4.2.2</span> Logistic Regression model 5</h4>
<div class="outline-text-4" id="text-4-2-2">
<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Create the logistic regression model 5 to predict sold using</span>
<span style="color: #ff6a6a;">all the independent variables:"</span>)

eBayLR5 <span style="color: #db7093;">&lt;-</span> glm(sold ~ biddable + startprice <span style="color: #9932cc;">#</span><span style="color: #ba55d3;">+ storage.2 + storage.3</span>
                 + productline.iPad.3 + productline.iPad.Air +
                           productline.iPad.Air.2 +
                           productline.iPad.mini.2 +
                           productline.iPad.mini.3 + UniqueID, data =
                 eBayTrain, family = binomial)

<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">eBayLR5 &lt;- train(sold ~ biddable + startprice + storage.2 + storage.3</span>
<span style="color: #9932cc;">##                  </span><span style="color: #ba55d3;">+ productline.iPad.3 + productline.iPad.Air +</span>
<span style="color: #9932cc;">##                            </span><span style="color: #ba55d3;">productline.iPad.Air.2 +</span>
<span style="color: #9932cc;">##                            </span><span style="color: #ba55d3;">productline.iPad.mini.2 +</span>
<span style="color: #9932cc;">##                            </span><span style="color: #ba55d3;">productline.iPad.mini.3 + UniqueID, data =</span>
<span style="color: #9932cc;">##                            </span><span style="color: #ba55d3;">eBayTrain, method = "glm")</span>

writeLines(<span style="color: #ff6a6a;">"\n :: Summary of the Logistic Regression model 5:"</span>)
summary(eBayLR5)
</pre>
</div>

<pre class="example">
 :: Create the logistic regression model 5 to predict sold using
all the independent variables:

 :: Summary of the Logistic Regression model 5:

Call:
glm(formula = sold ~ biddable + startprice + productline.iPad.3 +
    productline.iPad.Air + productline.iPad.Air.2 + productline.iPad.mini.2 +
    productline.iPad.mini.3 + UniqueID, family = binomial, data = eBayTrain)

Deviance Residuals:
    Min       1Q   Median       3Q      Max
-2.1361  -0.7164  -0.2504   0.6312   2.9358

Coefficients:
                          Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)              6.8240018  1.4390161   4.742 2.11e-06 ***
biddable                 1.6257390  0.1502309  10.822  &lt; 2e-16 ***
startprice              -0.0089527  0.0008220 -10.892  &lt; 2e-16 ***
productline.iPad.3       0.6048917  0.2597041   2.329  0.01985 *
productline.iPad.Air     1.4025400  0.2992490   4.687 2.77e-06 ***
productline.iPad.Air.2   2.8126968  0.3666238   7.672 1.69e-14 ***
productline.iPad.mini.2  0.9322483  0.3183514   2.928  0.00341 **
productline.iPad.mini.3  1.5441602  0.3955666   3.904 9.47e-05 ***
UniqueID                -0.0005940  0.0001296  -4.584 4.56e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1927.2  on 1395  degrees of freedom
Residual deviance: 1272.1  on 1387  degrees of freedom
AIC: 1290.1

Number of Fisher Scoring iterations: 5
</pre>
</div>
</div>

<div id="outline-container-sec-4-2-3" class="outline-4">
<h4 id="sec-4-2-3"><span class="section-number-4">4.2.3</span> Testing the LR models with the new testing data set</h4>
<div class="outline-text-4" id="text-4-2-3">
<p>
So the baseline model would get an accuracy of about 0.5379656. Let's
compute the out-of-sample AUC.
</p>

<p>
For the Logistic Regression LR5 we can concentrate the features used
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Generalize outcome and predictor variables..."</span>)

predictorsNamesLR5 <span style="color: #db7093;">&lt;-</span> c(<span style="color: #ff6a6a;">"biddable"</span>,
                     <span style="color: #ff6a6a;">"startprice"</span>,
                     <span style="color: #ff6a6a;">"productline.iPad.3"</span>,
                     <span style="color: #ff6a6a;">"productline.iPad.Air"</span>,
                     <span style="color: #ff6a6a;">"productline.iPad.Air.2"</span>,
                     <span style="color: #ff6a6a;">"productline.iPad.mini.2"</span>,
                     <span style="color: #ff6a6a;">"productline.iPad.mini.3"</span>,
                     <span style="color: #ff6a6a;">"UniqueID"</span>)
predictorsNamesLR5
</pre>
</div>

<pre class="example">
 :: Generalize outcome and predictor variables...
[1] "biddable"                "startprice"
[3] "productline.iPad.3"      "productline.iPad.Air"
[5] "productline.iPad.Air.2"  "productline.iPad.mini.2"
[7] "productline.iPad.mini.3" "UniqueID"
</pre>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Test set AUC "</span>)
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">PredTestLR5 &lt;- predict(object = eBayLR5, newdata = eBayTest, type = 'prob')</span>

<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">ROCRpredLR5 &lt;- prediction(PredTestLR5, eBayTest$sold)</span>
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">as.numeric(performance(ROCRpredLR2, "auc")@y.values)</span>
</pre>
</div>

<pre class="example">
:: Test set AUC
</pre>



<p>
Test set AUC LR03:
</p>

<p>
<b>0.8453767</b>
</p>
</div>
</div>
</div>

<div id="outline-container-sec-4-3" class="outline-3">
<h3 id="sec-4-3"><span class="section-number-3">4.3</span> Random forest models</h3>
<div class="outline-text-3" id="text-4-3">
</div><div id="outline-container-sec-4-3-1" class="outline-4">
<h4 id="sec-4-3-1"><span class="section-number-4">4.3.1</span> RF model 1</h4>
<div class="outline-text-4" id="text-4-3-1">
<div class="org-src-container">

<pre class="src src-R"><span style="color: #9932cc;">## </span><span style="color: #ba55d3;">writeLines("\n :: Random Forest model:")</span>
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">set.seed(pi)</span>
<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">eBayRF01 &lt;- randomForest(sold ~ UniqueID + biddable + startprice +</span>
<span style="color: #9932cc;">##                                  </span><span style="color: #ba55d3;">condition + cellular + carrier +</span>
<span style="color: #9932cc;">##                                  </span><span style="color: #ba55d3;">color + storage + productline, data =</span>
<span style="color: #9932cc;">##                     </span><span style="color: #ba55d3;">eBayTrain, method = "class", na.action=na.roughfix)</span>

<span style="color: #9932cc;">## </span><span style="color: #ba55d3;">summary(eBayRF01)</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5"><span class="section-number-2">5</span> Prepare the CSV file for submission</h2>
<div class="outline-text-2" id="text-5">
<p>
And then make predictions on the test set. We will change the type for
the testing set:
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: eBayValidation new structure:"</span>)
str(eBayValidation2)
</pre>
</div>

<pre class="example">
 :: eBayValidation new structure:
'data.frame':	798 obs. of  36 variables:
 $ biddable                          : num  0 0 0 1 0 0 0 0 0 1 ...
 $ startprice                        : num  105 195 220 100 211 ...
 $ condition.For.parts.or.not.working: num  0 0 0 0 0 0 0 0 0 0 ...
 $ condition.Manufacturer.refurbished: num  0 0 0 0 1 0 0 0 0 0 ...
 $ condition.New                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ condition.New.other.see.details   : num  0 0 0 0 0 1 0 0 0 0 ...
 $ condition.Seller.refurbished      : num  0 0 0 0 0 0 1 0 0 0 ...
 $ condition.Used                    : num  1 1 1 1 0 0 0 1 1 1 ...
 $ cellular                          : num  1 0 0 0 0 0 0 0 0 0 ...
 $ carrier.ATT                       : num  1 0 0 0 0 0 0 0 0 0 ...
 $ carrier.None                      : num  0 1 1 1 1 1 1 1 1 1 ...
 $ carrier.Other                     : num  0 0 0 0 0 0 0 0 0 0 ...
 $ carrier.Sprint                    : num  0 0 0 0 0 0 0 0 0 0 ...
 $ carrier.T-Mobile                  : num  0 0 0 0 0 0 0 0 0 0 ...
 $ carrier.Unknown                   : num  0 0 0 0 0 0 0 0 0 0 ...
 $ carrier.Verizon                   : num  0 0 0 0 0 0 0 0 0 0 ...
 $ color.Black                       : num  0 0 0 0 1 0 1 0 1 0 ...
 $ color.Gold                        : num  0 0 0 0 0 1 0 0 0 0 ...
 $ color.Space.Gray                  : num  0 0 0 0 0 0 0 0 0 0 ...
 $ color.Unknown                     : num  1 1 1 1 0 0 0 1 0 1 ...
 $ color.White                       : num  0 0 0 0 0 0 0 0 0 0 ...
 $ storage.2                         : num  0 1 0 1 0 0 0 1 1 0 ...
 $ storage.3                         : num  1 0 0 0 1 0 1 0 0 1 ...
 $ storage.4                         : num  0 0 1 0 0 1 0 0 0 0 ...
 $ storage.5                         : num  0 0 0 0 0 0 0 0 0 0 ...
 $ productline.iPad.1                : num  1 0 0 0 0 0 1 0 0 1 ...
 $ productline.iPad.2                : num  0 0 0 0 0 0 0 0 0 0 ...
 $ productline.iPad.3                : num  0 0 1 0 1 0 0 0 1 0 ...
 $ productline.iPad.4                : num  0 0 0 0 0 0 0 1 0 0 ...
 $ productline.iPad.Air              : num  0 0 0 0 0 0 0 0 0 0 ...
 $ productline.iPad.Air.2            : num  0 0 0 0 0 1 0 0 0 0 ...
 $ productline.iPad.mini             : num  0 0 0 1 0 0 0 0 0 0 ...
 $ productline.iPad.mini.2           : num  0 1 0 0 0 0 0 0 0 0 ...
 $ productline.iPad.mini.3           : num  0 0 0 0 0 0 0 0 0 0 ...
 $ productline.Unknown               : num  0 0 0 0 0 0 0 0 0 0 ...
 $ UniqueID                          : num  11862 11863 11864 11865 11866 ...
</pre>

<p>
Now we will apply the new model to the validation data
</p>

<div class="org-src-container">

<pre class="src src-R">writeLines(<span style="color: #ff6a6a;">"\n :: Probabilities test vector generation:"</span>)
PredTest <span style="color: #db7093;">&lt;-</span> predict(eBayLR5, newdata = eBayValidation2, type = <span style="color: #ff6a6a;">"response"</span>)

summary(PredTest)
</pre>
</div>

<pre class="example">
 :: Probabilities test vector generation:
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max.
0.0000659 0.0931200 0.2151000 0.3485000 0.6310000 0.9845000
</pre>

<p>
Let's prepare a submission file for Kaggle (for more about this, see
the "Evaluation" page on the competition site):
</p>

<div class="org-src-container">

<pre class="src src-R">MySubmission <span style="color: #db7093;">&lt;-</span> data.frame(UniqueID = eBayValidation2$UniqueID, Probability1
                           = PredTest)

write.csv(MySubmission, <span style="color: #ff6a6a;">"../data/SubmissionLR5.csv"</span>, row.names =
                                                             <span style="color: #3cb371;">FALSE</span>)

writeLines(<span style="color: #ff6a6a;">"\n :: Submission file generated..."</span>)
</pre>
</div>

<pre class="example">
:: Submission file generated...
</pre>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 20/07/2015</p>
<p class="author">Author: Sergio-Feliciano Mendoza-Barrera</p>
<p class="date">Created: 2015-07-31 Fri 13:36</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.5.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
